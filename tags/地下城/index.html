<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 3.9.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>標籤: 地下城 - Moojing&#39;s Blog</title>


    <meta name="keywords" content="frontend,backend,javascript">
<meta property="og:type" content="website">
<meta property="og:title" content="Moojing&#39;s Blog">
<meta property="og:url" content="https://www.muji.dev/tags/地下城/index.html">
<meta property="og:site_name" content="Moojing&#39;s Blog">
<meta property="og:locale" content="zh-TW">
<meta property="og:image" content="https://www.muji.dev/images/og_image_name.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Moojing&#39;s Blog">
<meta name="twitter:image" content="https://www.muji.dev/images/og_image_name.png">







<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134605527-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134605527-1');
</script>
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Moojing&#39;s Blog" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About Me</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="搜尋" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-8-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">標籤</a></li>
            <li class="is-active"><a href="#" aria-current="page">地下城</a></li>
        </ul>
        </nav>
    </div>
</div>

    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-08T16:59:29.000Z">2019-03-09</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分鐘 閱讀文 (大約 1081 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/09/8f-ooxx/">Vue.js 井字遊戲 - OOXX</a>
            
        </h1>
        <div class="content">
            <img src="/2019/03/09/8f-ooxx/cover.png" title="COVER">
<p>大家好，我在地下城8樓，題目是3x3井字遊戲，直覺想到最簡單的方式就是暴力檢查，每個Row跟Column去檢查有沒有相等的，最後加上對角線兩條。也看到別樓有分享Alex1&amp;10解法，覺得很高明。</p>
<p>不過我想看看有沒有不一樣的做法，相信一定有。剛剛講到Row跟Column，就讓我想到二維陣列。沒錯，整個井字窗格根本可以用座標來看，今天這個題目的解法會以二維陣列為主軸來解說作法，切版的部分則比較繁瑣且不難所以不會多提，有問題可以再跟我討論。</p>
<p>你可以在這裡看到我的<a href="https://moojing.github.io/demo/underground_8f/#/game">成果</a>，或是參考<a href="https://github.com/moojing/hex-underground/tree/master/8f_ooxx/src">原始碼</a>。</p>
<h2 id="規則"><a class="header-anchor" href="#規則"></a>規則</h2>
<ul>
<li>
<p>先手為 Ｏ，後手為 X，某方獲勝時，上方會紀錄各方的獲勝戰績</p>
</li>
<li>
<p>每回合結束後，會判定結果頁(平手、Ｏ獲勝、X獲勝)</p>
</li>
<li>
<p>需符合 RWD，能在低螢幕解析度也能遊玩，介面不能超出 x 軸，至少在以下解析度能夠遊玩:</p>
<ol>
<li>iPhone SE 320px</li>
<li>iPhone 8 375px</li>
<li>iPhone PLUS 414px</li>
</ol>
</li>
<li>
<p>請使用瀏覽器離線儲存技術，將戰績保留起來</p>
</li>
</ul>
<h2 id="資料結構"><a class="header-anchor" href="#資料結構"></a>資料結構</h2>
<p>為了讓對應到畫面的資料可以更直觀的操作跟查詢，我是這樣訂定格式的：</p>
<pre><code class="language-js">data(){
    return {
    ...
     currentPlayer:0,
     gameStatus:[[null,null,null],
                 [null,null,null],   
                 [null,null,null]]
            }}
</code></pre>
<p>陣列第0個元素代表的是第一個Row，Row本身也是陣列，剛好由左到右對應到0、1、2的位置，(0,0)對應到最左上，(2,2)對應到最右下，這樣直觀多了，如下圖所示：</p>
<img src="/2019/03/09/8f-ooxx/position.png" title="DATA STRUCTURE">
<p>然後用0表示O、1表示X，與上述資料結構的currentPlayer一樣，null則表示尚未下棋的位置，不過這邊不建議用0來做任何的判斷，原因稍後再提。</p>
<h2 id="判斷勝利者"><a class="header-anchor" href="#判斷勝利者"></a>判斷勝利者</h2>
<p>因為我用的資料表示是： O為0，X為1，因此如果整列、整行或交叉相加都是0，或是3，代表有人勝出，這時我只要取得currentPlayer就知道獲勝的是誰了。</p>
<h2 id="判斷勝利邏輯"><a class="header-anchor" href="#判斷勝利邏輯"></a>判斷勝利邏輯</h2>
<p>要判斷目前賽況是否有人勝出，我們需要檢查的部分有:</p>
<ul>
<li>每個Row（橫排）是否有連線</li>
<li>每個Column（直行）是否有連線</li>
<li>對角線是否有連線</li>
</ul>
<p>判斷對角線的部分比較麻煩，但你應該可以看出，使用陣列的方式可以清楚區分出Row跟Column，讓檢查更方便，檢查的時間點是每次使用者點完要下的棋格之後的瞬間，檢查完最後切換使用者(玩家)。</p>
<pre><code class="language-js">methods:{
...
onSectionClick(x,y){
         if (this.gameStatus[y][x]!==null) return //防止重複下棋
         this.gameStatus[y][x] = this.currentPlayer//下棋
         this.checkResult()//檢查賽況
         this.togglePlayer()//&lt;---下完後切換使用者

       },}
</code></pre>
<p>因為是二維陣列所以要兩層for迴圈，注意這邊因為要先取用Row，所以陣列的操作必須先從y (也就是直排) 開始選取，而不是一般座標的表示方式(x,y)，當然可以透過改變資料結構做出比較直觀的使用方式，不過因為沒有很困難，且為了解說方便，這邊就不做調整。</p>
<pre><code class="language-js">  let status = this.gameStatus
  for(let y=0; y&lt;status.length; y++){
    for(let x=0; x&lt;status[y].length; x++ ){
      // 用status[y][x]取得棋格元素 &lt;-----重要
    }
   }
   
</code></pre>
<p>知道取得陣列的方式之後就可以開始逐行逐列檢查啦！</p>
<h3 id="檢查row-column是否有連線"><a class="header-anchor" href="#檢查row-column是否有連線"></a>檢查Row / Column是否有連線</h3>
<p>想要取得Row整行的和，每次的y必須固定，我是在x為0的時候，取得後面兩個x+1、x+2元素，相加後算出總和，。</p>
<pre><code class="language-js">methods:{
...
getSumOfRow(x,y){
            let status = this.gameStatus
            if(x!==0 ) return 
             return status[y][x]+
                       status[y][x+1]+
                       status[y][x+2]
        },}
</code></pre>
<p>Coloum總和則為x y與上述相反：</p>
<pre><code class="language-js"> getSumOfColumn(x,y){
            let status = this.gameStatus
            if(y!==0 ) return 
            return   status[y][x]+
                     status[y+1][x]+
                     status[y+2][x]             
        },
</code></pre>
<p>取得總合後判斷是否有0或是3就知道有無勝出。</p>
<h3 id="檢查對角線是否有連線"><a class="header-anchor" href="#檢查對角線是否有連線"></a>檢查對角線是否有連線</h3>
<p>一樣是在迴圈一開始x為0以及ｙ為0的時候做判斷，在取得總和之前，我先看看是不是整個對角線都已經被下過棋了，如果沒有，則直接return 跳出不做任何動作。</p>
<pre><code class="language-js">methods:{
getSumOfNegativeSlash(x,y){
            let status = this.gameStatus
            if(x!==0 || y!==0 ) return 
            if(  !(this.isNumber(status[y][x]) &amp;&amp; 
                  this.isNumber(status[y+1][x+1]) &amp;&amp;
                  this.isNumber(status[y+2][x+2]))) return 
                        
            return   status[y][x]+ status[y+1][x+1]+status[y+2][x+2]
        },
        
}
</code></pre>
<p>另一個方向的對角線是同樣的做法，看到這裡的你應該可以推算出邏輯，如果還是不懂，可以參考文章開頭處的專案原始碼。</p>
<h3 id="整合所有的判斷邏輯-checkresult-method"><a class="header-anchor" href="#整合所有的判斷邏輯-checkresult-method"></a>整合所有的判斷邏輯 - checkResult method</h3>
<p>最後整個判斷邏輯如下，我把三種情況（Row / Column / 對腳線）個別寫下條件之後用OR串起來，只要狀況符合其中一種條件，就會結束賽局。</p>
<pre><code class="language-js">         checkResult(){
            
            let status = this.gameStatus
           for(let y=0; y&lt;status.length; y++){
               for(let x=0; x&lt;status[y].length; x++ ){
                   let sumOfCol = this.getSumOfColumn(x,y) 
                   let sumOfRow = this.getSumOfRow(x,y) 
                   if(
                        (   this.isRowAllNumber(x,y) &amp;&amp; 
                            sumOfRow=== 0||sumOfRow=== 3
                        )||(
                            this.isColumnAllNumber(x,y) &amp;&amp; 
                            sumOfCol === 0||sumOfCol === 3
                        )||(
                           this.getSumOfNegativeSlash(x,y)===0 || 
                           this.getSumOfNegativeSlash(x,y)===3 || 
                           this.getSumOfPositiveSlash(x,y)===0 || 
                           this.getSumOfPositiveSlash(x,y)===3
                        )){
                      this.setScore()  
                      this.goResultPage(this.currentPlayer)
                    }
               }
           }
           this.checkIfFinish()
        },
</code></pre>
<p>這邊有一個蠻麻煩的雷點就是js裡面null+0居然還是0，害我沒辦法直接正確判斷結果，導致我還寫了一個isRowAllNumber來判斷該列/欄是否全是數字，所以不推薦用0跟null搭配來當做相加的判斷。（你可以打開開發者工具試試看）</p>
<h2 id="使用localstorage紀錄分數"><a class="header-anchor" href="#使用localstorage紀錄分數"></a>使用localStorage紀錄分數</h2>
<p>這邊我使用localStorage來永久儲存比數，localStorage操作方式有以下幾種：</p>
<ul>
<li>localStorage.setItem(‘key’,‘content’)</li>
<li>localStorage.getItem(‘key’)</li>
<li>localStorage.removeItem(‘key’)</li>
</ul>
<p>瀏覽器上有另外一個操作方式很類似的api叫做sessionStorage，差別就在於localStorage除非主動刪除，否則會永久保留在瀏覽器、sessionStorage則是在分頁關閉後就會被刪除。</p>
<p>我把上面三個api另外包成三個function，讓我在各個元件可以方便使用，統一使用方式，以下是setItem的包裝：</p>
<pre><code class="language-js">export const setStorage = (name, content) =&gt; {
    if (!name) return;
    if (typeof content !== &quot;string&quot;) {
      content = JSON.stringify(content);
    }
    window.localStorage.setItem(name, content);
  };
</code></pre>
<p>getStorage、removeStorage則是類似的方式，在此就不多提。</p>
<h2 id="多思考一些-重置分數按鈕"><a class="header-anchor" href="#多思考一些-重置分數按鈕"></a>多思考一些 - 重置分數按鈕</h2>
<p>這邊思考的是，既然可以儲存戰績，那如果可以讓玩家手動清除分數，應該會更好用，很多遊戲也有這種功能。所以我將原本入口的START按鈕改為CONTINUE跟RESTART，如果兩邊分數為0才只顯示START。</p>
<img src="/2019/03/09/8f-ooxx/think.png" title="CONTINUE BUTTON">
<p>雖然是小地方但可以增加樂趣，算是一點小優化，給有興趣的人參考。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-03T15:04:53.000Z">2019-03-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Canvas/">Canvas</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 分鐘 閱讀文 (大約 2403 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/03/canvas-sketchpad/">Vue.js 實作 Canvas 畫板</a>
            
        </h1>
        <div class="content">
            <img src="/2019/03/03/canvas-sketchpad/cover.png" title="Cover Photo">
<p>大家好，我在地下城七樓。在網頁互動上，Canvas的表現速度比起傳統用DOM元素操作的方式快上許多，因此常有某些互動的需求會採用Canvas來達成，這個專案會從基礎開始解說我如何實作Canvas畫板。</p>
<p>你可以在<a href="https://moojing.github.io/demo/underground_7f/">這裡</a>看到我的實作成果，或是<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">在此</a>參考我的程式碼。</p>
<p>這個專案會盡量練習以我的角度寫出好讀的程式碼，什麼是好讀的程式碼？總該有個客觀定義，但以我目前所學來看，通常是有一定經驗的人，看夠別人寫的程式法，才能漸漸分辨好壞。不過俗話說取悅別人之前要先取悅自己，我想在這點上可以列一個最低限度的階段目標，就是先<strong>寫出讓自己好讀的程式碼。</strong> 畢竟如果自己都看得很吃力，那我想也絕對稱不上好讀。</p>
<p>P.S. 網路上應該可以找到不少討論這一點的<a href="https://medium.com/s/story/readability-as-usability-78c5a2a373cc?source=email-86564209b7e7-1551389956264-digest.reader------0-50------------------3ae9041b_fc1c_4d8c_95cd_2f5c22f35c7e-1&amp;sectionName=top">文章</a>。</p>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>Canvas - 指定渲染環境</li>
<li>封裝畫線方法</li>
<li>鉛筆工具</li>
<li>橡皮擦工具</li>
<li>Canvas轉成圖片</li>
<li>空心矩形</li>
<li>復原與重做</li>
<li>多思考一些 - 使用者體驗</li>
</ul>
<h2 id="指定渲染環境"><a class="header-anchor" href="#指定渲染環境"></a>指定渲染環境</h2>
<p>Canvas 會產生一個固定範圍的畫布，但開始繪製圖型之前， 由於canvas可以有很多種渲染環境，我們必須使用getContext()方法來指定想要的渲染方式，這邊畫布使用的是2d環境。</p>
<pre><code class="language-html">&lt;canvas ref=&quot;sketchpad&quot;&gt;&lt;/canvas&gt;
</code></pre>
<pre><code>methods:{
...
 setCanvas(){
      let canvas = this.$refs['sketchpad']
      canvas.width  = window.innerWidth
      canvas.height  = window.innerHeight - 60
      let ctx =  canvas.getContext('2d')
      ctx.lineCap = &quot;round&quot;
      ctx.lineJoin = &quot;round&quot;
      this.canvasContext = ctx
    },
}
</code></pre>
<h2 id="封裝畫線方法"><a class="header-anchor" href="#封裝畫線方法"></a>封裝畫線方法</h2>
<h3 id="基礎"><a class="header-anchor" href="#基礎"></a>基礎</h3>
<p>canvas畫線之前要先呼叫beginPath方法告知開始畫線，最後用stroke()畫出邊線或是用fill()填滿，一個畫線的簡單例子：</p>
<pre><code class="language-js">ctx.beginPath();       // Start a new path
ctx.moveTo(30, 50);    // Move the pen to (30, 50)
ctx.lineTo(150, 100);  // Draw a line to (150, 100)
ctx.stroke();          // Render the path
</code></pre>
<p>這段程式是在告訴canvas從座標(30,50)開始畫線到(150,100)，不過從beginPath開始，直到stroke()被呼叫為止，才會將線段渲染到畫板上，詳細說明可參考<a href="https://developer.mozilla.org/zh-TW/docs/Web/API/Canvas_API/Tutorial/Drawing_shapes#%E8%B7%AF%E5%BE%91%E7%B9%AA%E8%A3%BD">官方文件</a>。</p>
<h3 id="簡化"><a class="header-anchor" href="#簡化"></a>簡化</h3>
<p>每次要畫線段都要呼叫beginPath() 跟 stroke() 實在是太多餘了，我把每次都相同的部份用methods封裝起來，中間實際會改變的部分我用callback當作參數傳入這個method，這麼一來就可以減少重複的程式碼：</p>
<pre><code class="language-js">methods:{
    ...
     draw(action){
      let canvasContext = this.canvasContext
      canvasContext.beginPath()
      canvasContext.lineWidth = this.currentSize*2       
      action(canvasContext)
      canvasContext.stroke()
    },

}
</code></pre>
<p>實際使用：</p>
<pre><code class="language-js"> this.draw((ctx)=&gt;{
                        ctx.strokeStyle =  this.currentColor.code
                        ctx.moveTo(this.tempPosition.x,this.tempPosition.y)
                        ctx.lineTo(pos.x,pos.y)
                    })
</code></pre>
<p>如果你寫Js一段時間應該會發現常見的map或是filter也是類似的用法。</p>
<h2 id="實作鉛筆工具"><a class="header-anchor" href="#實作鉛筆工具"></a>實作鉛筆工具</h2>
<p>鉛筆工具實作上，基本上就是找出滑鼠按下的時候，滑鼠移動的軌跡，再將這些點用線段一個一個連起來，實作前有兩個問題要先想一下：</p>
<ul>
<li>如何記錄移動軌跡，每個點都記錄？還是只記錄一個？要記錄什麼時間點的軌跡</li>
<li>如何得知滑鼠現在是否為按下的狀態 ?</li>
</ul>
<p>我實作的方式是，在window新增mousemove監聽事件，事件被觸發時，記錄滑鼠移動到B點時的前一個點A點位置，然後因為在B點時的位置可以直接透過js api取得，這樣就能夠對照前後位置，以實作鉛筆功能。</p>
<pre><code class="language-js">window.addEventListener('mousemove',(event)=&gt;{
...
let currentPos = this.getCanvasMousePosition(event.clientX,event.clientY)
...
...
this.setCanvasTempPosition(currentPos.x,currentPos.y) 
           
})
</code></pre>
<p>取得鼠標位置的細節可參考我的<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">Github</a>。只看程式碼可能有點抽象，第一次移動的時候，tempPosition一定是空值，直到位置發生變化（從A到B)結束後，A點位置才會被記錄到tempPosition，完成前一軌跡記錄。</p>
<p>再來，如何確定滑鼠是否為按下狀態? 我在canvas元素上分別新增mousedown跟mouseup事件，並在Vue data新增一個布林值isCanvasMouseDown，以透過這兩個事件切換滑鼠狀態。</p>
<pre><code class="language-js">onCanvasMouseDown(){ 
      this.isCanvasMouseDown = true
      ...
    }

onCanvasMouseUp(){
    this.isCanvasMouseDown = false
  }
</code></pre>
<p>最後，就剩下canvas畫圖的功夫了，在畫圖之前記得先確認滑鼠狀態以及是否已有軌跡記錄之後再執行動作，否則會出錯：</p>
<p><strong>In MouseMove Event</strong></p>
<pre><code class="language-js">...
    if(this.isCanvasMouseDown &amp;&amp; this.tempPosition){
            let pos = this.getCanvasMousePosition(event.clientX,event.clientY)
            switch(this.currentTool){
              case 'paint-brush' : 
                    this.draw((ctx)=&gt;{
                        ctx.strokeStyle =  this.currentColor.code
                        ctx.moveTo(this.tempPosition.x,this.tempPosition.y)
                        ctx.lineTo(pos.x,pos.y)
                    })
                    break;
                    ...
</code></pre>
<h2 id="橡皮擦工具"><a class="header-anchor" href="#橡皮擦工具"></a>橡皮擦工具</h2>
<p>橡皮擦工具只是把已經畫上的圖案消去，這邊我直接用前面實作的筆刷工具，搭配背景色，可以達成一樣的效果，比較特別的是，我將canvas背景色記錄在vue data裡面，這樣就可以確保橡皮擦工具的顏色跟背景色是相同的值，減少錯誤發生機率。</p>
<h2 id="canvas-轉成圖片"><a class="header-anchor" href="#canvas-轉成圖片"></a>Canvas 轉成圖片</h2>
<p>轉成圖片不是什麼大問題，Canvas元素本身有一個toDataUrl，可以回傳回傳含有圖像的Url，最後再產生一個a元素，將網址貼上去後觸發click事件，就可以模擬點擊，達成下載圖片的功能。</p>
<pre><code class="language-js">canvasToImage(){
      let url =  this.$refs['sketchpad'].toDataURL(&quot;image/png&quot;, 1.0).replace(&quot;image/png&quot;, &quot;image/octet-stream&quot;);
      const link = document.createElement('a')
      link.innerText = 'Download'
      link.href = url 
      link.download = 'circle.png'     
      link.click()
    },
</code></pre>
<h2 id="空心矩形"><a class="header-anchor" href="#空心矩形"></a>空心矩形</h2>
<p>這個功能是我思考最久的一部分，canvas要單純畫上矩形的話只要呼叫rect()方法就行，方法說明如下：</p>
<pre><code class="language-js">ctx.rect(起始位置x, 起始位置y, 長度, 寬度);
</code></pre>
<p>這格應該不難理解，最難的是如何達成「滑鼠按下時可一邊調整矩形的大小跟長寬」如果像實作鉛筆功能時，在每個軌跡都畫圖型的話，就會發生災難：</p>
<img src="/2019/03/03/canvas-sketchpad/error-sample.png" title="Error Sample">
<p>看到這裡你應該可以了解原因了，因為我在每次滑鼠改變位置時都畫了一次。這邊要思考的是：</p>
<ul>
<li>使用矩形工具，滑鼠按下時要做什麼事情</li>
<li>什麼時候紀錄前一個移動軌跡，什麼時候不要</li>
</ul>
<p>我的解法是，當使用矩形工具，且偵測到mousedown事件時，在畫圖之前先用getImageData做一個簡單的暫存：</p>
<pre><code class="language-js">methods:{
...
setTempCanvas(){ 
      let ctx = this.canvasContext
      let canvas = ctx.canvas 
      let tempCanvas = ctx.getImageData(0, 0, canvas.width, canvas.height);
      this.tempCanvas = tempCanvas
    }, 
...
}
</code></pre>
<p>並且在每次滑鼠位置改變並且渲染矩形完成後，用putImageData() 把暫存復原，以上面災難圖為例，就是每次畫完之後，只會看到最為面那層。</p>
<h2 id="復與原重做"><a class="header-anchor" href="#復與原重做"></a>復與原重做</h2>
<p>我找到一篇描述利用window.history模擬瀏覽器上ㄧ頁下一頁功能的<a href="https://ithelp.ithome.com.tw/articles/10195793">文章</a>，實作步驟簡單來說就是在每次畫完圖型後將目前畫面暫存進history裡面，再去透過js操作瀏覽器上頁跟下頁來達成這個功能，蠻有趣的。</p>
<h2 id="多思考一些-使用者體驗"><a class="header-anchor" href="#多思考一些-使用者體驗"></a>多思考一些 - 使用者體驗</h2>
<p>有幾個細節是比較容易被忽略的，但是如果有這些小地方可以讓使用者操作或是開發上更順暢，這邊把想到的點列出：</p>
<ol>
<li>畫筆畫到一半，滑過工具列時，能不能繼續畫</li>
<li>調整大小時，能不能用拖拉調整</li>
</ol>
<h3 id="1-畫筆畫到一半-滑過工具列時-能不能繼續畫"><a class="header-anchor" href="#1-畫筆畫到一半-滑過工具列時-能不能繼續畫"></a>1.畫筆畫到一半，滑過工具列時，能不能繼續畫</h3>
<p>我原本是把Mousemove事件放在canvas上面，後來做到一半才發現當我畫到一半，滑鼠經過工具列，他不會繼續對canvas的滑鼠事件有動作，因此會中斷畫圖，後來我<strong>將Mousemove事件放在整個windows上，並判斷現在滑鼠狀態是否是按下(MouseDown)</strong>，才解決這個問題。</p>
<h3 id="2-調整大小時-能不能直接用拖拉調整"><a class="header-anchor" href="#2-調整大小時-能不能直接用拖拉調整"></a>2.調整大小時，能不能直接用拖拉調整</h3>
<p>會想到這個是因為很多繪圖軟體都有這個功能，這邊的雷點跟第一點一樣，必須將mouseMove事件放在window上面，否則拖拉到一半滑鼠離開input元素時，就會停止調整Size數值，反而很不好用。</p>
<p><strong>Vue Method:</strong></p>
<pre><code class="language-js">  checkSizeDrag(dragValue){
      if(dragValue&lt;0){ 
        this.currentSize =  parseInt(this.currentSize)+1
      }else if(dragValue&gt;0&amp;&amp;this.currentSize&gt;=1){
        this.currentSize = parseInt(this.currentSize)-1
      }
    },
</code></pre>
<p><strong>In MouseMove Event</strong></p>
<pre><code class="language-js"> 
window.addEventListener('mousemove',(event)=&gt;{
...
    let currentPos = this.getCanvasMousePosition(event.clientX,event.clientY)
    if(this.isSizing &amp;&amp; this.tempPosition ){
                let dragValue= currentPos.y- this.tempPosition.y 
                this.checkSizeDrag(dragValue)
    }
...
}
</code></pre>
<p>你可以在<a href="https://moojing.github.io/demo/underground_7f/">這裡</a>看到我的實作成果，或是<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">在此</a>參考我的程式碼。</p>
<h2 id="參考文章"><a class="header-anchor" href="#參考文章"></a>參考文章</h2>
<p>canvas基礎：<br>
<a href="http://test.domojyun.net/MEMO/Canvas/">http://test.domojyun.net/MEMO/Canvas/</a></p>
<p>pushState 實作復原及重做：<br>
<a href="https://ithelp.ithome.com.tw/articles/10195793">https://ithelp.ithome.com.tw/articles/10195793</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-18T04:03:19.000Z">2019-02-18</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分鐘 閱讀文 (大約 2008 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/18/60s-challenge/">Vue.js小遊戲實作-60秒算數挑戰</a>
            
        </h1>
        <div class="content">
            <p><img src="https://i.imgur.com/4yxfbeW.png" alt=""></p>
<p>大家好，我在六角地下城6f，這樓的挑戰是實作小遊戲，題目的邏輯是在六十秒內會產生隨機兩個數字去隨機做加減乘除， 答對就加一分，答錯就扣一分，秒數越少，題目越困難，得分就越高分。</p>
<p>題目詳細規則如下：</p>
<ul>
<li>0~20 秒為 1位數計算 (ex. 5-3)</li>
<li>21~40 秒為 2 位數計算 (ex. 30*19)</li>
<li>41~60 秒為 3 位數計算 (ex. 332+312)</li>
<li>加減乘除規則請用隨機產生，不可寫死題目，60 秒內可無限次數答題。</li>
<li>0~40 秒答對加一分</li>
<li>41~60 秒答對加五分</li>
<li>答錯扣一分，最多僅能扣到零分</li>
</ul>
<p>我打算在這個專案做邏輯梳理的練習，因此會盡量把有機會重複使用的部分拆成methods，這個專案只會講述核心部分的邏輯，也就是如何產生題目，以及一些可能的問題點，其他細節部分希望你自己做做看，你可以在<a href="http://underground-60s-game.surge.sh/">這裡</a>看到我實做的成果。或是也可以直接<a href="https://github.com/moojing/hex-underground/blob/master/6f_counter_game/src/App.vue">參考原始碼</a>。</p>
<h2 id="規則流程-運算："><a class="header-anchor" href="#規則流程-運算："></a>規則流程－運算：</h2>
<ol>
<li>產生隨機兩個數字</li>
<li>產生運算符號（加減乘除）</li>
<li>等待使用者輸入</li>
<li>檢查正確答案與使用者輸入是否符合</li>
<li>產生下一道題目</li>
</ol>
<h2 id="規則流程-時間："><a class="header-anchor" href="#規則流程-時間："></a>規則流程－時間：</h2>
<ol>
<li>挑戰者按下開始後，切換頁面並開始倒數</li>
<li>倒數60秒</li>
<li>檢查現在秒數，根據不同秒數決定不同難度的題目及得分</li>
<li>60秒倒數完畢後，切換顯示頁面，不讓挑戰者繼續輸入</li>
<li>挑戰者查看得分，等待按下「再次挑戰」後重新此流程</li>
</ol>
<h2 id="需特別注意的規則細節："><a class="header-anchor" href="#需特別注意的規則細節："></a>需特別注意的規則細節：</h2>
<p>因為數字是隨機產生，因此在某些情況下要注意，否則會有負數產生：</p>
<ol>
<li>減法時，會有前後數字大小的問題</li>
<li>除法時，會有數字大小以及除不盡的問題</li>
<li>最後挑戰者重新開始時記得clearInterval</li>
</ol>
<h2 id="專案實作-基本配置"><a class="header-anchor" href="#專案實作-基本配置"></a>專案實作 - 基本配置</h2>
<p>這個專案我是使用vue-cli，因為規模並不是很大，也不能跳頁，因此不打算另外切出Component。</p>
<p>資料結構的部分，因為會有重置資料的需求，我把原本習慣寫在data()裡面的資料拉出來，放在獨立的function回傳，這樣我就可以輕易的拿到預設的資料。</p>
<pre><code class="language-js">// outside Vue instance
function initData(){
    return {
     pages:['start','game','result'],
     operatorList:['+','-','x','÷'],
    operator:'+',
    currentPage:'start',
    score: '000',
    time_remain:60,
    currentTime:'00:00',
    quizNumbers:[],    }
}

// inside Vue instance
export default {
  name: 'app',
  data(){
    return initData()
  }
}

</code></pre>
<p>已知狀態有三種，因此我直接根據不同狀態去顯示不同頁面，這邊寫法可以依照自己習慣去更改：</p>
<pre><code class="language-js"> &lt;div :class=&quot;pages[0]&quot; v-if=&quot;currentPage==pages[0]&quot;  &gt;
 ...
 &lt;/div&gt;
 
  &lt;div :class=&quot;pages[1]&quot; v-if=&quot;currentPage==pages[1]&quot; &gt;
  ...
  &lt;/div&gt;

  &lt;div :class=&quot;pages[2]&quot; v-if=&quot;currentPage==pages[2]&quot; &gt;
    ...
  &lt;/div&gt;
</code></pre>
<h2 id="專案實作-邏輯實現"><a class="header-anchor" href="#專案實作-邏輯實現"></a>專案實作 - 邏輯實現</h2>
<h3 id="倒數方法-使用settimeinterval"><a class="header-anchor" href="#倒數方法-使用settimeinterval"></a>倒數方法 - 使用setTimeInterval</h3>
<p>要能夠時線倒數，代表必須每隔一秒改變畫面上的時間值，這裡用setTimeInterval最適合不過了，他會每隔一段時間去執行寫入的方法：</p>
<pre><code>methods:{
    ...
     timeReducer(){
         let timer =  setInterval(()=&gt;{
          if( this.time_remain&gt;0){
            this.currentTime = this.convertSeconds(this.time_remain -=1 )
          }else{
            clearInterval(timer)
            this.currentPage= this.pages[2]
          }
        }, 1000)
        return timer
    },
    ...
}
</code></pre>
<p>但在使用完後記得要清除這個interval，因為他會一直執行，如果沒有清除，在挑戰者再次開始遊戲時，如果沒有清楚，就會有兩個interval重疊，遊戲就無法順利進行，這邊我是在倒數完之後在setTimeInterval裡面直接使用clearInterval清除。</p>
<h3 id="隨機產生運算子"><a class="header-anchor" href="#隨機產生運算子"></a>隨機產生運算子</h3>
<p>因為加減乘除運算子必須隨機產生，所以我將這四種運算方式寫在陣列裡面(operatorList)，然後用JS的random方法去隨機挑選這個陣列的元素：</p>
<pre><code class="language-js">
methods:{
    ...
    randomOperator(){
      let order = Math.floor(Math.random()*100) % 4 
      this.operator = this.operatorList[order]
    }
    ...
}

</code></pre>
<h3 id="取得不同位數的數字"><a class="header-anchor" href="#取得不同位數的數字"></a>取得不同位數的數字</h3>
<p>依照上面整理的規則，我們第一個會需要處理的部份是隨機產生數字，JS裡面可以用Math.random() 去解決，但要注意這個方法回傳的值是介於0~1之間的浮點數，後面要自己去調整才能拿到自己想要的格式。</p>
<p>以及要考量到可能會有需要拿不同位數數字的需求，所以在這個method我用digits當作參數來表示欲取得的位數：</p>
<pre><code class="language-js"> // inside Vue instance 
 ...methods:{
     ...
     getDigits(digits){
      switch(digits){
        case 1 : return Math.floor((Math.random() * 10) + 1) ; 
        case 2 : return Math.floor((Math.random() * 100) + 10) ; 
        case 3 : return Math.floor((Math.random() * 100) + 100) ; 
      }
    },
 } 
</code></pre>
<h3 id="取得數字之後的處理"><a class="header-anchor" href="#取得數字之後的處理"></a>取得數字之後的處理</h3>
<p>加上setQuizNumber方法，根據不同時間取得不同位數的數字：</p>
<pre><code class="language-js">    //setQuizNumber
    let digit;
      switch (true){
        case (this.time_remain&gt;=40 &amp;&amp; this.time_remain&lt;=60): {
              digit = 1
              break; 
            }
        case (this.time_remain&gt;=20 &amp;&amp; this.time_remain&lt;=40): {
              digit = 2
              break;
            }
        case (this.time_remain&gt;=0 &amp;&amp; this.time_remain&lt;=20): {
              digit = 3
            break;
        }    
      }
      
      let result = []
      let firstNum=this.getDigits(digit); 
      let secondNum=this.getDigits(digit); 
</code></pre>
<p>我們不想要答案有負數或小數點產生，所以在減法時，必須注意第一個數字是否大於第二個，至於加法跟乘法就沒有這個問題，所以我加上判斷，如果第一個數大於第二個，就做swap交換：</p>
<pre><code class="language-js">    //setQuizNumber
      if(firstNum &lt; secondNum){
        let temp = firstNum
        firstNum = secondNum 
        secondNum = temp 
      }
</code></pre>
<p>最後為了在除法時，讓兩數是可以整除的，所以必須確保第二個數字是第一個數字的因數，以及不能有質數出現，我加入的判斷質數的方法isPrime跟取得數字所有因數的方法getFactors，以及後面會有從因數裡面雖機挑選一個數字的需求，所已加入陣列隨機挑選元素的方法getArrayRandomItem：</p>
<pre><code class="language-js">methods:{
    ...
    isPrime(num) {
      for(var i = 2; i &lt; num; i++)
        if(num % i === 0) return false;
      return num &gt; 1;
    },
    getFactors(number,digits){
      let factors =  Array
        .from(Array(number + 1), (_, i) =&gt; i)
        .filter(i =&gt; number % i === 0)

      if(digits){
        factors = factors.filter(factor=&gt;(factor+'').length===digits)
      }
        return factors
    },
    getArrayRandomItem(array){
      return  array[Math.floor(Math.random()*array.length)];
    },
    ... 
}
</code></pre>
<p>最後過濾掉質數後，從第一個數字的因數（陣列）裡面去隨機選出一個數當作第二個數字，就可以送出了：</p>
<pre><code class="language-js"> //setQuizNumber
 if(this.operator=='÷' &amp;&amp; ( firstNum % secondNum!==0)){
        while(this.isPrime(firstNum)) firstNum = this.getDigits(digit); 
        while(this.isPrime(secondNum)) secondNum = this.getDigits(digit); 
        
        secondNum = this.getArrayRandomItem(this.getFactors(firstNum,digit))
        
      } 
      result = result.concat([firstNum,secondNum]) 
      
      this.quizNumbers = result
</code></pre>
<p>做到這裡產生題目的邏輯就完成了。</p>
<h3 id="再次挑戰-重置所有資料"><a class="header-anchor" href="#再次挑戰-重置所有資料"></a>再次挑戰－ 重置所有資料</h3>
<p>還記得我一開始把原始狀態拉出來單獨放在function裡嗎？現在就可以拿來用了，使用Object.assign，可以直接對目標物件赴值，如果屬性重複，以參數越後面屬性的值為主（後面寫入的會蓋掉前面的），可以參考 <a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">官方文件</a>，順帶一提Object.assign不支援深度拷貝，如果你要複製的物件裡面還要物件，要特別注意，他只會複製那個物件的參考，後面你只要改動到該子物件，則所有該物件的參考都會跟著一起被改變。（<a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Deep_Clone">參考官方文件</a>）</p>
<pre><code class="language-js">methods:{
    ...
    onResetClick(){
      Object.assign(this.$data, initData());
      this.currentPage = this.pages[0]
    },
    ... 
}
</code></pre>
<p>this.$data是Vue裡面提供取得data物件的api，詳細可參考<a href="https://vuejs.org/v2/guide/instance.html#Data-and-Methods">官方文件</a>。<br>
到這邊所有核心的邏輯都講完了，再提一次我並沒有從頭到尾講得很詳細，希望你試著自己去理清楚來龍去脈，自己識做看看，若還是看不懂也沒關係，可以參考<a href="https://github.com/moojing/hex-underground/blob/master/6f_counter_game/src/App.vue">我的原始碼</a>，在自己做做看，有任何問題可以一起討論，感謝你的收看，下次見啦。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-13T02:49:13.000Z">2019-02-13</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 分鐘 閱讀文 (大約 2506 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/13/cors-node-vue/">Vue.js + Node.js + OpenAPI 帶你一次了解 CORS 跨域請求</a>
            
        </h1>
        <div class="content">
            <p>本篇文章是我在六角學院地下城活動5F關卡的實作紀錄，會描述如何架設簡單的Proxy Server去跟政府的公開API拉取資料回來給前端Vue.js介面做互動。</p>
<p>成果可參考<a href="http://underground-air.surge.sh/">這裏</a>(heroku開機要一段時間如果拉不到資料請多重整幾次。)</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*KzpZJQEQnjkUWyunAOhF_Q.png" alt=""></p>
<h2 id="使用技術及觀念："><a class="header-anchor" href="#使用技術及觀念："></a>使用技術及觀念：</h2>
<ul>
<li>Vue.js （with vue-cli3)</li>
<li>Node.js (express with express-generator)</li>
<li>Heroku</li>
<li>CORS Headers</li>
<li>Jsonp (僅技術講解)</li>
</ul>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>同源政策</li>
<li>Node.js — express generator</li>
<li>HTTP 的 CORS Request</li>
<li>修改 Response Header 允許跨域</li>
<li>部署到Heroku</li>
<li>Vue-Cli dev 模式下的proxy</li>
<li>什麼是Jsonp</li>
<li>寫在最後</li>
</ul>
<h2 id="同源政策"><a class="header-anchor" href="#同源政策"></a>同源政策</h2>
<p>一般開發網站的時候，如果是採前後端分離的架構，就會遇到跨域問題。就像今天這個專案，我的目標是抓取台灣空氣品質的開放API，回來做成介面給使用者搜尋，但是在利用axios直接打API的時候，遇到了下面的狀況：</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*Cz2_mdRYD01VTjFs.png" alt=""><br>
這是因為網頁在傳遞資料的時候，不管是透過傳統XMLHttpRequest（常見的ajax方式） 或是Fetch，都會遵循同源政策(Same Origin Policy)，「同源」指的是同個域名底下的資源，因為只能存取相同來源的資料，所以那些跨域的請求就會被阻擋掉。</p>
<p>這是瀏覽器的安全機制，當然並非如此一來就無法跨域存取了，我想到的解決有以下兩種：</p>
<ul>
<li>Jsonp (Json with padding)</li>
<li>使用Proxy 代理伺服器存取該目標API</li>
</ul>
<p>因為jsonp的相關知識文章應該有不少，且有安全性疑慮（最後面會說明）。本篇會以Node實做Proxy為主來講解。</p>
<h2 id="node-js-express-generator"><a class="header-anchor" href="#node-js-express-generator"></a>Node.js — express generator</h2>
<p>跟前端有vue-cli 、 react-create-app 等方便又快速的手腳架一樣，許多後端框架也有類似的功能，express-generator就是其中一個。安裝方式非常簡單，如果對接下來流程有任何疑問，可以參考官方文件，有很詳細的使用說明。</p>
<p>在terminal輸入以下指令以安裝</p>
<pre><code>npm install express-generator -g
</code></pre>
<ol start="2">
<li>輸入 express [你的專案名稱] 就可以產生出以express為基底的專案架構：</li>
</ol>
<pre><code>express  proxy-server
</code></pre>
<p>接下來就可以進入專案去新增我們要的api了。</p>
<h2 id="http-的-cors-request"><a class="header-anchor" href="#http-的-cors-request"></a>HTTP 的 CORS Request</h2>
<p>就像前面說的，CORS Request並非完全不可行，只是在Server端必須要有一些設定。既然我們不可能修改OpenAPI的Server內容，又因為後端資料交互是不會碰到瀏覽器的（因此就不會因為跨域問題被阻擋），我們就自己架一個Proxy Server來修改Http相關的設定，讓前端可以順利拿到資料。</p>
<h3 id="cors-request-response流程"><a class="header-anchor" href="#cors-request-response流程"></a>CORS Request / Response流程</h3>
<p>你在 <a href="http://example.com.tw">example.com.tw</a> 送出request給某網站的時候，在request body裡面會夾帶一個Origin的header，內容是你網站的Domain名稱：</p>
<pre><code>Origin: http://www.foo.com
</code></pre>
<p>而在後端伺服器收到request並且回傳resonse到client的時候，瀏覽器會去看response裡面的header–***「Access-Control-Allow-Origin」***是不是包含剛剛發出request寫的Origin 域名，如果有，資料才會允許被回傳。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*mFny2JjLLy4Xt3dn.png" alt=""></p>
<h2 id="修改-response-header-允許跨域"><a class="header-anchor" href="#修改-response-header-允許跨域"></a>修改 Response Header 允許跨域</h2>
<p>先到剛剛創造的express專案底下。</p>
<p>先找到我們的Open API URL，等等會用到:</p>
<pre><code>http://opendata.epa.gov.tw/webapi/api/rest/datastore/355000000I-000259
</code></pre>
<p>###安裝所需套件<br>
因為我們要利用後端去跟遠端Open API互動，所以這邊我們使用node-rest-client來達成這部分功能，node-rest-client官方文件：</p>
<pre><code>npm install node-rest-client
</code></pre>
<h2 id="新增api路由"><a class="header-anchor" href="#新增api路由"></a>新增API路由</h2>
<p>在剛剛創造的express專案底下的主程式routes資料夾新增 air.js :</p>
<pre><code>air.js

var express = require('express');
var router = express.Router();
var Client = require('node-rest-client').Client;
var client = new Client();
/* GET users listing. */
router.get('/', function(req, res, next) {
    let queries=req.query
    console.log('query: ', queries);
    let url='http://opendata.epa.gov.tw/webapi/api/rest/datastore/355000000I-000259'
    var options = {
        host: url,
        method: 'GET'
      };
    
    client.get(url, function (data, response) { 
        res.json({...data})
    });
});
module.exports = router;
</code></pre>
<p>router.get() 是express的router基本寫法，最後將這個包含自定義route的Router實體export出去，之後必須在主程式app.js引入才會有效，可以參考官方文件，可以看到在rest-client抓完資料的callback，我用json方式回傳了Open API 回傳的結果。</p>
<pre><code>  ...
  client.get(url, function (data, response) { 
      res.json({...data})
  });
  ...
</code></pre>
<p>主程式app.js路由引入<br>
接下來在app.js裡面將剛剛新增的router引入：</p>
<pre><code>var airRouter = require('./routes/air');
app.use('/air', airRouter);
</code></pre>
<p>記得在var app=express()之後才做app.use()這件事，否則會讀不到app這個變數。</p>
<h3 id="關鍵步驟：-response-header-設定"><a class="header-anchor" href="#關鍵步驟：-response-header-設定"></a>關鍵步驟： Response header 設定</h3>
<p>將設定用middle的方式寫入，Express內，如果你直接在app.use()裡面傳入一個</p>
<pre><code>function(req, res, next) {
     next()d
 }
</code></pre>
<p>那是middleware的意思，即所有request都會經過你傳入的function，且直到呼叫next()之後才會繼續執行，我們在這裡面設定Response 的Header，如此一來所有的Request都會得到相同的Header設定值（也可以在單獨某隻router寫入設定，可視需求改變）。</p>
<pre><code>let allowCrossDomain = function(req, res, next) {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');
  next();
}
app.use(allowCrossDomain)
</code></pre>
<p>我在Response Header裡面加入了</p>
<ul>
<li>&quot;Access-Control-Allow-Methods&quot;代表允許讓設定的Http Method通過。</li>
<li>“Access-Control-Allow-Origin”，其值為’*’。</li>
</ul>
<p>注意，剛剛說Response<strong><em>回傳到Client之前瀏覽器會先檢查這個Header有沒有跟來源Origin的值ㄧ樣</em></strong>，<a href="http://xn--sercerxxx-u75nga779d6ngga17hn75f8ywyj1aqkd9ud023jha711xtw3bpa9973gyte0x4c.com.tw">如果是一般前後端分離的sercer這部分的值一般會xxx.com.tw</a>，不會公開。如果你這樣寫，代表大家都可以對你的Server做跨域請求，這邊因為是open API 且是示範性質所以才這樣做。</p>
<p>到這邊其實已經完成了，如果順利的話你的Server應該已經可以拿到遠端API的資料，你可以用</p>
<pre><code>npm run start  
// then go to  http://localhost:3000/air
</code></pre>
<p>在本地架起來用瀏覽器或Postman去測試看看。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*kGPyb1rX_NtKFzrt.png" alt=""></p>
<h2 id="部署到heroku"><a class="header-anchor" href="#部署到heroku"></a>部署到Heroku</h2>
<p>想要在Heroku 架起一台node Server非常簡單，流程大致上是註冊帳號-&gt;安裝heroku cli-&gt; 登入-&gt; 到你的專案輸入幾個指令-&gt; 最後 git push heroku master，他自己就會幫你在heroku提供的空間下npm install安裝好需要的套件並且架起來。</p>
<p>這邊就不多做說明，可參考官方教學，相信我，不會花掉你太多時間的，可先用官方提供的專案做練習。需注意的是因為是免費的服務，所以只要半小時沒在使用，他會暫時關閉你的機器，所以有時候連線會比較慢，可不要以為壞掉了。</p>
<p>可參考我的實作成果。</p>
<h2 id="vue-cli-dev-模式下的proxy"><a class="header-anchor" href="#vue-cli-dev-模式下的proxy"></a>Vue-Cli dev 模式下的proxy</h2>
<p>Vue-cli因為是基於webpack，其實有proxy的設定，你可以參考官方文件。但因為這樣只解決開發環境的問題，所以後來我才打算自己架設Proxy。</p>
<p>另外，前端的部分因為比較基礎，就沒有太詳細解說，你可以看看我的Repo，如果還是有不懂的地方，隨時可以聯絡我。</p>
<h2 id="什麼是jsonp"><a class="header-anchor" href="#什麼是jsonp"></a>什麼是JSONP</h2>
<p>因為傳統 Ajax無法跨域，早期工程師們找到了替代解決方案—&lt; script&gt; tag 的src引用是可以跨域的，於是利用這個原理的jsonp就這麼誕生了（想想你在引入一些js函式庫如lodash的時候是不是可以用cdn方式直接引入執行？)</p>
<h3 id="jsonp會做什麼事情"><a class="header-anchor" href="#jsonp會做什麼事情"></a>Jsonp會做什麼事情</h3>
<ol>
<li>創造一個 &lt; script &gt; tag</li>
<li>根據你指定的Jsonp位置，設定這個tag的src</li>
<li>把這個&lt; script &gt; 加到瀏覽器DOM的head</li>
<li>一但資料載入完畢，會將回傳的資料傳給設定的callback並執行這些內容</li>
</ol>
<h3 id="jsonp的安全隱患"><a class="header-anchor" href="#jsonp的安全隱患"></a>Jsonp的安全隱患</h3>
<p>如果你使用JsonP，那你帶進來的這些內容，跟你自己寫的jsㄧ樣，可以去存取你的DOM等網頁內容，這種情況下如果無法保證server的安全性，將會是潛在的問題。</p>
<h2 id="寫在最後"><a class="header-anchor" href="#寫在最後"></a>寫在最後</h2>
<p>前端介面成果：<a href="http://underground-air.surge.sh/">http://underground-air.surge.sh/</a><br>
Proxy Server成果： <a href="https://mu-air-proxy.herokuapp.com/air">https://mu-air-proxy.herokuapp.com/air</a></p>
<p>到這邊，如果你可以很順的理解以上的內容，那你應該對CORS Request流程有一定的了解了。其實因為時間跟篇幅的關係，有些實作部分我並沒有講的很仔細，但是我都有提供相關文件在該段落的附近，因為我覺得寫程式常常需要的是閱讀文件的能力，希望各位可以學著找到自己所需的資源並補上。在「尋找資源-實作-找問題修Bug」的循環過程中其實也在訓練自己的理解跟整合能力，才會讓你慢慢進入學習的正向循環。</p>
<p>當然在這過程中有任何的不懂或是覺得有筆誤的話都可以隨時聯絡我，我很樂意跟你分享我所知道的知識。</p>
<h2 id="參考文章"><a class="header-anchor" href="#參考文章"></a>參考文章</h2>
<p><a href="https://stackoverflow.com/questions/32500073/request-header-field-access-control-allow-headers-is-not-allowed-by-itself-in-pr">STOF上關於CORS的討論</a></p>
<p><a href="https://fetch.spec.whatwg.org/#http-cors-protocol">CORS PROTOCAL</a></p>
<p><a href="https://schier.co/blog/2013/09/30/how-jsonp-works.html">how jsonp works?</a></p>
<p><a href="https://www.html5rocks.com/static/images/cors_server_flowchart.png">CORS流程圖</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-12T11:37:08.000Z">2019-02-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分鐘 閱讀文 (大約 1065 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/12/world-time/">JS世界時間表</a>
            
        </h1>
        <div class="content">
            <p>這篇講解的是我如何從頭開始研究Javascript時區轉換相關API，以及一些時區相關的奇怪專有詞，最後做出世界時間表，我會盡使用淺顯易懂的方式來說明，如果你看完還是對內容有疑問，可以直接聯絡我 ，一起交流。順帶一提，你沒看錯現在是早上4:30 (X_X)。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*iejluh4QdHbaGTzTVIch2w.png" alt=""></p>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>TimeStamp是什麼?</li>
<li>GTM+8 與 UTC+8 ? 差在哪?</li>
<li>toLocaleTimeString的使用</li>
<li>補充：DOM 操作 — cloneNode</li>
</ul>
<h2 id="timestamp是什麼"><a class="header-anchor" href="#timestamp是什麼"></a>TimeStamp是什麼?</h2>
<p>TimeStamp 可以想成是某個執行動作的時間點，經常我們在操作資料的時候（最常見新增/修改），會希望留下時間紀錄，以免出問題的時候可以追查。就像公家單位的公文在蓋章的時候都會有時間戳記，系統也是ㄧ樣，只不過有時候不是我們常見的日期格式。</p>
<p>要用js觀察TimeStamp，可以在瀏覽器下:</p>
<pre><code>Date.now(); //1549041946540
</code></pre>
<p>你應該可以得到奇怪的一串數字，類似這樣</p>
<pre><code>1549041946540
</code></pre>
<p>這個是什麼意思呢？是指從 1970/01/01開始至今的秒數，也就是TimeStamp。<br>
為什麼是1970年？據說那是工程師們自己訂的，Unix系統的誕生日期。一樣透過Date物件可以把這串秒數轉成一般的TimeString:</p>
<pre><code>new Date(Date.now()) // Sat Feb 02 2019 01:32:14 GMT+0800 (台北標準時間)
</code></pre>
<p>TimeString 也是String，只不過有一定的格式，才能給Date相關api讀取。<br>
有興趣的人可參考這篇 。</p>
<h2 id="gtm-8-與-utc-8-差在哪"><a class="header-anchor" href="#gtm-8-與-utc-8-差在哪"></a>GTM+8 與 UTC+8 ? 差在哪?</h2>
<p>其實這兩種格式在一般使用的情況下沒有差別，只是GTM是歷史沿革，UTC是後來科學家發現一種可以更準確測量時間的方式而訂出的格式，他們之間的時間差只在區區幾秒之間（但這足以讓某些科學家抓狂），總之，因為GTM這個格式已經被國際使用許久，所以就算UTC出現以後，還是沒有消失 (跟IEㄧ樣，號稱時代的眼淚，但你不消失我才會流淚)。</p>
<p>W3School的解釋：</p>
<blockquote>
<p>The UTC() method returns the number of milliseconds between a specified date and midnight of  January 1, 1970, according to universal time. Tip: The Universal Coordinated Time (UTC) is the time set by the World Time Standard. Note: UTC time is the same as GMT time.</p>
</blockquote>
<p>基本上把他看做ㄧ樣就行了（除非你真的無法無視閏秒XD）我自己一般還是習慣使用UTC格式。</p>
<pre><code>new Date(Date.now()).toUTCString() // 拿到目前UTC+0 的時間
</code></pre>
<h2 id="tolocaletimestring的使用"><a class="header-anchor" href="#tolocaletimestring的使用"></a>toLocaleTimeString的使用</h2>
<p>Js裡面時間相關api有很多，要算出不同時區的時間其實有不只一種方式，這裡用我覺得比較直觀的toLocaleTimeString()，第一個參數是語系，在後面的Option裡面可以設定很多格式，timeZone就是用來設定時區：</p>
<pre><code>let now = new Date(Date.now())
let month= now.toLocaleDateString(‘en-US’,{timeZone:’Your Time Zone’’,month:’long’})
</code></pre>
<p>TimeZone 的格式可以<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">參考這個列表</a>，我拿到時區後，直接綁在html上面，這樣在一開始渲染時，就可以直接拿到，非常直接。</p>
<pre><code> &lt;li class=”zone London bg-white” id=”London” time-zone=”Europe/London” &gt;…&lt;/li&gt;
</code></pre>
<p>option 兩個常用設定值</p>
<ol>
<li>在Option裡面除了設定timeZone，也可以設定時制</li>
</ol>
<pre><code>{…hour12:false} //24小時制
</code></pre>
<ol start="2">
<li>甚至可以直接拿到完整的月份名字，如此一來就不需要另外寫月份的mapping表:</li>
</ol>
<pre><code>let now = new Date(Date.now())
let month= now.toLocaleTimeString(‘en-US’,{timeZone,month:’long’})
 //”February, 3:44:46 PM”
</code></pre>
<h2 id="補充：dom-操作-clonenode"><a class="header-anchor" href="#補充：dom-操作-clonenode"></a>補充：DOM 操作 — cloneNode</h2>
<p>這邊比較特別的是，因為重複的版型我習慣利用類似template的方式去做，所以我在底下區塊把重複的結構拉出來：</p>
<pre><code> &lt;div id=”zone-template” style=”display:none”&gt;
 &lt;div class=”country”&gt;
 &lt;div class=”name”&gt;NEW YORK&lt;/div&gt;
 &lt;i class=”date”&gt;27 JAN,2019&lt;/i&gt;
 &lt;/div&gt;
 &lt;div class=”time”&gt;02:46 &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
<p>然後在畫面啟動的時候在去跑回圈一個一個掛到<code>&lt;li&gt;</code>裡面，記得使用cloneNode，確保這個版型能夠成功複製到每個區塊，如果單純用appendChild可能會有問題，詳情可以參考這篇。</p>

        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-4-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/avatar.png" alt="Mujing Tsai">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Mujing Tsai
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        -
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Taipei, Taiwan</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            64
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分類
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            10
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        標籤
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            19
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://www.facebook.com/mujing" target="_blank" rel="noopener">
                追蹤</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/moojing">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Facebook" href="https://www.facebook.com/mujing">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://www.linkedin.com/in/mu-jing-tsai/">
                
                <i class="fab fa-linkedin"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            連結
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://ithelp.ithome.com.tw/users/20106580/ironman/2503" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">11th鐵人賽</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">ithelp.ithome.com.tw</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分類
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Canvas/">
            <span class="level-start">
                <span class="level-item">Canvas</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/FullStack/">
            <span class="level-start">
                <span class="level-item">FullStack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/IThome-鐵人賽30天/">
            <span class="level-start">
                <span class="level-item">IThome - 鐵人賽30天</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">30</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Javascript/">
            <span class="level-start">
                <span class="level-item">Javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Javascript-React/">
            <span class="level-start">
                <span class="level-item">Javascript React</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/TypeScript/">
            <span class="level-start">
                <span class="level-item">TypeScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Webpack/">
            <span class="level-start">
                <span class="level-item">Webpack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/devOps/">
            <span class="level-start">
                <span class="level-item">devOps</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/w3HexSchool-2020-年度鐵人賽/">
            <span class="level-start">
                <span class="level-item">w3HexSchool 2020 年度鐵人賽</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/走在漫漫長路-工作心得/">
            <span class="level-start">
                <span class="level-item">走在漫漫長路 - 工作心得</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            彙整
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/04/">
                <span class="level-start">
                    <span class="level-item">四月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/09/">
                <span class="level-start">
                    <span class="level-item">九月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">17</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            標籤雲
        </h3>
        <a href="/tags/backend/" style="font-size: 15.71px;">backend</a> <a href="/tags/canvas/" style="font-size: 10px;">canvas</a> <a href="/tags/devOps/" style="font-size: 11.43px;">devOps</a> <a href="/tags/frontend/" style="font-size: 20px;">frontend</a> <a href="/tags/frontend-force/" style="font-size: 17.14px;">frontend-force</a> <a href="/tags/ironman30/" style="font-size: 17.14px;">ironman30</a> <a href="/tags/javascript/" style="font-size: 18.57px;">javascript</a> <a href="/tags/rails/" style="font-size: 15.71px;">rails</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/ruby/" style="font-size: 15.71px;">ruby</a> <a href="/tags/ruby-on-rails/" style="font-size: 15.71px;">ruby on rails</a> <a href="/tags/typeScript/" style="font-size: 11.43px;">typeScript</a> <a href="/tags/typescript/" style="font-size: 12.86px;">typescript</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/vue-js/" style="font-size: 10px;">vue.js</a> <a href="/tags/w3HexSchool/" style="font-size: 14.29px;">w3HexSchool</a> <a href="/tags/working/" style="font-size: 11.43px;">working</a> <a href="/tags/地下城/" style="font-size: 14.29px;">地下城</a> <a href="/tags/鐵人賽30天/" style="font-size: 17.14px;">鐵人賽30天</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2021/04/03/react-compound-component/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React 設計模式 - 複合元件">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-04-03T10:14:38.000Z">2021-04-03</time></div>
                    <a href="/2021/04/03/react-compound-component/" class="title has-link-black-ter is-size-6 has-text-weight-normal">React 設計模式 - 複合元件</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Javascript-React/">Javascript React</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/06/working-reward/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/reward-cover.JPG" alt="每個衝擊都是一次學習的機會 - 近期的一點心得">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-06T09:36:53.000Z">2020-09-06</time></div>
                    <a href="/2020/09/06/working-reward/" class="title has-link-black-ter is-size-6 has-text-weight-normal">每個衝擊都是一次學習的機會 - 近期的一點心得</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/走在漫漫長路-工作心得/">走在漫漫長路 - 工作心得</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/03/09/working-environment/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/work-life.jpg" alt="寫給職場工作者：工作環境是否會影響一個人的思考方式？">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-08T20:54:46.000Z">2020-03-09</time></div>
                    <a href="/2020/03/09/working-environment/" class="title has-link-black-ter is-size-6 has-text-weight-normal">寫給職場工作者：工作環境是否會影響一個人的思考方式？</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/走在漫漫長路-工作心得/">走在漫漫長路 - 工作心得</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/03/07/web-dnd-2/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/DragnDrop.jpg" alt="就是要一起拖拖拉拉！(二) - 利用 DataTransfer API 實作拖拉元素間的資料傳遞">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-07T08:39:14.000Z">2020-03-07</time></div>
                    <a href="/2020/03/07/web-dnd-2/" class="title has-link-black-ter is-size-6 has-text-weight-normal">就是要一起拖拖拉拉！(二) - 利用 DataTransfer API 實作拖拉元素間的資料傳遞</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/w3HexSchool-2020-年度鐵人賽/">w3HexSchool 2020 年度鐵人賽</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/02/28/web-dnd-1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/DragnDrop.jpg" alt="就是要一起拖拖拉拉！(一) - 瀏覽器 Drag and Drop API 操作">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-28T02:04:03.000Z">2020-02-28</time></div>
                    <a href="/2020/02/28/web-dnd-1/" class="title has-link-black-ter is-size-6 has-text-weight-normal">就是要一起拖拖拉拉！(一) - 瀏覽器 Drag and Drop API 操作</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/w3HexSchool-2020-年度鐵人賽/">w3HexSchool 2020 年度鐵人賽</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                標籤
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/backend/">
                        <span class="tag">backend</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/canvas/">
                        <span class="tag">canvas</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/devOps/">
                        <span class="tag">devOps</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/frontend/">
                        <span class="tag">frontend</span>
                        <span class="tag is-grey">62</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/frontend-force/">
                        <span class="tag">frontend-force</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ironman30/">
                        <span class="tag">ironman30</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/javascript/">
                        <span class="tag">javascript</span>
                        <span class="tag is-grey">56</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/rails/">
                        <span class="tag">rails</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/react/">
                        <span class="tag">react</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ruby/">
                        <span class="tag">ruby</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ruby-on-rails/">
                        <span class="tag">ruby on rails</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/typeScript/">
                        <span class="tag">typeScript</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/typescript/">
                        <span class="tag">typescript</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/vue/">
                        <span class="tag">vue</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/vue-js/">
                        <span class="tag">vue.js</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/w3HexSchool/">
                        <span class="tag">w3HexSchool</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/working/">
                        <span class="tag">working</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/地下城/">
                        <span class="tag">地下城</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/鐵人賽30天/">
                        <span class="tag">鐵人賽30天</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="Moojing&#39;s Blog" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2021
                 <!-- Moojing&nbsp; -->
                
                <!-- Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a> -->
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-TW");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://www.muji.dev',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到頁首" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="請輸入關鍵字..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '頁面',
                CATEGORIES: '分類',
                TAGS: '標籤',
                UNTITLED: '(無標題)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>