<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 3.9.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>標籤: javascript - Moojing&#39;s Blog</title>


    <meta name="keywords" content="frontend,backend,javascript">
<meta property="og:type" content="website">
<meta property="og:title" content="Moojing&#39;s Blog">
<meta property="og:url" content="https://www.muji.dev/tags/javascript/page/3/index.html">
<meta property="og:site_name" content="Moojing&#39;s Blog">
<meta property="og:locale" content="zh-TW">
<meta property="og:image" content="https://www.muji.dev/images/og_image_name.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Moojing&#39;s Blog">
<meta name="twitter:image" content="https://www.muji.dev/images/og_image_name.png">







<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134605527-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-134605527-1');
</script>
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Moojing&#39;s Blog" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About Me</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="搜尋" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-8-widescreen has-order-2 column-main"><div class="card">
    <div class="card-content">
        <nav class="breadcrumb" aria-label="breadcrumbs">
        <ul>
            <li><a href="/tags">標籤</a></li>
            <li class="is-active"><a href="#" aria-current="page">javascript</a></li>
        </ul>
        </nav>
    </div>
</div>

    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-05-10T01:25:30.000Z">2019-05-10</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Webpack/">Webpack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分鐘 閱讀文 (大約 1925 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/05/10/webpack-react-1/">React 與 Webpack4 專案建置全實戰 (1)</a>
            
        </h1>
        <div class="content">
            <img src="/2019/05/10/webpack-react-1/webpack-logo.png" title="Cover Photo">
<p>寫了快一年的 Vue ，最近剛接觸 React ，我還挺中意這種架構跟撰寫方式的，所以順手研究了一下 Webpack。如果你在開發時是使用react-create-app 之類的手腳架，應該會跟 Vue 的 vue-cli 工具蠻類似的。但這類工具不太容易客製化的調整設定（有時候，你並不需要那麼多功能）。</p>
<p>所以為了讓自己能夠適應各種需求跟情況，我打算試試看打造一個適合自己做開發的 React 起始專案，方便之後進行任何需要 React 開發的時候使用。</p>
<h2 id="適合閱讀對象"><a class="header-anchor" href="#適合閱讀對象"></a>適合閱讀對象</h2>
<p>適合有至少接觸過手腳架工具或是 Gulp、Grunt 等 Task Runner 處理檔案的 Js 開發者，完全初學者建議先用手腳架練習即可，以免未入門先棄坑。</p>
<h2 id="大綱"><a class="header-anchor" href="#大綱"></a>大綱</h2>
<p>因為文章內容有點多，所以我預計分為三個部分來解說：</p>
<h3 id="第一部分"><a class="header-anchor" href="#第一部分"></a>第一部分</h3>
<ul>
<li>配置說明</li>
<li>webpack 緣由</li>
<li>安裝 webpack</li>
<li>webpack.config.js 設定及說明</li>
</ul>
<h3 id="第二部分"><a class="header-anchor" href="#第二部分"></a>第二部分</h3>
<ul>
<li>使用 package.json 建立自己的 script 指令集</li>
<li>webpack-dev-server</li>
<li>開始撰寫 JS 程式碼</li>
</ul>
<h3 id="第三部分"><a class="header-anchor" href="#第三部分"></a>第三部分</h3>
<ul>
<li>引入 React</li>
<li>搭配 Eslint 做檢查</li>
<li>延伸文章</li>
</ul>
<h2 id="配置說明"><a class="header-anchor" href="#配置說明"></a>配置說明</h2>
<p>預計會使用到的工具如下 :</p>
<ol>
<li>webpack : 一定要的</li>
<li>webpack-dev-server : 加速開發流程</li>
<li>babel : 用來把專案裡的 JS 及 JSX 轉譯成為瀏覽器看得懂的程式碼</li>
<li>sass : 方便做 CSS元件模組化，ㄧ樣需要轉譯成 CSS</li>
<li>eslint : 檢查 JS 撰寫習慣必備</li>
</ol>
<!--6. prettier : 超好用程式碼排版工具，要注意是否會跟 eslint 相衝突-->
<h2 id="webpack"><a class="header-anchor" href="#webpack"></a>Webpack</h2>
<h3 id="什麼是-webpack"><a class="header-anchor" href="#什麼是-webpack"></a>什麼是 Webpack ?</h3>
<p>Webpack 是一套非常完整的前端打包工具，他讓開發人員透過設定檔的方式很方便的去規劃專案架構。早期我們撰寫 Sass 的時候是透過 Grunt 或是 Gulp 等Task Runner來做轉譯，但以現在前端開發的規模，除了 Sass 轉譯，我們常常還需要處理其他事情，例如 minify、uglify 及 JS新舊版轉譯，當這些事情開始複雜起來的時候，相較於一個一個去撰寫 Task 的內容，有一個統一設置入口的 Webpack 就方便快速許多。</p>
<img src="/2019/05/10/webpack-react-1/webpack-logo.png" title="Cover Photo">
<h2 id="安裝-webpack"><a class="header-anchor" href="#安裝-webpack"></a>安裝 Webpack</h2>
<p>Webpack 必須在 node 環境下執行，所以請注意你的系統是否有安裝 node ，如果沒有，我推薦你使用 nvm 安裝，除了可以方便的管理你的 node 版本，連 npm 都幫你裝好了。</p>
<h3 id="step1-產生-package-json"><a class="header-anchor" href="#step1-產生-package-json"></a>Step1. 產生 package.json</h3>
<p>你的專案目錄底下必須 package.json 檔案以紀錄你使用的套件，這邊可以使用指令：</p>
<pre><code class="language-js">     npm init
</code></pre>
<p>來產生 package.json，輸入後會有一些關於設定的問題，如專案名稱或是版本號，請依照自己的意思輸入就好。</p>
<h3 id="step2-用-npm-安裝webpack"><a class="header-anchor" href="#step2-用-npm-安裝webpack"></a>Step2. 用 npm 安裝webpack</h3>
<p>webapck 只會在開發環境使用，所以安裝的時候請加上參數</p>
<pre><code class="language-js"> npm install --save-dev webpack
</code></pre>
<h3 id="step3-使用-webpack-cli"><a class="header-anchor" href="#step3-使用-webpack-cli"></a>Step3. 使用 webpack-cli</h3>
<p>如果一開始不熟，想要快速產生設定檔模板的話，我找到了一個還不錯的工具： webpack-cli，它用起來就像上面 npm init ，使用互動介面來幫你產生設定檔。</p>
<pre><code class="language-js">npm i webpack-cli @webpack-cli/init
npx webpack-cli init
</code></pre>
<p>webpack-cli還有其他方便的指令，可以參考<a href="https://github.com/webpack/webpack-cli">他的Github</a>，但我後續還是比較習慣手動修改內容。</p>
<img src="/2019/05/10/webpack-react-1/webpack-cli.png" title="webpack-cli">
<p>以上有幾個地方值得注意的：</p>
<ul>
<li>
<p>第二個問題提到的「 entry file 」 指的是 Ｗebpack 來抓取你來源檔，準備編譯輸出時，所「進入」的第一個檔案，你可以想成是進入點。</p>
</li>
<li>
<p>第三個提問：「what the location of the app…」指的是進入點檔案的確切位置（相對於專案根目錄）</p>
</li>
<li>
<p>第四個提問：「 which folder will your…」指的是 檔案打包處理完之後要輸出到哪裡。</p>
</li>
</ul>
<p>最後一個提問由於我還是比較習慣 使用sass，所以我選擇它。</p>
<h2 id="webpack-config-js-設定及說明"><a class="header-anchor" href="#webpack-config-js-設定及說明"></a>webpack.config.js 設定及說明</h2>
<p>產生完 config 檔之後，你會在裡面最先看到的應該有 module 、 entry 、 output 、plugins 四個設定，而這也是我們在調整的時候最長會需要注意的四個設定，以下將一一簡單介紹。</p>
<p>（ 使用 webpack-cli 所產生的 config 似乎不會產生entry設定，但沒關係，你可以之後再補上，而且 webpack 也會有預設值，所以不用擔心會有問題。 ）</p>
<h3 id="entry-："><a class="header-anchor" href="#entry-："></a>entry ：</h3>
<p>進入點，你可以直接給一個路徑字串，但他其實還可以用物件跟陣列來表示，這邊先不詳細說明。</p>
<pre><code class="language-js">   entry: './app.js',
</code></pre>
<h3 id="output"><a class="header-anchor" href="#output"></a>output</h3>
<p>輸出點，表示檔案被處理完之後要放的位置，最常被使用的名稱是「 dist 」。</p>
<pre><code class="language-js">    output: {
        path: path.join(__dirname, 'dist'),
        filename: '[name].js',
    },
</code></pre>
<h3 id="module"><a class="header-anchor" href="#module"></a>module</h3>
<p>用來定義不同種類的檔案（模塊）是如何被處理的，會根據不同的副檔名套用不同的 rule ，也是最主要告訴 webpack 檔案如何被處理的設定，舉例來說，剛剛在 cli 設定的時候，最後的預處理我選擇了 sass ，他就在模板裡幫我產生了下面的內容 ：</p>
<pre><code class="language-js">module: {
		rules: [
			{
				test: /\.(scss|css)$/,

				use: [
					{
						loader: 'style-loader'
					},
					{
						loader: 'css-loader'
					},
					{
						loader: 'sass-loader'
					}
				]
			}
		]
	},
</code></pre>
<p>以上設定的意思是「只要是.scss 或是 .css結尾的檔案，就幫我使用下列的處理方式。」，loader在 webpack 裡面主要是用來做轉譯處理的模組，所以記得在使用你想要的 loader前，要先使用 npm 安裝喔～</p>
<p>這邊要注意的是，當使用多個 loader 處理檔案時，loader 是從最後面開始被載入的（bottom-up），知道這點之後應該就可以理解上面的意思：</p>
<ol>
<li>先透過 sass-loader 將 sass 檔案轉成 css 後</li>
<li>然後透過 css-loader ，讓我在 js 檔裡可以直接引入</li>
<li>最後透過 style-loader ，以在 &lt;head&gt; 內插入 &lt;style&gt; 標籤的方式，讓我剛剛在 js 檔裡引入的 css 內容順利生效」</li>
</ol>
<h3 id="plugin"><a class="header-anchor" href="#plugin"></a>plugin</h3>
<p>除了上述 module 的處理，如果還有一些功能想要達成，還可以透過 webpack 的擴充套件來處理，例如我想要在把我 bundle 完的 js 檔案自動的插入某個 html 檔，讓我少做一些雜事，就可以使用 <a href="https://webpack.js.org/plugins/html-webpack-plugin">HtmlWebpackPlugin</a>，官方還有推出許多的 Plugin 以便符合不同使用情境，可以參考<a href="https://webpack.js.org/plugins">這裡</a>。</p>
<pre><code class="language-js">  plugins: [
    new HtmlWebpackPlugin({
      template: './static/index.html'
    }),
  ],
</code></pre>
<p>處理前的 html 模板（static/index.html）:</p>
<pre><code class="language-html">
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
     &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>處理後的 index.html:</p>
<pre><code class="language-html">&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
  &lt;body&gt;
     &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;
  &lt;script type=&quot;text/javascript&quot; src=&quot;/bundle.js&quot;&gt;
  &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>可以看到 Webpack 幫我們把需要的 js 跟 css 資源載進來了。</p>
<p>先寫到這裡，在這個部分我只針對設定的屬性功能做說明，還沒有確切說到如何使用 Webpack 進行打包處理，下個章節開始會有更多實作的部分，所以請你消化吸收關於這些設定的方法之後，繼續前進吧！</p>
<p>下一篇：<a href="https://moojing.github.io/2019/05/10/webpack-react-2/">React 與 Webpack專案建置全實戰 (2) </a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-08T16:59:29.000Z">2019-03-09</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分鐘 閱讀文 (大約 1081 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/09/8f-ooxx/">Vue.js 井字遊戲 - OOXX</a>
            
        </h1>
        <div class="content">
            <img src="/2019/03/09/8f-ooxx/cover.png" title="COVER">
<p>大家好，我在地下城8樓，題目是3x3井字遊戲，直覺想到最簡單的方式就是暴力檢查，每個Row跟Column去檢查有沒有相等的，最後加上對角線兩條。也看到別樓有分享Alex1&amp;10解法，覺得很高明。</p>
<p>不過我想看看有沒有不一樣的做法，相信一定有。剛剛講到Row跟Column，就讓我想到二維陣列。沒錯，整個井字窗格根本可以用座標來看，今天這個題目的解法會以二維陣列為主軸來解說作法，切版的部分則比較繁瑣且不難所以不會多提，有問題可以再跟我討論。</p>
<p>你可以在這裡看到我的<a href="https://moojing.github.io/demo/underground_8f/#/game">成果</a>，或是參考<a href="https://github.com/moojing/hex-underground/tree/master/8f_ooxx/src">原始碼</a>。</p>
<h2 id="規則"><a class="header-anchor" href="#規則"></a>規則</h2>
<ul>
<li>
<p>先手為 Ｏ，後手為 X，某方獲勝時，上方會紀錄各方的獲勝戰績</p>
</li>
<li>
<p>每回合結束後，會判定結果頁(平手、Ｏ獲勝、X獲勝)</p>
</li>
<li>
<p>需符合 RWD，能在低螢幕解析度也能遊玩，介面不能超出 x 軸，至少在以下解析度能夠遊玩:</p>
<ol>
<li>iPhone SE 320px</li>
<li>iPhone 8 375px</li>
<li>iPhone PLUS 414px</li>
</ol>
</li>
<li>
<p>請使用瀏覽器離線儲存技術，將戰績保留起來</p>
</li>
</ul>
<h2 id="資料結構"><a class="header-anchor" href="#資料結構"></a>資料結構</h2>
<p>為了讓對應到畫面的資料可以更直觀的操作跟查詢，我是這樣訂定格式的：</p>
<pre><code class="language-js">data(){
    return {
    ...
     currentPlayer:0,
     gameStatus:[[null,null,null],
                 [null,null,null],   
                 [null,null,null]]
            }}
</code></pre>
<p>陣列第0個元素代表的是第一個Row，Row本身也是陣列，剛好由左到右對應到0、1、2的位置，(0,0)對應到最左上，(2,2)對應到最右下，這樣直觀多了，如下圖所示：</p>
<img src="/2019/03/09/8f-ooxx/position.png" title="DATA STRUCTURE">
<p>然後用0表示O、1表示X，與上述資料結構的currentPlayer一樣，null則表示尚未下棋的位置，不過這邊不建議用0來做任何的判斷，原因稍後再提。</p>
<h2 id="判斷勝利者"><a class="header-anchor" href="#判斷勝利者"></a>判斷勝利者</h2>
<p>因為我用的資料表示是： O為0，X為1，因此如果整列、整行或交叉相加都是0，或是3，代表有人勝出，這時我只要取得currentPlayer就知道獲勝的是誰了。</p>
<h2 id="判斷勝利邏輯"><a class="header-anchor" href="#判斷勝利邏輯"></a>判斷勝利邏輯</h2>
<p>要判斷目前賽況是否有人勝出，我們需要檢查的部分有:</p>
<ul>
<li>每個Row（橫排）是否有連線</li>
<li>每個Column（直行）是否有連線</li>
<li>對角線是否有連線</li>
</ul>
<p>判斷對角線的部分比較麻煩，但你應該可以看出，使用陣列的方式可以清楚區分出Row跟Column，讓檢查更方便，檢查的時間點是每次使用者點完要下的棋格之後的瞬間，檢查完最後切換使用者(玩家)。</p>
<pre><code class="language-js">methods:{
...
onSectionClick(x,y){
         if (this.gameStatus[y][x]!==null) return //防止重複下棋
         this.gameStatus[y][x] = this.currentPlayer//下棋
         this.checkResult()//檢查賽況
         this.togglePlayer()//&lt;---下完後切換使用者

       },}
</code></pre>
<p>因為是二維陣列所以要兩層for迴圈，注意這邊因為要先取用Row，所以陣列的操作必須先從y (也就是直排) 開始選取，而不是一般座標的表示方式(x,y)，當然可以透過改變資料結構做出比較直觀的使用方式，不過因為沒有很困難，且為了解說方便，這邊就不做調整。</p>
<pre><code class="language-js">  let status = this.gameStatus
  for(let y=0; y&lt;status.length; y++){
    for(let x=0; x&lt;status[y].length; x++ ){
      // 用status[y][x]取得棋格元素 &lt;-----重要
    }
   }
   
</code></pre>
<p>知道取得陣列的方式之後就可以開始逐行逐列檢查啦！</p>
<h3 id="檢查row-column是否有連線"><a class="header-anchor" href="#檢查row-column是否有連線"></a>檢查Row / Column是否有連線</h3>
<p>想要取得Row整行的和，每次的y必須固定，我是在x為0的時候，取得後面兩個x+1、x+2元素，相加後算出總和，。</p>
<pre><code class="language-js">methods:{
...
getSumOfRow(x,y){
            let status = this.gameStatus
            if(x!==0 ) return 
             return status[y][x]+
                       status[y][x+1]+
                       status[y][x+2]
        },}
</code></pre>
<p>Coloum總和則為x y與上述相反：</p>
<pre><code class="language-js"> getSumOfColumn(x,y){
            let status = this.gameStatus
            if(y!==0 ) return 
            return   status[y][x]+
                     status[y+1][x]+
                     status[y+2][x]             
        },
</code></pre>
<p>取得總合後判斷是否有0或是3就知道有無勝出。</p>
<h3 id="檢查對角線是否有連線"><a class="header-anchor" href="#檢查對角線是否有連線"></a>檢查對角線是否有連線</h3>
<p>一樣是在迴圈一開始x為0以及ｙ為0的時候做判斷，在取得總和之前，我先看看是不是整個對角線都已經被下過棋了，如果沒有，則直接return 跳出不做任何動作。</p>
<pre><code class="language-js">methods:{
getSumOfNegativeSlash(x,y){
            let status = this.gameStatus
            if(x!==0 || y!==0 ) return 
            if(  !(this.isNumber(status[y][x]) &amp;&amp; 
                  this.isNumber(status[y+1][x+1]) &amp;&amp;
                  this.isNumber(status[y+2][x+2]))) return 
                        
            return   status[y][x]+ status[y+1][x+1]+status[y+2][x+2]
        },
        
}
</code></pre>
<p>另一個方向的對角線是同樣的做法，看到這裡的你應該可以推算出邏輯，如果還是不懂，可以參考文章開頭處的專案原始碼。</p>
<h3 id="整合所有的判斷邏輯-checkresult-method"><a class="header-anchor" href="#整合所有的判斷邏輯-checkresult-method"></a>整合所有的判斷邏輯 - checkResult method</h3>
<p>最後整個判斷邏輯如下，我把三種情況（Row / Column / 對腳線）個別寫下條件之後用OR串起來，只要狀況符合其中一種條件，就會結束賽局。</p>
<pre><code class="language-js">         checkResult(){
            
            let status = this.gameStatus
           for(let y=0; y&lt;status.length; y++){
               for(let x=0; x&lt;status[y].length; x++ ){
                   let sumOfCol = this.getSumOfColumn(x,y) 
                   let sumOfRow = this.getSumOfRow(x,y) 
                   if(
                        (   this.isRowAllNumber(x,y) &amp;&amp; 
                            sumOfRow=== 0||sumOfRow=== 3
                        )||(
                            this.isColumnAllNumber(x,y) &amp;&amp; 
                            sumOfCol === 0||sumOfCol === 3
                        )||(
                           this.getSumOfNegativeSlash(x,y)===0 || 
                           this.getSumOfNegativeSlash(x,y)===3 || 
                           this.getSumOfPositiveSlash(x,y)===0 || 
                           this.getSumOfPositiveSlash(x,y)===3
                        )){
                      this.setScore()  
                      this.goResultPage(this.currentPlayer)
                    }
               }
           }
           this.checkIfFinish()
        },
</code></pre>
<p>這邊有一個蠻麻煩的雷點就是js裡面null+0居然還是0，害我沒辦法直接正確判斷結果，導致我還寫了一個isRowAllNumber來判斷該列/欄是否全是數字，所以不推薦用0跟null搭配來當做相加的判斷。（你可以打開開發者工具試試看）</p>
<h2 id="使用localstorage紀錄分數"><a class="header-anchor" href="#使用localstorage紀錄分數"></a>使用localStorage紀錄分數</h2>
<p>這邊我使用localStorage來永久儲存比數，localStorage操作方式有以下幾種：</p>
<ul>
<li>localStorage.setItem(‘key’,‘content’)</li>
<li>localStorage.getItem(‘key’)</li>
<li>localStorage.removeItem(‘key’)</li>
</ul>
<p>瀏覽器上有另外一個操作方式很類似的api叫做sessionStorage，差別就在於localStorage除非主動刪除，否則會永久保留在瀏覽器、sessionStorage則是在分頁關閉後就會被刪除。</p>
<p>我把上面三個api另外包成三個function，讓我在各個元件可以方便使用，統一使用方式，以下是setItem的包裝：</p>
<pre><code class="language-js">export const setStorage = (name, content) =&gt; {
    if (!name) return;
    if (typeof content !== &quot;string&quot;) {
      content = JSON.stringify(content);
    }
    window.localStorage.setItem(name, content);
  };
</code></pre>
<p>getStorage、removeStorage則是類似的方式，在此就不多提。</p>
<h2 id="多思考一些-重置分數按鈕"><a class="header-anchor" href="#多思考一些-重置分數按鈕"></a>多思考一些 - 重置分數按鈕</h2>
<p>這邊思考的是，既然可以儲存戰績，那如果可以讓玩家手動清除分數，應該會更好用，很多遊戲也有這種功能。所以我將原本入口的START按鈕改為CONTINUE跟RESTART，如果兩邊分數為0才只顯示START。</p>
<img src="/2019/03/09/8f-ooxx/think.png" title="CONTINUE BUTTON">
<p>雖然是小地方但可以增加樂趣，算是一點小優化，給有興趣的人參考。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-03-03T15:04:53.000Z">2019-03-03</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Canvas/">Canvas</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 分鐘 閱讀文 (大約 2403 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/03/03/canvas-sketchpad/">Vue.js 實作 Canvas 畫板</a>
            
        </h1>
        <div class="content">
            <img src="/2019/03/03/canvas-sketchpad/cover.png" title="Cover Photo">
<p>大家好，我在地下城七樓。在網頁互動上，Canvas的表現速度比起傳統用DOM元素操作的方式快上許多，因此常有某些互動的需求會採用Canvas來達成，這個專案會從基礎開始解說我如何實作Canvas畫板。</p>
<p>你可以在<a href="https://moojing.github.io/demo/underground_7f/">這裡</a>看到我的實作成果，或是<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">在此</a>參考我的程式碼。</p>
<p>這個專案會盡量練習以我的角度寫出好讀的程式碼，什麼是好讀的程式碼？總該有個客觀定義，但以我目前所學來看，通常是有一定經驗的人，看夠別人寫的程式法，才能漸漸分辨好壞。不過俗話說取悅別人之前要先取悅自己，我想在這點上可以列一個最低限度的階段目標，就是先<strong>寫出讓自己好讀的程式碼。</strong> 畢竟如果自己都看得很吃力，那我想也絕對稱不上好讀。</p>
<p>P.S. 網路上應該可以找到不少討論這一點的<a href="https://medium.com/s/story/readability-as-usability-78c5a2a373cc?source=email-86564209b7e7-1551389956264-digest.reader------0-50------------------3ae9041b_fc1c_4d8c_95cd_2f5c22f35c7e-1&amp;sectionName=top">文章</a>。</p>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>Canvas - 指定渲染環境</li>
<li>封裝畫線方法</li>
<li>鉛筆工具</li>
<li>橡皮擦工具</li>
<li>Canvas轉成圖片</li>
<li>空心矩形</li>
<li>復原與重做</li>
<li>多思考一些 - 使用者體驗</li>
</ul>
<h2 id="指定渲染環境"><a class="header-anchor" href="#指定渲染環境"></a>指定渲染環境</h2>
<p>Canvas 會產生一個固定範圍的畫布，但開始繪製圖型之前， 由於canvas可以有很多種渲染環境，我們必須使用getContext()方法來指定想要的渲染方式，這邊畫布使用的是2d環境。</p>
<pre><code class="language-html">&lt;canvas ref=&quot;sketchpad&quot;&gt;&lt;/canvas&gt;
</code></pre>
<pre><code>methods:{
...
 setCanvas(){
      let canvas = this.$refs['sketchpad']
      canvas.width  = window.innerWidth
      canvas.height  = window.innerHeight - 60
      let ctx =  canvas.getContext('2d')
      ctx.lineCap = &quot;round&quot;
      ctx.lineJoin = &quot;round&quot;
      this.canvasContext = ctx
    },
}
</code></pre>
<h2 id="封裝畫線方法"><a class="header-anchor" href="#封裝畫線方法"></a>封裝畫線方法</h2>
<h3 id="基礎"><a class="header-anchor" href="#基礎"></a>基礎</h3>
<p>canvas畫線之前要先呼叫beginPath方法告知開始畫線，最後用stroke()畫出邊線或是用fill()填滿，一個畫線的簡單例子：</p>
<pre><code class="language-js">ctx.beginPath();       // Start a new path
ctx.moveTo(30, 50);    // Move the pen to (30, 50)
ctx.lineTo(150, 100);  // Draw a line to (150, 100)
ctx.stroke();          // Render the path
</code></pre>
<p>這段程式是在告訴canvas從座標(30,50)開始畫線到(150,100)，不過從beginPath開始，直到stroke()被呼叫為止，才會將線段渲染到畫板上，詳細說明可參考<a href="https://developer.mozilla.org/zh-TW/docs/Web/API/Canvas_API/Tutorial/Drawing_shapes#%E8%B7%AF%E5%BE%91%E7%B9%AA%E8%A3%BD">官方文件</a>。</p>
<h3 id="簡化"><a class="header-anchor" href="#簡化"></a>簡化</h3>
<p>每次要畫線段都要呼叫beginPath() 跟 stroke() 實在是太多餘了，我把每次都相同的部份用methods封裝起來，中間實際會改變的部分我用callback當作參數傳入這個method，這麼一來就可以減少重複的程式碼：</p>
<pre><code class="language-js">methods:{
    ...
     draw(action){
      let canvasContext = this.canvasContext
      canvasContext.beginPath()
      canvasContext.lineWidth = this.currentSize*2       
      action(canvasContext)
      canvasContext.stroke()
    },

}
</code></pre>
<p>實際使用：</p>
<pre><code class="language-js"> this.draw((ctx)=&gt;{
                        ctx.strokeStyle =  this.currentColor.code
                        ctx.moveTo(this.tempPosition.x,this.tempPosition.y)
                        ctx.lineTo(pos.x,pos.y)
                    })
</code></pre>
<p>如果你寫Js一段時間應該會發現常見的map或是filter也是類似的用法。</p>
<h2 id="實作鉛筆工具"><a class="header-anchor" href="#實作鉛筆工具"></a>實作鉛筆工具</h2>
<p>鉛筆工具實作上，基本上就是找出滑鼠按下的時候，滑鼠移動的軌跡，再將這些點用線段一個一個連起來，實作前有兩個問題要先想一下：</p>
<ul>
<li>如何記錄移動軌跡，每個點都記錄？還是只記錄一個？要記錄什麼時間點的軌跡</li>
<li>如何得知滑鼠現在是否為按下的狀態 ?</li>
</ul>
<p>我實作的方式是，在window新增mousemove監聽事件，事件被觸發時，記錄滑鼠移動到B點時的前一個點A點位置，然後因為在B點時的位置可以直接透過js api取得，這樣就能夠對照前後位置，以實作鉛筆功能。</p>
<pre><code class="language-js">window.addEventListener('mousemove',(event)=&gt;{
...
let currentPos = this.getCanvasMousePosition(event.clientX,event.clientY)
...
...
this.setCanvasTempPosition(currentPos.x,currentPos.y) 
           
})
</code></pre>
<p>取得鼠標位置的細節可參考我的<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">Github</a>。只看程式碼可能有點抽象，第一次移動的時候，tempPosition一定是空值，直到位置發生變化（從A到B)結束後，A點位置才會被記錄到tempPosition，完成前一軌跡記錄。</p>
<p>再來，如何確定滑鼠是否為按下狀態? 我在canvas元素上分別新增mousedown跟mouseup事件，並在Vue data新增一個布林值isCanvasMouseDown，以透過這兩個事件切換滑鼠狀態。</p>
<pre><code class="language-js">onCanvasMouseDown(){ 
      this.isCanvasMouseDown = true
      ...
    }

onCanvasMouseUp(){
    this.isCanvasMouseDown = false
  }
</code></pre>
<p>最後，就剩下canvas畫圖的功夫了，在畫圖之前記得先確認滑鼠狀態以及是否已有軌跡記錄之後再執行動作，否則會出錯：</p>
<p><strong>In MouseMove Event</strong></p>
<pre><code class="language-js">...
    if(this.isCanvasMouseDown &amp;&amp; this.tempPosition){
            let pos = this.getCanvasMousePosition(event.clientX,event.clientY)
            switch(this.currentTool){
              case 'paint-brush' : 
                    this.draw((ctx)=&gt;{
                        ctx.strokeStyle =  this.currentColor.code
                        ctx.moveTo(this.tempPosition.x,this.tempPosition.y)
                        ctx.lineTo(pos.x,pos.y)
                    })
                    break;
                    ...
</code></pre>
<h2 id="橡皮擦工具"><a class="header-anchor" href="#橡皮擦工具"></a>橡皮擦工具</h2>
<p>橡皮擦工具只是把已經畫上的圖案消去，這邊我直接用前面實作的筆刷工具，搭配背景色，可以達成一樣的效果，比較特別的是，我將canvas背景色記錄在vue data裡面，這樣就可以確保橡皮擦工具的顏色跟背景色是相同的值，減少錯誤發生機率。</p>
<h2 id="canvas-轉成圖片"><a class="header-anchor" href="#canvas-轉成圖片"></a>Canvas 轉成圖片</h2>
<p>轉成圖片不是什麼大問題，Canvas元素本身有一個toDataUrl，可以回傳回傳含有圖像的Url，最後再產生一個a元素，將網址貼上去後觸發click事件，就可以模擬點擊，達成下載圖片的功能。</p>
<pre><code class="language-js">canvasToImage(){
      let url =  this.$refs['sketchpad'].toDataURL(&quot;image/png&quot;, 1.0).replace(&quot;image/png&quot;, &quot;image/octet-stream&quot;);
      const link = document.createElement('a')
      link.innerText = 'Download'
      link.href = url 
      link.download = 'circle.png'     
      link.click()
    },
</code></pre>
<h2 id="空心矩形"><a class="header-anchor" href="#空心矩形"></a>空心矩形</h2>
<p>這個功能是我思考最久的一部分，canvas要單純畫上矩形的話只要呼叫rect()方法就行，方法說明如下：</p>
<pre><code class="language-js">ctx.rect(起始位置x, 起始位置y, 長度, 寬度);
</code></pre>
<p>這格應該不難理解，最難的是如何達成「滑鼠按下時可一邊調整矩形的大小跟長寬」如果像實作鉛筆功能時，在每個軌跡都畫圖型的話，就會發生災難：</p>
<img src="/2019/03/03/canvas-sketchpad/error-sample.png" title="Error Sample">
<p>看到這裡你應該可以了解原因了，因為我在每次滑鼠改變位置時都畫了一次。這邊要思考的是：</p>
<ul>
<li>使用矩形工具，滑鼠按下時要做什麼事情</li>
<li>什麼時候紀錄前一個移動軌跡，什麼時候不要</li>
</ul>
<p>我的解法是，當使用矩形工具，且偵測到mousedown事件時，在畫圖之前先用getImageData做一個簡單的暫存：</p>
<pre><code class="language-js">methods:{
...
setTempCanvas(){ 
      let ctx = this.canvasContext
      let canvas = ctx.canvas 
      let tempCanvas = ctx.getImageData(0, 0, canvas.width, canvas.height);
      this.tempCanvas = tempCanvas
    }, 
...
}
</code></pre>
<p>並且在每次滑鼠位置改變並且渲染矩形完成後，用putImageData() 把暫存復原，以上面災難圖為例，就是每次畫完之後，只會看到最為面那層。</p>
<h2 id="復與原重做"><a class="header-anchor" href="#復與原重做"></a>復與原重做</h2>
<p>我找到一篇描述利用window.history模擬瀏覽器上ㄧ頁下一頁功能的<a href="https://ithelp.ithome.com.tw/articles/10195793">文章</a>，實作步驟簡單來說就是在每次畫完圖型後將目前畫面暫存進history裡面，再去透過js操作瀏覽器上頁跟下頁來達成這個功能，蠻有趣的。</p>
<h2 id="多思考一些-使用者體驗"><a class="header-anchor" href="#多思考一些-使用者體驗"></a>多思考一些 - 使用者體驗</h2>
<p>有幾個細節是比較容易被忽略的，但是如果有這些小地方可以讓使用者操作或是開發上更順暢，這邊把想到的點列出：</p>
<ol>
<li>畫筆畫到一半，滑過工具列時，能不能繼續畫</li>
<li>調整大小時，能不能用拖拉調整</li>
</ol>
<h3 id="1-畫筆畫到一半-滑過工具列時-能不能繼續畫"><a class="header-anchor" href="#1-畫筆畫到一半-滑過工具列時-能不能繼續畫"></a>1.畫筆畫到一半，滑過工具列時，能不能繼續畫</h3>
<p>我原本是把Mousemove事件放在canvas上面，後來做到一半才發現當我畫到一半，滑鼠經過工具列，他不會繼續對canvas的滑鼠事件有動作，因此會中斷畫圖，後來我<strong>將Mousemove事件放在整個windows上，並判斷現在滑鼠狀態是否是按下(MouseDown)</strong>，才解決這個問題。</p>
<h3 id="2-調整大小時-能不能直接用拖拉調整"><a class="header-anchor" href="#2-調整大小時-能不能直接用拖拉調整"></a>2.調整大小時，能不能直接用拖拉調整</h3>
<p>會想到這個是因為很多繪圖軟體都有這個功能，這邊的雷點跟第一點一樣，必須將mouseMove事件放在window上面，否則拖拉到一半滑鼠離開input元素時，就會停止調整Size數值，反而很不好用。</p>
<p><strong>Vue Method:</strong></p>
<pre><code class="language-js">  checkSizeDrag(dragValue){
      if(dragValue&lt;0){ 
        this.currentSize =  parseInt(this.currentSize)+1
      }else if(dragValue&gt;0&amp;&amp;this.currentSize&gt;=1){
        this.currentSize = parseInt(this.currentSize)-1
      }
    },
</code></pre>
<p><strong>In MouseMove Event</strong></p>
<pre><code class="language-js"> 
window.addEventListener('mousemove',(event)=&gt;{
...
    let currentPos = this.getCanvasMousePosition(event.clientX,event.clientY)
    if(this.isSizing &amp;&amp; this.tempPosition ){
                let dragValue= currentPos.y- this.tempPosition.y 
                this.checkSizeDrag(dragValue)
    }
...
}
</code></pre>
<p>你可以在<a href="https://moojing.github.io/demo/underground_7f/">這裡</a>看到我的實作成果，或是<a href="https://github.com/moojing/hex-underground/blob/master/7f_canvas_sketchpad/src/App.vue">在此</a>參考我的程式碼。</p>
<h2 id="參考文章"><a class="header-anchor" href="#參考文章"></a>參考文章</h2>
<p>canvas基礎：<br>
<a href="http://test.domojyun.net/MEMO/Canvas/">http://test.domojyun.net/MEMO/Canvas/</a></p>
<p>pushState 實作復原及重做：<br>
<a href="https://ithelp.ithome.com.tw/articles/10195793">https://ithelp.ithome.com.tw/articles/10195793</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-18T04:03:19.000Z">2019-02-18</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分鐘 閱讀文 (大約 2008 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/18/60s-challenge/">Vue.js小遊戲實作-60秒算數挑戰</a>
            
        </h1>
        <div class="content">
            <p><img src="https://i.imgur.com/4yxfbeW.png" alt=""></p>
<p>大家好，我在六角地下城6f，這樓的挑戰是實作小遊戲，題目的邏輯是在六十秒內會產生隨機兩個數字去隨機做加減乘除， 答對就加一分，答錯就扣一分，秒數越少，題目越困難，得分就越高分。</p>
<p>題目詳細規則如下：</p>
<ul>
<li>0~20 秒為 1位數計算 (ex. 5-3)</li>
<li>21~40 秒為 2 位數計算 (ex. 30*19)</li>
<li>41~60 秒為 3 位數計算 (ex. 332+312)</li>
<li>加減乘除規則請用隨機產生，不可寫死題目，60 秒內可無限次數答題。</li>
<li>0~40 秒答對加一分</li>
<li>41~60 秒答對加五分</li>
<li>答錯扣一分，最多僅能扣到零分</li>
</ul>
<p>我打算在這個專案做邏輯梳理的練習，因此會盡量把有機會重複使用的部分拆成methods，這個專案只會講述核心部分的邏輯，也就是如何產生題目，以及一些可能的問題點，其他細節部分希望你自己做做看，你可以在<a href="http://underground-60s-game.surge.sh/">這裡</a>看到我實做的成果。或是也可以直接<a href="https://github.com/moojing/hex-underground/blob/master/6f_counter_game/src/App.vue">參考原始碼</a>。</p>
<h2 id="規則流程-運算："><a class="header-anchor" href="#規則流程-運算："></a>規則流程－運算：</h2>
<ol>
<li>產生隨機兩個數字</li>
<li>產生運算符號（加減乘除）</li>
<li>等待使用者輸入</li>
<li>檢查正確答案與使用者輸入是否符合</li>
<li>產生下一道題目</li>
</ol>
<h2 id="規則流程-時間："><a class="header-anchor" href="#規則流程-時間："></a>規則流程－時間：</h2>
<ol>
<li>挑戰者按下開始後，切換頁面並開始倒數</li>
<li>倒數60秒</li>
<li>檢查現在秒數，根據不同秒數決定不同難度的題目及得分</li>
<li>60秒倒數完畢後，切換顯示頁面，不讓挑戰者繼續輸入</li>
<li>挑戰者查看得分，等待按下「再次挑戰」後重新此流程</li>
</ol>
<h2 id="需特別注意的規則細節："><a class="header-anchor" href="#需特別注意的規則細節："></a>需特別注意的規則細節：</h2>
<p>因為數字是隨機產生，因此在某些情況下要注意，否則會有負數產生：</p>
<ol>
<li>減法時，會有前後數字大小的問題</li>
<li>除法時，會有數字大小以及除不盡的問題</li>
<li>最後挑戰者重新開始時記得clearInterval</li>
</ol>
<h2 id="專案實作-基本配置"><a class="header-anchor" href="#專案實作-基本配置"></a>專案實作 - 基本配置</h2>
<p>這個專案我是使用vue-cli，因為規模並不是很大，也不能跳頁，因此不打算另外切出Component。</p>
<p>資料結構的部分，因為會有重置資料的需求，我把原本習慣寫在data()裡面的資料拉出來，放在獨立的function回傳，這樣我就可以輕易的拿到預設的資料。</p>
<pre><code class="language-js">// outside Vue instance
function initData(){
    return {
     pages:['start','game','result'],
     operatorList:['+','-','x','÷'],
    operator:'+',
    currentPage:'start',
    score: '000',
    time_remain:60,
    currentTime:'00:00',
    quizNumbers:[],    }
}

// inside Vue instance
export default {
  name: 'app',
  data(){
    return initData()
  }
}

</code></pre>
<p>已知狀態有三種，因此我直接根據不同狀態去顯示不同頁面，這邊寫法可以依照自己習慣去更改：</p>
<pre><code class="language-js"> &lt;div :class=&quot;pages[0]&quot; v-if=&quot;currentPage==pages[0]&quot;  &gt;
 ...
 &lt;/div&gt;
 
  &lt;div :class=&quot;pages[1]&quot; v-if=&quot;currentPage==pages[1]&quot; &gt;
  ...
  &lt;/div&gt;

  &lt;div :class=&quot;pages[2]&quot; v-if=&quot;currentPage==pages[2]&quot; &gt;
    ...
  &lt;/div&gt;
</code></pre>
<h2 id="專案實作-邏輯實現"><a class="header-anchor" href="#專案實作-邏輯實現"></a>專案實作 - 邏輯實現</h2>
<h3 id="倒數方法-使用settimeinterval"><a class="header-anchor" href="#倒數方法-使用settimeinterval"></a>倒數方法 - 使用setTimeInterval</h3>
<p>要能夠時線倒數，代表必須每隔一秒改變畫面上的時間值，這裡用setTimeInterval最適合不過了，他會每隔一段時間去執行寫入的方法：</p>
<pre><code>methods:{
    ...
     timeReducer(){
         let timer =  setInterval(()=&gt;{
          if( this.time_remain&gt;0){
            this.currentTime = this.convertSeconds(this.time_remain -=1 )
          }else{
            clearInterval(timer)
            this.currentPage= this.pages[2]
          }
        }, 1000)
        return timer
    },
    ...
}
</code></pre>
<p>但在使用完後記得要清除這個interval，因為他會一直執行，如果沒有清除，在挑戰者再次開始遊戲時，如果沒有清楚，就會有兩個interval重疊，遊戲就無法順利進行，這邊我是在倒數完之後在setTimeInterval裡面直接使用clearInterval清除。</p>
<h3 id="隨機產生運算子"><a class="header-anchor" href="#隨機產生運算子"></a>隨機產生運算子</h3>
<p>因為加減乘除運算子必須隨機產生，所以我將這四種運算方式寫在陣列裡面(operatorList)，然後用JS的random方法去隨機挑選這個陣列的元素：</p>
<pre><code class="language-js">
methods:{
    ...
    randomOperator(){
      let order = Math.floor(Math.random()*100) % 4 
      this.operator = this.operatorList[order]
    }
    ...
}

</code></pre>
<h3 id="取得不同位數的數字"><a class="header-anchor" href="#取得不同位數的數字"></a>取得不同位數的數字</h3>
<p>依照上面整理的規則，我們第一個會需要處理的部份是隨機產生數字，JS裡面可以用Math.random() 去解決，但要注意這個方法回傳的值是介於0~1之間的浮點數，後面要自己去調整才能拿到自己想要的格式。</p>
<p>以及要考量到可能會有需要拿不同位數數字的需求，所以在這個method我用digits當作參數來表示欲取得的位數：</p>
<pre><code class="language-js"> // inside Vue instance 
 ...methods:{
     ...
     getDigits(digits){
      switch(digits){
        case 1 : return Math.floor((Math.random() * 10) + 1) ; 
        case 2 : return Math.floor((Math.random() * 100) + 10) ; 
        case 3 : return Math.floor((Math.random() * 100) + 100) ; 
      }
    },
 } 
</code></pre>
<h3 id="取得數字之後的處理"><a class="header-anchor" href="#取得數字之後的處理"></a>取得數字之後的處理</h3>
<p>加上setQuizNumber方法，根據不同時間取得不同位數的數字：</p>
<pre><code class="language-js">    //setQuizNumber
    let digit;
      switch (true){
        case (this.time_remain&gt;=40 &amp;&amp; this.time_remain&lt;=60): {
              digit = 1
              break; 
            }
        case (this.time_remain&gt;=20 &amp;&amp; this.time_remain&lt;=40): {
              digit = 2
              break;
            }
        case (this.time_remain&gt;=0 &amp;&amp; this.time_remain&lt;=20): {
              digit = 3
            break;
        }    
      }
      
      let result = []
      let firstNum=this.getDigits(digit); 
      let secondNum=this.getDigits(digit); 
</code></pre>
<p>我們不想要答案有負數或小數點產生，所以在減法時，必須注意第一個數字是否大於第二個，至於加法跟乘法就沒有這個問題，所以我加上判斷，如果第一個數大於第二個，就做swap交換：</p>
<pre><code class="language-js">    //setQuizNumber
      if(firstNum &lt; secondNum){
        let temp = firstNum
        firstNum = secondNum 
        secondNum = temp 
      }
</code></pre>
<p>最後為了在除法時，讓兩數是可以整除的，所以必須確保第二個數字是第一個數字的因數，以及不能有質數出現，我加入的判斷質數的方法isPrime跟取得數字所有因數的方法getFactors，以及後面會有從因數裡面雖機挑選一個數字的需求，所已加入陣列隨機挑選元素的方法getArrayRandomItem：</p>
<pre><code class="language-js">methods:{
    ...
    isPrime(num) {
      for(var i = 2; i &lt; num; i++)
        if(num % i === 0) return false;
      return num &gt; 1;
    },
    getFactors(number,digits){
      let factors =  Array
        .from(Array(number + 1), (_, i) =&gt; i)
        .filter(i =&gt; number % i === 0)

      if(digits){
        factors = factors.filter(factor=&gt;(factor+'').length===digits)
      }
        return factors
    },
    getArrayRandomItem(array){
      return  array[Math.floor(Math.random()*array.length)];
    },
    ... 
}
</code></pre>
<p>最後過濾掉質數後，從第一個數字的因數（陣列）裡面去隨機選出一個數當作第二個數字，就可以送出了：</p>
<pre><code class="language-js"> //setQuizNumber
 if(this.operator=='÷' &amp;&amp; ( firstNum % secondNum!==0)){
        while(this.isPrime(firstNum)) firstNum = this.getDigits(digit); 
        while(this.isPrime(secondNum)) secondNum = this.getDigits(digit); 
        
        secondNum = this.getArrayRandomItem(this.getFactors(firstNum,digit))
        
      } 
      result = result.concat([firstNum,secondNum]) 
      
      this.quizNumbers = result
</code></pre>
<p>做到這裡產生題目的邏輯就完成了。</p>
<h3 id="再次挑戰-重置所有資料"><a class="header-anchor" href="#再次挑戰-重置所有資料"></a>再次挑戰－ 重置所有資料</h3>
<p>還記得我一開始把原始狀態拉出來單獨放在function裡嗎？現在就可以拿來用了，使用Object.assign，可以直接對目標物件赴值，如果屬性重複，以參數越後面屬性的值為主（後面寫入的會蓋掉前面的），可以參考 <a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">官方文件</a>，順帶一提Object.assign不支援深度拷貝，如果你要複製的物件裡面還要物件，要特別注意，他只會複製那個物件的參考，後面你只要改動到該子物件，則所有該物件的參考都會跟著一起被改變。（<a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Deep_Clone">參考官方文件</a>）</p>
<pre><code class="language-js">methods:{
    ...
    onResetClick(){
      Object.assign(this.$data, initData());
      this.currentPage = this.pages[0]
    },
    ... 
}
</code></pre>
<p>this.$data是Vue裡面提供取得data物件的api，詳細可參考<a href="https://vuejs.org/v2/guide/instance.html#Data-and-Methods">官方文件</a>。<br>
到這邊所有核心的邏輯都講完了，再提一次我並沒有從頭到尾講得很詳細，希望你試著自己去理清楚來龍去脈，自己識做看看，若還是看不懂也沒關係，可以參考<a href="https://github.com/moojing/hex-underground/blob/master/6f_counter_game/src/App.vue">我的原始碼</a>，在自己做做看，有任何問題可以一起討論，感謝你的收看，下次見啦。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-13T02:49:13.000Z">2019-02-13</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 分鐘 閱讀文 (大約 2506 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/13/cors-node-vue/">Vue.js + Node.js + OpenAPI 帶你一次了解 CORS 跨域請求</a>
            
        </h1>
        <div class="content">
            <p>本篇文章是我在六角學院地下城活動5F關卡的實作紀錄，會描述如何架設簡單的Proxy Server去跟政府的公開API拉取資料回來給前端Vue.js介面做互動。</p>
<p>成果可參考<a href="http://underground-air.surge.sh/">這裏</a>(heroku開機要一段時間如果拉不到資料請多重整幾次。)</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*KzpZJQEQnjkUWyunAOhF_Q.png" alt=""></p>
<h2 id="使用技術及觀念："><a class="header-anchor" href="#使用技術及觀念："></a>使用技術及觀念：</h2>
<ul>
<li>Vue.js （with vue-cli3)</li>
<li>Node.js (express with express-generator)</li>
<li>Heroku</li>
<li>CORS Headers</li>
<li>Jsonp (僅技術講解)</li>
</ul>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>同源政策</li>
<li>Node.js — express generator</li>
<li>HTTP 的 CORS Request</li>
<li>修改 Response Header 允許跨域</li>
<li>部署到Heroku</li>
<li>Vue-Cli dev 模式下的proxy</li>
<li>什麼是Jsonp</li>
<li>寫在最後</li>
</ul>
<h2 id="同源政策"><a class="header-anchor" href="#同源政策"></a>同源政策</h2>
<p>一般開發網站的時候，如果是採前後端分離的架構，就會遇到跨域問題。就像今天這個專案，我的目標是抓取台灣空氣品質的開放API，回來做成介面給使用者搜尋，但是在利用axios直接打API的時候，遇到了下面的狀況：</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*Cz2_mdRYD01VTjFs.png" alt=""><br>
這是因為網頁在傳遞資料的時候，不管是透過傳統XMLHttpRequest（常見的ajax方式） 或是Fetch，都會遵循同源政策(Same Origin Policy)，「同源」指的是同個域名底下的資源，因為只能存取相同來源的資料，所以那些跨域的請求就會被阻擋掉。</p>
<p>這是瀏覽器的安全機制，當然並非如此一來就無法跨域存取了，我想到的解決有以下兩種：</p>
<ul>
<li>Jsonp (Json with padding)</li>
<li>使用Proxy 代理伺服器存取該目標API</li>
</ul>
<p>因為jsonp的相關知識文章應該有不少，且有安全性疑慮（最後面會說明）。本篇會以Node實做Proxy為主來講解。</p>
<h2 id="node-js-express-generator"><a class="header-anchor" href="#node-js-express-generator"></a>Node.js — express generator</h2>
<p>跟前端有vue-cli 、 react-create-app 等方便又快速的手腳架一樣，許多後端框架也有類似的功能，express-generator就是其中一個。安裝方式非常簡單，如果對接下來流程有任何疑問，可以參考官方文件，有很詳細的使用說明。</p>
<p>在terminal輸入以下指令以安裝</p>
<pre><code>npm install express-generator -g
</code></pre>
<ol start="2">
<li>輸入 express [你的專案名稱] 就可以產生出以express為基底的專案架構：</li>
</ol>
<pre><code>express  proxy-server
</code></pre>
<p>接下來就可以進入專案去新增我們要的api了。</p>
<h2 id="http-的-cors-request"><a class="header-anchor" href="#http-的-cors-request"></a>HTTP 的 CORS Request</h2>
<p>就像前面說的，CORS Request並非完全不可行，只是在Server端必須要有一些設定。既然我們不可能修改OpenAPI的Server內容，又因為後端資料交互是不會碰到瀏覽器的（因此就不會因為跨域問題被阻擋），我們就自己架一個Proxy Server來修改Http相關的設定，讓前端可以順利拿到資料。</p>
<h3 id="cors-request-response流程"><a class="header-anchor" href="#cors-request-response流程"></a>CORS Request / Response流程</h3>
<p>你在 <a href="http://example.com.tw">example.com.tw</a> 送出request給某網站的時候，在request body裡面會夾帶一個Origin的header，內容是你網站的Domain名稱：</p>
<pre><code>Origin: http://www.foo.com
</code></pre>
<p>而在後端伺服器收到request並且回傳resonse到client的時候，瀏覽器會去看response裡面的header–***「Access-Control-Allow-Origin」***是不是包含剛剛發出request寫的Origin 域名，如果有，資料才會允許被回傳。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*mFny2JjLLy4Xt3dn.png" alt=""></p>
<h2 id="修改-response-header-允許跨域"><a class="header-anchor" href="#修改-response-header-允許跨域"></a>修改 Response Header 允許跨域</h2>
<p>先到剛剛創造的express專案底下。</p>
<p>先找到我們的Open API URL，等等會用到:</p>
<pre><code>http://opendata.epa.gov.tw/webapi/api/rest/datastore/355000000I-000259
</code></pre>
<p>###安裝所需套件<br>
因為我們要利用後端去跟遠端Open API互動，所以這邊我們使用node-rest-client來達成這部分功能，node-rest-client官方文件：</p>
<pre><code>npm install node-rest-client
</code></pre>
<h2 id="新增api路由"><a class="header-anchor" href="#新增api路由"></a>新增API路由</h2>
<p>在剛剛創造的express專案底下的主程式routes資料夾新增 air.js :</p>
<pre><code>air.js

var express = require('express');
var router = express.Router();
var Client = require('node-rest-client').Client;
var client = new Client();
/* GET users listing. */
router.get('/', function(req, res, next) {
    let queries=req.query
    console.log('query: ', queries);
    let url='http://opendata.epa.gov.tw/webapi/api/rest/datastore/355000000I-000259'
    var options = {
        host: url,
        method: 'GET'
      };
    
    client.get(url, function (data, response) { 
        res.json({...data})
    });
});
module.exports = router;
</code></pre>
<p>router.get() 是express的router基本寫法，最後將這個包含自定義route的Router實體export出去，之後必須在主程式app.js引入才會有效，可以參考官方文件，可以看到在rest-client抓完資料的callback，我用json方式回傳了Open API 回傳的結果。</p>
<pre><code>  ...
  client.get(url, function (data, response) { 
      res.json({...data})
  });
  ...
</code></pre>
<p>主程式app.js路由引入<br>
接下來在app.js裡面將剛剛新增的router引入：</p>
<pre><code>var airRouter = require('./routes/air');
app.use('/air', airRouter);
</code></pre>
<p>記得在var app=express()之後才做app.use()這件事，否則會讀不到app這個變數。</p>
<h3 id="關鍵步驟：-response-header-設定"><a class="header-anchor" href="#關鍵步驟：-response-header-設定"></a>關鍵步驟： Response header 設定</h3>
<p>將設定用middle的方式寫入，Express內，如果你直接在app.use()裡面傳入一個</p>
<pre><code>function(req, res, next) {
     next()d
 }
</code></pre>
<p>那是middleware的意思，即所有request都會經過你傳入的function，且直到呼叫next()之後才會繼續執行，我們在這裡面設定Response 的Header，如此一來所有的Request都會得到相同的Header設定值（也可以在單獨某隻router寫入設定，可視需求改變）。</p>
<pre><code>let allowCrossDomain = function(req, res, next) {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');
  next();
}
app.use(allowCrossDomain)
</code></pre>
<p>我在Response Header裡面加入了</p>
<ul>
<li>&quot;Access-Control-Allow-Methods&quot;代表允許讓設定的Http Method通過。</li>
<li>“Access-Control-Allow-Origin”，其值為’*’。</li>
</ul>
<p>注意，剛剛說Response<strong><em>回傳到Client之前瀏覽器會先檢查這個Header有沒有跟來源Origin的值ㄧ樣</em></strong>，<a href="http://xn--sercerxxx-u75nga779d6ngga17hn75f8ywyj1aqkd9ud023jha711xtw3bpa9973gyte0x4c.com.tw">如果是一般前後端分離的sercer這部分的值一般會xxx.com.tw</a>，不會公開。如果你這樣寫，代表大家都可以對你的Server做跨域請求，這邊因為是open API 且是示範性質所以才這樣做。</p>
<p>到這邊其實已經完成了，如果順利的話你的Server應該已經可以拿到遠端API的資料，你可以用</p>
<pre><code>npm run start  
// then go to  http://localhost:3000/air
</code></pre>
<p>在本地架起來用瀏覽器或Postman去測試看看。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/0*kGPyb1rX_NtKFzrt.png" alt=""></p>
<h2 id="部署到heroku"><a class="header-anchor" href="#部署到heroku"></a>部署到Heroku</h2>
<p>想要在Heroku 架起一台node Server非常簡單，流程大致上是註冊帳號-&gt;安裝heroku cli-&gt; 登入-&gt; 到你的專案輸入幾個指令-&gt; 最後 git push heroku master，他自己就會幫你在heroku提供的空間下npm install安裝好需要的套件並且架起來。</p>
<p>這邊就不多做說明，可參考官方教學，相信我，不會花掉你太多時間的，可先用官方提供的專案做練習。需注意的是因為是免費的服務，所以只要半小時沒在使用，他會暫時關閉你的機器，所以有時候連線會比較慢，可不要以為壞掉了。</p>
<p>可參考我的實作成果。</p>
<h2 id="vue-cli-dev-模式下的proxy"><a class="header-anchor" href="#vue-cli-dev-模式下的proxy"></a>Vue-Cli dev 模式下的proxy</h2>
<p>Vue-cli因為是基於webpack，其實有proxy的設定，你可以參考官方文件。但因為這樣只解決開發環境的問題，所以後來我才打算自己架設Proxy。</p>
<p>另外，前端的部分因為比較基礎，就沒有太詳細解說，你可以看看我的Repo，如果還是有不懂的地方，隨時可以聯絡我。</p>
<h2 id="什麼是jsonp"><a class="header-anchor" href="#什麼是jsonp"></a>什麼是JSONP</h2>
<p>因為傳統 Ajax無法跨域，早期工程師們找到了替代解決方案—&lt; script&gt; tag 的src引用是可以跨域的，於是利用這個原理的jsonp就這麼誕生了（想想你在引入一些js函式庫如lodash的時候是不是可以用cdn方式直接引入執行？)</p>
<h3 id="jsonp會做什麼事情"><a class="header-anchor" href="#jsonp會做什麼事情"></a>Jsonp會做什麼事情</h3>
<ol>
<li>創造一個 &lt; script &gt; tag</li>
<li>根據你指定的Jsonp位置，設定這個tag的src</li>
<li>把這個&lt; script &gt; 加到瀏覽器DOM的head</li>
<li>一但資料載入完畢，會將回傳的資料傳給設定的callback並執行這些內容</li>
</ol>
<h3 id="jsonp的安全隱患"><a class="header-anchor" href="#jsonp的安全隱患"></a>Jsonp的安全隱患</h3>
<p>如果你使用JsonP，那你帶進來的這些內容，跟你自己寫的jsㄧ樣，可以去存取你的DOM等網頁內容，這種情況下如果無法保證server的安全性，將會是潛在的問題。</p>
<h2 id="寫在最後"><a class="header-anchor" href="#寫在最後"></a>寫在最後</h2>
<p>前端介面成果：<a href="http://underground-air.surge.sh/">http://underground-air.surge.sh/</a><br>
Proxy Server成果： <a href="https://mu-air-proxy.herokuapp.com/air">https://mu-air-proxy.herokuapp.com/air</a></p>
<p>到這邊，如果你可以很順的理解以上的內容，那你應該對CORS Request流程有一定的了解了。其實因為時間跟篇幅的關係，有些實作部分我並沒有講的很仔細，但是我都有提供相關文件在該段落的附近，因為我覺得寫程式常常需要的是閱讀文件的能力，希望各位可以學著找到自己所需的資源並補上。在「尋找資源-實作-找問題修Bug」的循環過程中其實也在訓練自己的理解跟整合能力，才會讓你慢慢進入學習的正向循環。</p>
<p>當然在這過程中有任何的不懂或是覺得有筆誤的話都可以隨時聯絡我，我很樂意跟你分享我所知道的知識。</p>
<h2 id="參考文章"><a class="header-anchor" href="#參考文章"></a>參考文章</h2>
<p><a href="https://stackoverflow.com/questions/32500073/request-header-field-access-control-allow-headers-is-not-allowed-by-itself-in-pr">STOF上關於CORS的討論</a></p>
<p><a href="https://fetch.spec.whatwg.org/#http-cors-protocol">CORS PROTOCAL</a></p>
<p><a href="https://schier.co/blog/2013/09/30/how-jsonp-works.html">how jsonp works?</a></p>
<p><a href="https://www.html5rocks.com/static/images/cors_server_flowchart.png">CORS流程圖</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-12T11:37:08.000Z">2019-02-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分鐘 閱讀文 (大約 1065 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/12/world-time/">JS世界時間表</a>
            
        </h1>
        <div class="content">
            <p>這篇講解的是我如何從頭開始研究Javascript時區轉換相關API，以及一些時區相關的奇怪專有詞，最後做出世界時間表，我會盡使用淺顯易懂的方式來說明，如果你看完還是對內容有疑問，可以直接聯絡我 ，一起交流。順帶一提，你沒看錯現在是早上4:30 (X_X)。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*iejluh4QdHbaGTzTVIch2w.png" alt=""></p>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ul>
<li>TimeStamp是什麼?</li>
<li>GTM+8 與 UTC+8 ? 差在哪?</li>
<li>toLocaleTimeString的使用</li>
<li>補充：DOM 操作 — cloneNode</li>
</ul>
<h2 id="timestamp是什麼"><a class="header-anchor" href="#timestamp是什麼"></a>TimeStamp是什麼?</h2>
<p>TimeStamp 可以想成是某個執行動作的時間點，經常我們在操作資料的時候（最常見新增/修改），會希望留下時間紀錄，以免出問題的時候可以追查。就像公家單位的公文在蓋章的時候都會有時間戳記，系統也是ㄧ樣，只不過有時候不是我們常見的日期格式。</p>
<p>要用js觀察TimeStamp，可以在瀏覽器下:</p>
<pre><code>Date.now(); //1549041946540
</code></pre>
<p>你應該可以得到奇怪的一串數字，類似這樣</p>
<pre><code>1549041946540
</code></pre>
<p>這個是什麼意思呢？是指從 1970/01/01開始至今的秒數，也就是TimeStamp。<br>
為什麼是1970年？據說那是工程師們自己訂的，Unix系統的誕生日期。一樣透過Date物件可以把這串秒數轉成一般的TimeString:</p>
<pre><code>new Date(Date.now()) // Sat Feb 02 2019 01:32:14 GMT+0800 (台北標準時間)
</code></pre>
<p>TimeString 也是String，只不過有一定的格式，才能給Date相關api讀取。<br>
有興趣的人可參考這篇 。</p>
<h2 id="gtm-8-與-utc-8-差在哪"><a class="header-anchor" href="#gtm-8-與-utc-8-差在哪"></a>GTM+8 與 UTC+8 ? 差在哪?</h2>
<p>其實這兩種格式在一般使用的情況下沒有差別，只是GTM是歷史沿革，UTC是後來科學家發現一種可以更準確測量時間的方式而訂出的格式，他們之間的時間差只在區區幾秒之間（但這足以讓某些科學家抓狂），總之，因為GTM這個格式已經被國際使用許久，所以就算UTC出現以後，還是沒有消失 (跟IEㄧ樣，號稱時代的眼淚，但你不消失我才會流淚)。</p>
<p>W3School的解釋：</p>
<blockquote>
<p>The UTC() method returns the number of milliseconds between a specified date and midnight of  January 1, 1970, according to universal time. Tip: The Universal Coordinated Time (UTC) is the time set by the World Time Standard. Note: UTC time is the same as GMT time.</p>
</blockquote>
<p>基本上把他看做ㄧ樣就行了（除非你真的無法無視閏秒XD）我自己一般還是習慣使用UTC格式。</p>
<pre><code>new Date(Date.now()).toUTCString() // 拿到目前UTC+0 的時間
</code></pre>
<h2 id="tolocaletimestring的使用"><a class="header-anchor" href="#tolocaletimestring的使用"></a>toLocaleTimeString的使用</h2>
<p>Js裡面時間相關api有很多，要算出不同時區的時間其實有不只一種方式，這裡用我覺得比較直觀的toLocaleTimeString()，第一個參數是語系，在後面的Option裡面可以設定很多格式，timeZone就是用來設定時區：</p>
<pre><code>let now = new Date(Date.now())
let month= now.toLocaleDateString(‘en-US’,{timeZone:’Your Time Zone’’,month:’long’})
</code></pre>
<p>TimeZone 的格式可以<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">參考這個列表</a>，我拿到時區後，直接綁在html上面，這樣在一開始渲染時，就可以直接拿到，非常直接。</p>
<pre><code> &lt;li class=”zone London bg-white” id=”London” time-zone=”Europe/London” &gt;…&lt;/li&gt;
</code></pre>
<p>option 兩個常用設定值</p>
<ol>
<li>在Option裡面除了設定timeZone，也可以設定時制</li>
</ol>
<pre><code>{…hour12:false} //24小時制
</code></pre>
<ol start="2">
<li>甚至可以直接拿到完整的月份名字，如此一來就不需要另外寫月份的mapping表:</li>
</ol>
<pre><code>let now = new Date(Date.now())
let month= now.toLocaleTimeString(‘en-US’,{timeZone,month:’long’})
 //”February, 3:44:46 PM”
</code></pre>
<h2 id="補充：dom-操作-clonenode"><a class="header-anchor" href="#補充：dom-操作-clonenode"></a>補充：DOM 操作 — cloneNode</h2>
<p>這邊比較特別的是，因為重複的版型我習慣利用類似template的方式去做，所以我在底下區塊把重複的結構拉出來：</p>
<pre><code> &lt;div id=”zone-template” style=”display:none”&gt;
 &lt;div class=”country”&gt;
 &lt;div class=”name”&gt;NEW YORK&lt;/div&gt;
 &lt;i class=”date”&gt;27 JAN,2019&lt;/i&gt;
 &lt;/div&gt;
 &lt;div class=”time”&gt;02:46 &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
<p>然後在畫面啟動的時候在去跑回圈一個一個掛到<code>&lt;li&gt;</code>裡面，記得使用cloneNode，確保這個版型能夠成功複製到每個區塊，如果單純用appendChild可能會有問題，詳情可以參考這篇。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-12T11:03:44.000Z">2019-02-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 分鐘 閱讀文 (大約 900 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/12/summernote-shrine/">Summernote 所見即所得編輯器達成圖片上傳</a>
            
        </h1>
        <div class="content">
            <p>當使用者在後台管理商品資料的時候，必須用到編輯器讓使用者輸入資料，當然也少不了常常跟編輯期搭配使用的圖片上傳，這邊選用Shrine跟Summernote來當作例子，講解前端如何發起上傳圖片的request將圖片上傳到後端。</p>
<p>解釋一下：<strong>Shrine</strong> 是Rails 裡面一套圖片上傳的套件，而<strong>Summernote</strong> 是一套歷久彌新而且非常好用的所見即所得編輯器，你應該會常常在各大開源專案看到他的影子。</p>
<p>今天重點會著重在前端圖片上傳到後端，並回傳圖片位址的流程，在後端功能的實作上不會有有太詳細的解說。</p>
<p>Summernote 文件：<a href="https://summernote.org/">https://summernote.org/</a><br>
Shrine 文件：<a href="https://github.com/shrinerb/shrine">https://github.com/shrinerb/shrine</a></p>
<h3 id="outline"><a class="header-anchor" href="#outline"></a>OUTLINE</h3>
<ol>
<li>HTML編輯器功能說明</li>
<li>圖片上傳流程解析</li>
<li>實際程式碼</li>
</ol>
<h3 id="html編輯器功能說明："><a class="header-anchor" href="#html編輯器功能說明："></a>HTML編輯器功能說明：</h3>
<p>HTML編輯器的介面其實長得很像Word，有各種按鈕讓你設定跟編輯文字的外觀。只不過你在Web使用編輯器的時候，實際上是在編輯他的<strong><em>Css Style</em></strong>，去改變文字大小、顏色等外觀。</p>
<p><img src="https://i.imgur.com/JDXcKoE.png" alt=""></p>
<p>Summernote 使用上非常容易，搭配jquery的selector就可以很快成功有一個編輯器介面可以用：</p>
<pre><code class="language-html">&lt;div id=&quot;summernote&quot;&gt;&lt;/div&gt;
</code></pre>
<pre><code class="language-js"> $('#summernote').summernote();
</code></pre>
<h3 id="圖片上傳流程解析："><a class="header-anchor" href="#圖片上傳流程解析："></a>圖片上傳流程解析：</h3>
<p>要能夠在編輯器裡面上傳並插入圖片，大致上有兩個關鍵步驟：</p>
<ol>
<li>使用者選擇要上傳的圖片</li>
<li>上傳完畢，拿回圖片網址，並將圖片插入目前游標位置</li>
</ol>
<p>我們可以看到在上述編輯器裡面有個圖片上傳按鈕，以Web以及Javascript的角度來思考的話，<strong>點擊該按鈕應該會有一個callback</strong>，就算沒有我們也可以自己實作一個，不過既然Summernote預設就有這個按鈕，我猜想應該會有一個點擊上傳圖片後的hook，可以自己寫callback來決定使用者選擇圖片後，要做什麼動作。</p>
<p>果不其然在官方文件被我找到這個 onImageUpload 的hook：</p>
<p><img src="https://i.imgur.com/eYl0rcl.png" alt=""></p>
<p>在callback參數裡面可以拿到使用者選擇的檔案，只要在這個callback裡面利用ajax進行圖檔上傳的動作，就可以順利上傳了，甚至在文件裡還有提供插入圖片到游標位置的方法：</p>
<pre><code class="language-js">    // upload image to server and create imgNode...
      $summernote.summernote('insertNode', imgNode);
</code></pre>
<p>既然有了方法，就可以整理一下圖片上傳的流程：</p>
<div id="flowchart-0" class="flow-chart"></div>
<h3 id="實際程式碼："><a class="header-anchor" href="#實際程式碼："></a>實際程式碼：</h3>
<p>jquery ajax圖片上傳：</p>
<pre><code class="language-js">function imageUpload(files){
    let formData = new FormData();
    formData.append('upload', files[0]);
      return $.ajax({
              type: &quot;POST&quot;, 
              url: '/upload',
              data:formData,
              beforeSend: function(xhr) {
                xhr.setRequestHeader('X-CSRF-Token', $('meta[name=&quot;csrf-token&quot;]')
                .attr('content'))},
              cache       : false,
              contentType : false,
              processData : false,
        
            });
  }
</code></pre>
<p>我把ajax內容拆了出來，把資料用參數的方式傳遞，以免每次上傳都要重寫一次：<br>
callback 內容</p>
<pre><code class="language-js">    $('#summernote').summernote(
    { height: 300,
      callbacks: {
        onImageUpload: function(files) {
          imageUpload(files).done((data, textStatus, jqXHR)=&gt;{
              let url = &quot;/uploads/&quot;+data.imageUrl
              
              $('#summernote').summernote('insertImage', url, 'newimage');
            })
        },
      }
    });
</code></pre>
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">
st=>start:  Summernote選擇圖片
 
cb=>start: 圖片透過ajax上傳 
saveImg=>start: 圖片儲存至Server(或cdn) 
saveInfo=>start: 儲存圖片相關資料至資料庫
getInfo=>start: 拿回圖片位址並回傳（從資料庫或cdn callback）
insertImg=>end: 將拿回圖片位址放入<img/>並插入編輯器游標位置



st->cb->saveImg->saveInfo->getInfo->insertImg</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script>
        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-12T08:15:14.000Z">2019-02-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分鐘 閱讀文 (大約 1362 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/12/cookie-base-cart/">製作 Base on Cookie 的購物車</a>
            
        </h1>
        <div class="content">
            <p>瀏覽器Cookie 為無狀態的Http協議帶來方便快速的解決方案，雖然太過依賴Cookie會產生潛在的風險，但用在一些不那麼需要注重安全的應用上還是非常適合，。</p>
<p>這篇文章會從認識cookie是什麼開始，到解說如何搭配cookie來製作商務網站常見的購物車。</p>
<pre><code>大綱：
- Cookie是什麼？ 
- Client 端設計流程
- 存取Cookie 
- 撰寫更友善的JS Cookie Setter/Getter
</code></pre>
<h2 id="cookie是什麼？"><a class="header-anchor" href="#cookie是什麼？"></a>Cookie是什麼？</h2>
<p>Cookie是瀏覽器的預設機制，提供4MB的空間去給網站暫存後續還會用到的資料，讓資料在其他頁面也能夠被取得，如果我們開啟開發者工具來看，就可以看到目前client所有的cookie：<br>
<img src="https://i.imgur.com/B6FfyI9.png" alt=""></p>
<p>Cookie預設在每次網站送出Request的時候，就會被跟著夾帶到Server，而Server回傳Response的時候，也會把Cookie一起帶下來到瀏覽器端，看一下瀏覽器發出Request時的Header就可以發現這件事情：（下圖是Facebooke發出請求時的內容）</p>
<p><img src="https://i.imgur.com/HwnV0Vn.png" alt=""></p>
<p>也可以從server端設定cookie，方法是在Response裡面夾帶名為 Set-Cookie的Header:</p>
<p><img src="https://i.imgur.com/Yg3Pa2z.png" alt=""></p>
<h2 id="client-端設計流程"><a class="header-anchor" href="#client-端設計流程"></a>Client 端設計流程</h2>
<p>可以想見購物車資料被修改的時機是在使用者將商品加入購物車的那一刻，這時候我們只要把商品數量跟id紀錄起來就可以了，因為使用者還有可能會購買其他商品，所以還不需要太詳細的商品資料：</p>
<div id="flowchart-0" class="flow-chart"></div>
<p>直到使用者進入購物車準備結帳時，就會需要跟後端調用商品確切價錢、確認有無優惠等動作：</p>
<div id="flowchart-1" class="flow-chart"></div>
<p>由於cookie是會隨著送出的request一起到後端Server，因此我在後端可以直接拿到設定的cookie內容，然後去資料庫找到我要的相關資料，包成物件後再回傳到客戶端。</p>
<p>而直到使用者離開購物車頁面進入結帳頁面的最後一刻，我才會把剛剛使用者儲存的購物車資料存到Session，給訂單頁面的controller處理，避免使用者在結帳時發生商品資料與購買金額不一致的情形。</p>
<h2 id="存取cookie"><a class="header-anchor" href="#存取cookie"></a>存取Cookie</h2>
<p><strong>cookie 文件：</strong> <a href="https://curl.haxx.se/rfc/cookie_spec.html">https://curl.haxx.se/rfc/cookie_spec.html</a></p>
<p>瀏覽器有提供api讓開發者使用js拿到cookie，直接使用document.cookie就可以拿到了:</p>
<h3 id="拿到cookie"><a class="header-anchor" href="#拿到cookie"></a>拿到Cookie</h3>
<pre><code class="language-js"> document.cookie 
</code></pre>
<h3 id="設定cookie"><a class="header-anchor" href="#設定cookie"></a>設定cookie</h3>
<p>設定cookie的方式並不是像操作js物件的Key/Value那麼直觀，而是要使用一定格式的字串&quot;name=xxx&quot; 但是後面會講到，可以利用js來包裝程簡潔好用function讓我們去設定它。</p>
<pre><code> document.cookie = &quot;name=thecontentIwanttosave; path=/; expires=Thu, 18 Feb 2019 12:00:00 GMT&quot;;
</code></pre>
<p>要注意設定cookie時一起設定的path值會影響你在該頁面可以存取的cookie。<br>
那麼path又是什麼？path是cookie的選項設定之一，跟domain可以搭配，domain是告訴瀏覽器這個cookie只能在這個被設定的域名下面使用，以防止別的網站可以拿到我的機密資訊。</p>
<p>**Cookie path syntax : **</p>
<blockquote>
<p>The path attribute is used to specify the subset of URLs in a domain for which the cookie is valid. If a cookie has already passed domain matching, then the pathname component of the URL is compared with the path attribute, and if there is a match, the cookie is considered valid and is sent along with the URL request. The path “/foo” would match “/foobar” and “/foo/bar.html”. The path “/” is the most general path.</p>
</blockquote>
<h2 id="撰寫更友善的js-cookie-setter-getter"><a class="header-anchor" href="#撰寫更友善的js-cookie-setter-getter"></a>撰寫更友善的JS Cookie Setter/Getter</h2>
<p>當我跟瀏覽器拿到cookie的時候，可能拿到的東西是這樣一整個字串：<br>
<img src="https://i.imgur.com/GoD3CkQ.png" alt=""><br>
瀏覽器沒有提供key value存取，所以我們只能操作字串，既然cookie是用分號去分隔，那用js的split就可以解決：</p>
<pre><code class="language-JS">    var value = &quot;; &quot; + document.cookie;
	var parts = value.split(&quot;; &quot; + name + &quot;=&quot;);
	parts.pop().split(&quot;;&quot;).shift(); 
</code></pre>
<p>但也不可能每次要拿個cookie都要操作字串，所以為了讓開發上能夠更順暢，我們可以把這段code包成function，減少重複的code。</p>
<p>這裡還有兩件事要注意：</p>
<ol>
<li>空白字元在每個瀏覽器跟cookie的版本的表現可能都不一樣，因此以防萬一我們會將它轉為其他字元代替。</li>
<li>為了避免編碼問題，我們統一將cookie轉為URI編碼。</li>
</ol>
<h3 id="getter"><a class="header-anchor" href="#getter"></a>Getter</h3>
<pre><code class="language-js">    function setCookie(name,value){
	value = encodeURIComponent(JSON.stringify(value).replaceAll(' ','+'))
        document.cookie=`${name}=${value}; path=/;`
        return getCookie(name)
}
</code></pre>
<h3 id="setter"><a class="header-anchor" href="#setter"></a>Setter</h3>
<pre><code class="language-js">    function getCookie(name) {
	var value = &quot;; &quot; + document.cookie;
	var parts = value.split(&quot;; &quot; + name + &quot;=&quot;);
	let res
	if (parts.length == 2){
		res= parts.pop().split(&quot;;&quot;).shift(); 
		return JSON.parse(decodeURIComponent(res).replaceAll('+',' '))
	}else{
		return undefined
	}
}
</code></pre>
<p>做到這裡，就剩下畫面呈現跟功能操作了，你應該已經可以很順暢的開始開發購物車，如果有任何其他問題，非常樂意你聯絡我跟我討論：</p>
<blockquote>
<p>Gmail : <a href="mailto:moojitsai@gmail.com">moojitsai@gmail.com</a><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">onproduct=>operation: 商品細節頁 
clickadd=>operation: 點擊加入購物車
setcookie=>operation: 將資訊更新至cookie

onproduct->clickadd->setcookie</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script><textarea id="flowchart-1-code" style="display: none">oncart=>operation: 使用者前往購物車頁面 
sendReqtoBackend=>operation: 送出Request至後端
setcookie=>operation: 後端根據夾帶的Cookie找出相對的商品資料並回傳

oncart->sendReqtoBackend->setcookie</textarea><textarea id="flowchart-1-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-1-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-1-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-1", options);</script></p>
</blockquote>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-12T08:15:14.000Z">2019-02-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Javascript/">Javascript</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分鐘 閱讀文 (大約 1941 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/12/regex-js/">初探Regex 正規表達式</a>
            
        </h1>
        <div class="content">
            <p><img src="https://images.unsplash.com/photo-1504639725590-34d0984388bd?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1934&amp;q=80" alt=""></p>
<p>正規表達式英文全名Regular Expression，<br>
想必一定曾是每個工程師的惡夢，在新手眼裡彷彿精靈語一樣神秘又難親近，<br>
Regex是一把複雜卻威力強大的武器。如果可以活用，在很多場合可以幫助你少寫很多的if判斷式，今天這篇文章就要來幫助理解正規表達式。</p>
<h2 id="為什麼需要-regular-expression"><a class="header-anchor" href="#為什麼需要-regular-expression"></a>為什麼需要 Regular Expression?</h2>
<p>Regex可以實用的情境大致有幾種：</p>
<ul>
<li>尋找匹配的字串</li>
<li>取代匹配的字串</li>
<li>驗證使用者輸入資料欄位</li>
<li>擷取某段想要的資訊</li>
</ul>
<p>舉例Js為例子來說，如果我想要看看資料裡面有沒有某個字元&quot;M&quot;，一個簡單的方式是這樣寫：</p>
<pre><code class="language-JS">    let stringMatch = &quot;This is Mujing.&quot;.some(s=&gt;{
        return s==&quot;M&quot;
    }) // Check if there is M in my data.
</code></pre>
<p>不過如果今天，當條件變得更多更複雜的時候這時候正規表達式就派上用場了。<br>
(字串裡面必須包含一個數字或一個大寫字母)：</p>
<pre><code class="language-js">    let re = &quot;&quot;
    let result = &quot;uSer0910&quot;.match(/([0-9]|[A-Z])/g) //result.length = 1 
</code></pre>
<h2 id="regular-expression-規則說明"><a class="header-anchor" href="#regular-expression-規則說明"></a>Regular Expression 規則說明</h2>
<p>正規表達式使用時是將規則寫在兩個正的斜線裡面，並且撰寫的時候有幾種類型的匹配方式：</p>
<ol>
<li>
<p>直接匹配： 例如直接輸入字元&quot;abc&quot;.match(/a/) 就可以匹配到a字元。</p>
</li>
<li>
<p>使用跳脫字元匹配：有些英文字在Regex裡面代表的特殊意義，但因為是用英文字元代表的，所以在使用時要用“\”跳脫字元來告知這不是一個直接匹配的字元。</p>
</li>
<li>
<p>特殊字元匹配：跟第二種相反，有一些特殊符號一但出現，就代表某種意義，如“[]“就代表任意匹配，如果要單純匹配 “[” 字元，則必須用反斜線告知。</p>
</li>
</ol>
<h2 id="js-的regular-expression寫法"><a class="header-anchor" href="#js-的regular-expression寫法"></a>JS 的Regular Expression寫法</h2>
<p>JS裡面寫正規表達式的時候你可以直接用兩個斜線代表，或是new一個RegExp物件並將要寫的規則寫入建構子，不要用這種做法要注意，RegExp預設會直接幫你跳脫特殊字元，如果你要在裡面寫跳脫字元規則的話，記得寫兩個反斜線來告訴他不要跳脫：</p>
<p>例如：</p>
<pre><code class="language-js">   new RegExp('\d') // return /d/ (變成匹配d這個字元了)
</code></pre>
<pre><code class="language-js">   new RegExp('\\d') // return /\d/ (是我要的數字匹配規則)
</code></pre>
<p>RegExp物件底下有一個test方法，用法如下：</p>
<pre><code class="language-js">    /a/.test('An Apple a day.') // return true 
</code></pre>
<p>就可以很快的測試自己寫的方法對不對了，這個方法用在表單檢查也非常好用。<br>
正規表達式還可以用在很多地方，如match、split、replace等操作字串的方法，<br>
學會之後想怎麼用就怎麼用。</p>
<p>以下整理正規表達式常用的特殊規則，或可參考<a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Regular_Expressions">JS官方文件</a></p>
<h2 id="跳脫字元規則"><a class="header-anchor" href="#跳脫字元規則"></a>跳脫字元規則</h2>
<p>這邊有個好記的規則，小寫的</p>
<table>
<thead>
<tr>
<th>符號</th>
<th>說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>\d</td>
<td>匹配任意數字</td>
</tr>
<tr>
<td>\D</td>
<td>匹配任意非數字字元</td>
</tr>
<tr>
<td>\w</td>
<td>匹配所有文字字元 (a-z、A-Z、0-9、_ )</td>
</tr>
<tr>
<td>\W</td>
<td>匹配所有“非”文字字元 (標點符號、特殊字元)</td>
</tr>
<tr>
<td>\s</td>
<td>匹配空白字元</td>
</tr>
<tr>
<td>\S</td>
<td>匹配“非”空白字元</td>
</tr>
<tr>
<td>\b</td>
<td>匹配字元邊界 /（空格或開頭/)</td>
</tr>
<tr>
<td>\B</td>
<td>匹配字元邊界</td>
</tr>
</tbody>
</table>
<h2 id="特殊符號"><a class="header-anchor" href="#特殊符號"></a>特殊符號</h2>
<table>
<thead>
<tr>
<th>符號</th>
<th>匹配說明</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>反斜線，跳脫特殊字元，例如想尋找&quot;/&quot;的時候</td>
</tr>
<tr>
<td>.</td>
<td>任意字元</td>
</tr>
<tr>
<td>$</td>
<td>字元結尾</td>
</tr>
<tr>
<td>^</td>
<td>字元開頭</td>
</tr>
<tr>
<td>[]</td>
<td>中括號，比對中括號裡面的任一字元，可以用範圍匹配：[A-Z]、[a-z]、[0-9]</td>
</tr>
<tr>
<td>[^]</td>
<td>^代表「反」，比對中括號裡面&quot;以外&quot;的任一字元</td>
</tr>
<tr>
<td>|</td>
<td>同程式常見的OR邏輯</td>
</tr>
<tr>
<td>()</td>
<td>群組</td>
</tr>
</tbody>
</table>
<h2 id="指定匹配次數"><a class="header-anchor" href="#指定匹配次數"></a>指定匹配次數</h2>
<p>因為一個字元只會匹配一次，如果要多次匹配，就可以用指定字數的規則。</p>
<p>需注意：<strong>這些次數針對的是的是該該符號擺放位置的前一個匹配規則。</strong></p>
<table>
<thead>
<tr>
<th>符號</th>
<th>匹配次數</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>0次或更多</td>
</tr>
<tr>
<td>+</td>
<td>1次或更多</td>
</tr>
<tr>
<td>?</td>
<td>0次或1次</td>
</tr>
<tr>
<td>{m}</td>
<td>m次</td>
</tr>
<tr>
<td>{n,}</td>
<td>最少n次</td>
</tr>
<tr>
<td>{m,n}</td>
<td>從m次到n次</td>
</tr>
<tr>
<td>{m,n}?</td>
<td>從m次到n次，選到匹配最少次的</td>
</tr>
</tbody>
</table>
<h2 id="基礎範例："><a class="header-anchor" href="#基礎範例："></a>基礎範例：</h2>
<p>其實懂了基本邏輯之後，剩下的就是組合而已，匹配的規則要用在查就可以了，因為比較常用的寫法都差不多。</p>
<h3 id="1-驗證手機號碼"><a class="header-anchor" href="#1-驗證手機號碼"></a>1.驗證手機號碼:</h3>
<p>手機號碼有10個數字，要怎麼寫呢？你可能第一個會想到[0-9]，方向對了，<br>
但[0-9]只會匹配一次，如果要匹配10次可以這麼寫:</p>
<pre><code class="language-js"> /[0-9]{10}/ 
</code></pre>
<h3 id="2-商品型號"><a class="header-anchor" href="#2-商品型號"></a>2.商品型號:</h3>
<p>一般電商在後台上架商品的時候，一個常見的需求是輸入商品型號，為了減少使用者錯誤率也為了提高效率，我們可以用正規表達式解決，假設今天商品型號的規則是：</p>
<p>三個英文字母 + “-” + 五個數字 （例如ABC-90006 )</p>
<p>那麼其實搭配上面講的匹配次數就可以：</p>
<pre><code class="language-js">    /[A-Z]{3}-[0-9]{5}/
</code></pre>
<h3 id="3-驗證密碼-至少包含一個大寫字母以及一個數字"><a class="header-anchor" href="#3-驗證密碼-至少包含一個大寫字母以及一個數字"></a>3.驗證密碼（至少包含一個大寫字母以及一個數字):</h3>
<p>這個情況想必跟[A-Z]以及[0-9]脫不了關係，但會遇到順序性的問題，直接給[A-Z][0-9]代表的是先一個大寫字母在加上一個數字，不能夠反過來，這時就會需要最少匹配一次的&quot;＋&quot;跟最寬容的&quot;＊&quot;。</p>
<p>拆解各種情況：</p>
<pre><code>[A-Z][0-9] :匹配一個A-Z的字母跟一個0-9的數字，而且不能顛倒
[A-Z]+ :代表匹配大寫字母最少一次
[A-Z]* :代表匹配A-Z0次或更多（這樣就代表可有可無，不是我們想要的）
[A-Z]+[0-9]+ :匹配[A-Z]最少一次之後在匹配0-9最少一次(如：AABB909)
</code></pre>
<p>看完上面四個範例你應該就會理解剛剛講的順序性是什麼，根據這個條件，可能會有的情況有幾種：</p>
<pre><code>1.  [任意字串] + [至少一個A-Z字元]+[至少一個數字]+[任意字串]
2.  [A-Z字元在開頭]+[任意字串]+[至少一個數字]
</code></pre>
<p>簡單來說就是要考慮我要匹配的字元是在開頭以及結尾，我們可以用<br>
“.*”來達成 [ 任意字符 ]的[ 匹配任意次（包含0次）]，以及<br>
&quot;+&quot; 達成最少一次的匹配：</p>
<pre><code>.*[A-Z]+ ：表示至少有一個A-Z字元，前面可以有其他「任意次」個「任意字元」。
</code></pre>
<p>組合！！</p>
<pre><code class="language-js">.*[A-Z]+.*[0-9]+.*
</code></pre>
<p>這樣就可以達到不管前面有什麼，最後有什麼，只要有一個A-Z跟一個數字，就符合規則啦！<br>
但最後還要考慮順序的問題，可以用 OR 邏輯將數字跟字母對調，就完美符合我們的需求啦！</p>
<pre><code class="language-js">.*[A-Z]+.*[0-9]+.* | .*[0-9]+.*[A-Z]+.*

</code></pre>
<h2 id="幾個練習regex的網站："><a class="header-anchor" href="#幾個練習regex的網站："></a>幾個練習Regex的網站：</h2>
<p>比較推薦第一個，他是互動式的，一步一步帶你了解正規表達式的使用方式，說明的很詳細。<br>
剩下兩個則是自己在測試的時候很好用，寫完表達式右邊還有規則的說明，非常方便。</p>
<ol>
<li><a href="https://regexone.com/problem/matching_decimal_numbers">RegexOne</a></li>
<li><a href="https://regex101.com/">Regex101</a></li>
<li><a href="https://regexr.com/">Regexr</a></li>
</ol>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    16 分鐘 閱讀文 (大約 2455 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-1/">前端工程師後端之旅(序) - 原來30天可以走這麼遠</a>
            
        </h1>
        <div class="content">
            <p>一個月可以做很多事：可以讀一本書、可以出國旅遊、可以養成一個你想要的好習慣，我用一個月從零開始學習後端知識並獨立打造出一個購物車網站。</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*vdMCFCB_zDQ8l70Z2c5hbA.jpeg" alt=""></p>
<p>我是一名熱愛技術的網站工程師，最近參加了 <a href="https://medium.com/@luka.tw/%E4%B8%8D%E7%AE%A1%E4%BD%A0%E6%98%AF%E5%89%8D%E7%AB%AF-%E5%BE%8C%E7%AB%AF-%E5%85%87%E7%8B%A0%E7%9A%84%E8%AE%8A%E5%BC%B7%E5%90%A7-%E9%A5%85%E9%A0%AD%E8%A8%88%E7%95%AB%E7%AC%AC%E9%9B%B6%E6%9C%9F-%E6%88%90%E6%9E%9C%E5%88%86%E4%BA%AB-81918be92ca4">Luka 的饅頭計畫</a>，我給自己三十天的時間，用<strong>拆分網站的方式理解商業邏輯，自己思考使用者流程</strong>以及資料關係，從網站的前台介面，反推頁面流程設計，反推資料庫設計，最後做出整個網站前台與後台。後台甚至可以實際地使用「所見及所得編輯器」新增與編輯商品資料。</p>
<h2 id="筆者實作前技術狀況"><a class="header-anchor" href="#筆者實作前技術狀況"></a>筆者實作前技術狀況</h2>
<p>進入Web領域一年，目前是Vue.js前端工程師，對前端HTML、CSS、JS較熟，後端邏輯、MVC架構以及資料庫則是只有基本的了解。</p>
<h2 id="專案目標"><a class="header-anchor" href="#專案目標"></a>專案目標</h2>
<p>學習新的後端知識，完整重現目標網站功能，利用分析現有網站的方式，讓自己更容易理解，也增加實作跟規劃能力。</p>
<h2 id="網站成果"><a class="header-anchor" href="#網站成果"></a>網站成果</h2>
<p>你可以在<a href="http://mujingtsai.site/">這裡</a>看到我的實作成果，以下筆記是這三十天內實作過程紀錄：</p>
<ul>
<li><a href="/2019/02/11/front-backend-travel-1/">前端工程師後端之旅(1) - 原來30天可以走這麼遠</a></li>
<li><a href="/2019/02/11/front-backend-travel-2/">前端工程師後端之旅(2) - 從畫面看出User Story</a></li>
<li><a href="/2019/02/11/front-backend-travel-3/">前端工程師後端之旅(3) - 前路由設計以及Slug SEO優化</a></li>
<li><a href="/2019/02/11/front-backend-travel-4/">前端工程師後端之旅(4) - 前端體驗優化</a></li>
<li><a href="/2019/02/11/front-backend-travel-5/">前端工程師後端之旅(5) - 資料庫關係設計</a></li>
<li><a href="/2019/02/11/front-backend-travel-6/">前端工程師後端之旅(6) - 利用爬蟲取得網站原始商品資料</a></li>
<li><a href="/2019/02/11/front-backend-travel-7/">前端工程師後端之旅(7) - 爬上穹頂的最後一哩路：部署</a></li>
<li><a href="https://hackmd.io/mIFyy-CTSTC9nGeXtAiYeA">Javascript - 製作 Base on Cookie 的購物車</a></li>
<li><a href="https://hackmd.io/cmanIYZ1S3yGYJkHyS_nHA">Javascript - 初探Regex 正規表達式</a></li>
<li><a href="https://hackmd.io/VZjOXjsVSdiHnXQeIw-j_A">Javascript - Shrine + Summernote 所見即所得編輯器達成圖片上傳</a></li>
<li><a href="https://hackmd.io/dhenlWCCSXyjCmEwR_KoJw">Javascript -  JS What’s this? this的四種繫結</a></li>
</ul>
<h2 id="為什麼要進行這個練習"><a class="header-anchor" href="#為什麼要進行這個練習"></a>為什麼要進行這個練習</h2>
<p>身為前端工程師，我覺得有必要說明做件事的理由。先說結論：<strong>我仍然想要繼續我的前端之路</strong>。</p>
<p>但我希望身為一位網站工程師我能夠有<strong>規劃出符合需求網站的能力</strong>，而一個網站的核心基礎大多與後端脫不了關係。而且我認為<strong>網站概念本不分前後端</strong>，因為現今網站技術跟需要處理的細節越來越多，才讓前後端界線越來越明顯，但如果要能夠讓自己規劃以及實作的能力更得心應手，多少還是必須同時跨足兩個領域。</p>
<p>再加上我個人在學習上比較不喜歡一知半解，前端工程師常常以API跟後端互動，卻不會知道資料怎麼來的，怎麼放進去的，放在哪裡？對於這些疑問我無法置之不理，所以也算是今天做這個練習的主要動機之一。</p>
<hr>
<h2 id="觀念的轉變"><a class="header-anchor" href="#觀念的轉變"></a>觀念的轉變</h2>
<p>一眨眼一個月就過去了，在這段時間內我利用所學新知完成完整的網站作品。在這過程中我從一開始的不知所措到最後學會可以專注完成每個階段性目標。其實一開始也沒想到可以做到這個程度，不過我我也是藉由改變一些原本的觀念來達到這個成果，我可以跟各位分享我的一些反思跟我是怎樣調整心態來看待遇到的困難跟問題。</p>
<p>從這中間我學到幾個觀念來維持自己的成長：</p>
<ol>
<li>對任何資訊保持警覺</li>
<li>維持紀錄所學的習慣</li>
<li>慎選平時吸收的學習資源／環境</li>
<li>學會建立心態</li>
</ol>
<h3 id="對新資訊保持警覺"><a class="header-anchor" href="#對新資訊保持警覺"></a>對新資訊保持警覺</h3>
<p>記得這段時間我每天睡醒就是開電腦看新文章，但是我有一個習慣，就是容易對眼前的疑惑追根究底，進而太過鑽牛角尖。在這次練習經驗裡，這個習慣就造成我不少困擾。不過也多虧我的mentor（Luka)在這中間給了我不少提醒，適時的調整心態，最有效的一個建議就是：</p>
<blockquote>
<p>不管看了多少新的東西，記得專注解決眼前的問題</p>
</blockquote>
<p>在實作期間，花在研究新技術的時間，最好都是為了解決問題，否則容易太發散，到最後根本忘了自己一開始要做什麼，而<strong>你必須有能力判斷目前正在接收的資訊是否適合現階段的學習</strong>。相信不少人在學習路上也遇到過跟我類似的問題吧，基本上只要能夠抓住這個原則，就能避免走進迷失方向的惡性循環。</p>
<h3 id="維持紀錄所學的習慣"><a class="header-anchor" href="#維持紀錄所學的習慣"></a>維持紀錄所學的習慣</h3>
<p>這段日子裡我不斷重複一種學習-&gt;吸收－&gt;紀錄的循環。一開始看到新的東西，腦子未必能夠馬上吸收，但是可以對這個技術有一定的了解，而透過實作來學習最大的好處就是可以得到即時的回饋。最後透過寫下筆記整理思維，也可以更確立自己的了解程度。</p>
<blockquote>
<p>看文章學習- &gt; 導入實做 -&gt; 試著把學到的東西記錄下來寫成文章</p>
</blockquote>
<p>很多人一聽到要另外花時間寫筆記就覺得很麻煩，我的建議是，不管紀錄的詳不詳細，都盡量練習把理解到的東西寫下來，可以訓練對知識的熟悉度，更重要的也同時在訓練表達能力。</p>
<h3 id="慎選平時吸收的學習資源-環境"><a class="header-anchor" href="#慎選平時吸收的學習資源-環境"></a>慎選平時吸收的學習資源／環境</h3>
<p>我覺得工程師這個職業就像一把刀子，就算沒有使用時也要常打磨，讓自己隨時準備好。所以對每個工程師來說，平常如何吸收新知與選擇接觸的資源就非常重要。</p>
<p>一個資深的開發者大多已經掌握自我學習的方法，但對於初學者來說，他最常接觸的可能是書、可能是線上課程或文章，不過與其說慎選資源不如說：</p>
<blockquote>
<p>要非常慎選學習對象（導師）。</p>
</blockquote>
<p>不論是文章還是課程影片的挑選，最終會影響你的還是教授這些事情的人。教學者的觀念、所做的行為會深深影響你處理事情的方式，包括學習。但一開始並不是每個人都有如此透徹的判斷力，在你還不知道教學者的好壞以前，我建議你保持自己的獨立思考，任何事自己先思考過一遍。</p>
<p>大家在剛進入職場學習時一定會遇到比較資深的前輩，盡情跟他學習吧！但記得對任何接收的訊息保持警惕，不要照單全收。</p>
<h3 id="學會建立心態"><a class="header-anchor" href="#學會建立心態"></a>學會建立心態</h3>
<p>說到學習新知識這件事情，就讓我想到一句話：「身子要軟，骨子要硬」。<br>
有任何學習機會就儘管接受，但同時也要學會<strong>過濾那些看起來很充實但是對學習沒有幫助的事情</strong>，這裡講的不只有工作而已。同樣的時間，可以花在更有前瞻性的研究，也可以用在重複造輪子，時間是你的，一但你意識到自我價值，自然就會開始認真看待每件事情所花費的時間。</p>
<hr>
<h2 id="寫在最後"><a class="header-anchor" href="#寫在最後"></a>寫在最後</h2>
<p>這個階段的目標結束了，接下來我也會繼續像這樣前進，設立短期階段性目標的學習讓我很有成就感，也讓我更了解自己在這條路上走了多遠。</p>
<p>同時我剛好正在尋找下一份工作，如果有興趣的可以參考我的履歷。</p>
<p>我的下一個目標是前端框架React，jsx的寫法很引起我的興趣，我會直接用專案開始練習，如果有人也正好要學這個框架，可以追蹤或聯絡我，也許有機會可以一起學習。</p>
<p>謝謝你的閱讀，希望以後我能以分享的方式繼續影響更多人，如果我的文章有幫助到你，請你幫我拍個手，讓我有動力繼續分享這類文章！</p>
<p>有興趣往下看的人，讓我們繼續吧！可以先看看我是怎麼<a href="https://hackmd.io/h8GOsrcuTme4MibQfSnZuQ">從外觀了解網站的架構的。</a></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分鐘 閱讀文 (大約 1084 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-2/">前端工程師後端之旅(2) - 從畫面拆解，到整理User Story</a>
            
        </h1>
        <div class="content">
            <p>在這個章節，我會說明我如何理解整個網站，並將其拆成很多一小部分功能，並整理出User Story。若對網站實作成果有興趣可參考： <a href="http://mujingtsai.site/">http://mujingtsai.site/</a></p>
<p>文章大綱：</p>
<ol>
<li>
<p>什麼是User Story</p>
</li>
<li>
<p>用sketch整理網站的Flow</p>
</li>
<li>
<p>根據這些畫面列出 User Story</p>
</li>
</ol>
<h2 id="什麼是-user-story"><a class="header-anchor" href="#什麼是-user-story"></a>什麼是 User Story?</h2>
<p>我們的階段性目標是寫出一套好理解且容易閱讀的功能需求，這個情況就非常適合User Story，User Story 通常是一段簡短但明確的功能描述，大多是這種句型開頭的：</p>
<blockquote>
<p>（在XXX 頁面 ）身為一個 XXX 我可以做 XXX ，以達到XXX 目的。</p>
</blockquote>
<p>由於User Story 是以使用者角度為出發點，去描述網站需求，以及某個動作可以為使用者帶來的價值，除了可以避免商業上自我感覺良好的盲點，也非常利於工程部門跟其他非開發人員（如業務、PM、老闆、設計師）等角色的溝通，在這邊整理出來是為了讓自己在之後的階段可以隨時回來確認，確保功能跟需求的一致性。</p>
<h2 id="step1-用sketch整理網站的flow"><a class="header-anchor" href="#step1-用sketch整理網站的flow"></a>Step1. 用sketch整理網站的Flow</h2>
<p>網頁截圖進Sketch ，Sketch裡有link功能，<br>
可以記錄頁面點擊事件的先後順序，以此模擬網站的行為，<br>
此處用已經完成的網頁做練習，如果是在開發階段，則使用Wireframe即可（WireFlow）。</p>
<p>目標網站：<br>
<a href="https://www.leisurecosmetics.com/">https://www.leisurecosmetics.com/</a></p>
<p>我從首頁開始，試著去點擊每個按鈕，看會導向哪一個頁面，<br>
並拆解成一張一張截圖放進Sketch，做成User Flow</p>
<p>![](<a href="https://i.imgur.com/TnbcQWb.png">https://i.imgur.com/TnbcQWb.png</a> =400x250)</p>
<p>![](<a href="https://i.imgur.com/n1hwrHE.png">https://i.imgur.com/n1hwrHE.png</a> =400x250)</p>
<style>
.col-6{
width:48%; 
margin: 0 5px;
}
.dib{
display:inline-block;
}
</style>
<h2 id="step2-列出-user-story"><a class="header-anchor" href="#step2-列出-user-story"></a>Step2. 列出 User Story</h2>
<p>目標網站是標準的購物網站，先分出頁面在一個一個列出可能的情境利用User Story 來描述以下的功能：</p>
<ol>
<li>商品 &amp; 商品分類</li>
<li>文章 &amp; 文章分類</li>
<li>購物車</li>
<li>聯絡我們（留言）</li>
<li>後台商品（類別）管理</li>
<li>後台文章（類別）管理</li>
<li>後台圖片上傳 + HTML編輯器</li>
</ol>
<hr>
<h3 id="1-商品-商品類別-："><a class="header-anchor" href="#1-商品-商品類別-："></a>1. 商品 &amp; 商品類別 ：</h3>
<ul>
<li>使用者可以進到類別列表</li>
<li>使用者可以進入商品資訊頁並將商品加入購物車</li>
<li>使用者將商品加入購物車之後會有Flash Message回饋</li>
</ul>
<p>![](<a href="https://i.imgur.com/dnurv04.png">https://i.imgur.com/dnurv04.png</a> =400x250)</p>
<pre><code>![](https://i.imgur.com/YuAGv2c.png =400x250)
</code></pre>
<hr>
<h3 id="2-文章-文章類別"><a class="header-anchor" href="#2-文章-文章類別"></a>2. 文章 &amp; 文章類別 :</h3>
<ul>
<li>使用者可以瀏覽某類別的文章列表</li>
<li>使用者可以瀏覽文章詳細內容</li>
</ul>
<p>![](<a href="https://i.imgur.com/frtkAx6.png">https://i.imgur.com/frtkAx6.png</a> =400x250)</p>
<p>![](<a href="https://i.imgur.com/uTHcND1.png">https://i.imgur.com/uTHcND1.png</a> =400x250)</p>
<hr>
<h3 id="3-購物車"><a class="header-anchor" href="#3-購物車"></a>3. 購物車</h3>
<ul>
<li>使用者可以新增/刪減商品</li>
<li>使用者可以結帳</li>
</ul>
<blockquote></blockquote>
<p>![](<a href="https://i.imgur.com/u7zMk6X.png">https://i.imgur.com/u7zMk6X.png</a> =400x250)</p>
<p>![](<a href="https://i.imgur.com/H4DbNVW.png">https://i.imgur.com/H4DbNVW.png</a> =400x250)</p>
<h3 id="4-聯絡我們表單"><a class="header-anchor" href="#4-聯絡我們表單"></a>4. 聯絡我們表單</h3>
<ul>
<li>使用者可以留下資料跟訊息並送出</li>
</ul>
<p>![](<a href="https://i.imgur.com/u5EEz8P.png">https://i.imgur.com/u5EEz8P.png</a> =400x250)</p>
<p>![](<a href="https://i.imgur.com/HksOBzR.png">https://i.imgur.com/HksOBzR.png</a> =400x200)</p>
<h3 id="5-前台登入"><a class="header-anchor" href="#5-前台登入"></a>5. 前台登入</h3>
<ul>
<li>使用者可以登入前台</li>
<li>使用者可以登入後台</li>
</ul>
<h3 id="6-後台商品-類別-管理"><a class="header-anchor" href="#6-後台商品-類別-管理"></a>6. 後台商品（類別）管理</h3>
<ul>
<li>使用者可以新增商品</li>
<li>使用者可以刪除商品</li>
<li>使用者可以瀏覽商品細節</li>
<li>使用者可以瀏覽所有商品</li>
</ul>
<h3 id="7-文章及文章類別管理"><a class="header-anchor" href="#7-文章及文章類別管理"></a>7. 文章及文章類別管理</h3>
<ul>
<li>使用者可以新增文章</li>
<li>使用者可以刪除文章</li>
<li>使用者可以瀏覽文章內容</li>
<li>使用者可以瀏覽所有文章</li>
</ul>
<h2 id="8-後台圖片上傳-html編輯器"><a class="header-anchor" href="#8-後台圖片上傳-html編輯器"></a>8. 後台圖片上傳 + HTML編輯器</h2>
<ul>
<li>使用者可以在編輯器內上傳圖片</li>
</ul>
<p>檔案上傳是蠻常見的後台需求，但也是比較複雜的一項功能，要同時顧及到檔案類型限制、大小限制，以及如何讓上架流程更順暢，要讓使用者在編輯器內圖片上傳則需要javascript輔助。<br>
（技術細節<a href="https://hackmd.io/VZjOXjsVSdiHnXQeIw-j_A">請見這裏</a>)<br>
<img src="https://i.imgur.com/5HyQJv9.jpg" alt=""></p>
<p>在理解畫面，且整理好User Story之後，接下來我會說明如何進行下一步：</p>
<h3 id="根據這些畫面去設計出網站路由並且做seo優化處理"><a class="header-anchor" href="#根據這些畫面去設計出網站路由並且做seo優化處理"></a><a href="https://hackmd.io/pNRxW-lkRTqy4B3abgLOxA?both">根據這些畫面去設計出網站路由並且做SEO優化處理</a></h3>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 分鐘 閱讀文 (大約 963 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-3/">前端工程師後端之旅(3) - 路由設計以及Slug SEO優化</a>
            
        </h1>
        <div class="content">
            <p>路由的設計也是開發網站時的重點之一，不同的功能及頁面，甚至資料存取方式，都會收到Route規劃的影響。<br>
我們得先知道，網站總共有哪些頁面，才能整理出頁面和頁面之間的關係，進而設計出合適的路由，下面是根據畫面整理出來的網站架構，如果對於網站畫面拆解有興趣的，可以參考上一篇：</p>
<h3 id="從畫面拆解-到整理user-story"><a class="header-anchor" href="#從畫面拆解-到整理user-story"></a><a href="/2019/02/11/front-backend-travel-2">從畫面拆解，到整理User Story</a></h3>
<p>或可參考網站成果： <a href="http://mujingtsai.site/">http://mujingtsai.site/</a></p>
<h3 id="文章大綱："><a class="header-anchor" href="#文章大綱："></a>文章大綱：</h3>
<ol>
<li>網站 Sitemap</li>
<li>路由設計</li>
<li>Slug SEO 優化</li>
</ol>
<h2 id="網站-sitemap"><a class="header-anchor" href="#網站-sitemap"></a>網站 Sitemap</h2>
<p>根據該所有可到網站頁面可整理出如下面這樣的網站頁面圖，<br>
這對確認需求有蠻大程度的幫助，討論需求時也比較不會東漏西漏：</p>
<h3 id="前台sitemap"><a class="header-anchor" href="#前台sitemap"></a>前台Sitemap</h3>
<p><img src="https://i.imgur.com/y6r9iDi.png" alt=""></p>
<h3 id="後台sitemap"><a class="header-anchor" href="#後台sitemap"></a>後台Sitemap</h3>
<p><img src="https://i.imgur.com/s3g9dZT.png" alt=""></p>
<h2 id="路由設計："><a class="header-anchor" href="#路由設計："></a>路由設計：</h2>
<p>原本的Route方式比較雜亂，雖然設計上算是Restful，<br>
但route還要index.php還是不太美觀，甚至有可能影響SEO，<br>
因此我想要設計成直觀一點的路由。</p>
<h3 id="商品類別路由"><a class="header-anchor" href="#商品類別路由"></a>商品類別路由</h3>
<pre><code class="language-rb">/product/category/:category_id
</code></pre>
<h3 id="商品路由"><a class="header-anchor" href="#商品路由"></a>商品路由</h3>
<pre><code class="language-rb">/product/:product_id 
</code></pre>
<h3 id="新聞類別-新聞路由"><a class="header-anchor" href="#新聞類別-新聞路由"></a>新聞類別&amp;&amp;新聞路由</h3>
<p>仿照product，一樣的方式，把product改為news:</p>
<pre><code class="language-rb">/post/category/:category_id
</code></pre>
<pre><code class="language-rb">/post/:post_id 
</code></pre>
<h3 id="購物車路由"><a class="header-anchor" href="#購物車路由"></a>購物車路由</h3>
<p>原來的購物車路由跟結帳路由被放在同一個層級下，容易令人疑惑，因此如果能夠拆開比較好：</p>
<pre><code>/cart
</code></pre>
<h3 id="結帳頁面"><a class="header-anchor" href="#結帳頁面"></a>結帳頁面</h3>
<pre><code>/checkout
</code></pre>
<h3 id="登入頁面"><a class="header-anchor" href="#登入頁面"></a>登入頁面</h3>
<pre><code>  /user/login
</code></pre>
<h3 id="會員資料頁："><a class="header-anchor" href="#會員資料頁："></a>會員資料頁：</h3>
<pre><code>/user/edit
</code></pre>
<h2 id="slug-seo-優化："><a class="header-anchor" href="#slug-seo-優化："></a>Slug SEO 優化：</h2>
<p>Slug(別名) 是在URL裡面，藉由給每一個頁面一個不重複具有識別性的資料，達到以更語意化的方式存取資料，藉此提升SEO友善度。</p>
<p>很多時候在某個頁面有很多相同類型的資料要存取，比如商品列表內某一筆商品資料、某一筆文章資料…，我們會透過在路由內搭配變數，利用商品id去存取，例如：</p>
<pre><code>/products/:id 
</code></pre>
<p>而在使用上我們就可以透過「/products/12」去找到第12筆商品內容頁面。基本上只要能夠確保每個:id變數是獨一無二具有識別性的，就能透過這個路由一次性處理多筆資料。</p>
<p>但是這樣子的用法對SEO來說並不夠友善，要針對路由優化SEO，有一個大原則是讓URL<strong>簡短、清楚、語意化</strong>，其實在這個情況下，可以與路由搭配的識別性資料，也不一定只有id。</p>
<p>我們可以一筆一筆商品自己給定不重複的slug，<br>
但不難想到，以商品來說，通常<strong>商品名稱</strong>也是不會重複的識別性資料。<br>
所以我們可以直接用拿來搭配使用，而且這樣子一看就知道是對應到哪個頁面了。<br>
例如:</p>
<pre><code>products/categories/限時優惠
</code></pre>
<p>當然我們還是得做一些防止slug重複的方法，以免意外性的名稱重複導致網站無法運作，由於使用Slug通常是在資料庫商品資料表的欄位內多插入一個Slug欄位，所以必須指定資料欄位為unique，防止相同的資料被寫入第二次，以rails 來說就是在migration寫入類似：</p>
<pre><code class="language-rb">add_column  :posts , :slug , :string , :index =&gt; { :unique =&gt; true }
</code></pre>
<p>以指定唯一的索引，你可以透過</p>
<p><a href="http://mujingtsai.site/products/categories/%E6%96%B0%E5%93%81%E4%B8%8A%E6%9E%B6">http://mujingtsai.site/products/categories/新品上架</a></p>
<p>來看到我的實作成果。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 分鐘 閱讀文 (大約 568 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-4/">前端工程師後端之旅(4) - 前端體驗優化</a>
            
        </h1>
        <div class="content">
            <h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<p>這個專案著重於後端資料規劃，不過在前端部分我還是有幾個覺得可以優化的地方，分別是</p>
<ol>
<li>訊息提示</li>
<li>表單檢查</li>
<li>購物車實現方式。</li>
</ol>
<h2 id="訊息提示"><a class="header-anchor" href="#訊息提示"></a>訊息提示</h2>
<p>不管是成功或是失敗，訊息回饋我們不希望用跳頁的方式，以減少server的負擔，不過以MVC框架的話用server端解決對工程師來說是比較明確。我想也許這邊可以用重要性來分，如網站底下的聯絡我們表單，就很適合用ajax送出資料，然後給予使用者提示。</p>
<p>像是使用者註冊跟個人資料修改這種比較重要的資料，就可以用傳統跳頁的方式，使得回饋感比較重。</p>
<h3 id="頁尾聯絡表單"><a class="header-anchor" href="#頁尾聯絡表單"></a>頁尾聯絡表單</h3>
<p>不跳頁的即時回饋：<br>
<img src="https://i.imgur.com/dpR0m2M.png" alt=""></p>
<h3 id="結帳頁面coupon彈跳訊息"><a class="header-anchor" href="#結帳頁面coupon彈跳訊息"></a>結帳頁面Coupon彈跳訊息</h3>
<p>結帳頁面的coupon因為是用ajax去確認coupon合法性，所以訊息不採用跳頁的方式。</p>
<p><img src="https://i.imgur.com/y8vnINP.png" alt=""></p>
<h2 id="表單錯誤檢查"><a class="header-anchor" href="#表單錯誤檢查"></a>表單錯誤檢查</h2>
<p>表單檢查最好是前後端都做，但由前端處理可以減少server負擔，也確保資料送到server時的完整度，<br>
這邊示範前端表單檢查：</p>
<h3 id="結帳頁面"><a class="header-anchor" href="#結帳頁面"></a>結帳頁面</h3>
<p><img src="https://i.imgur.com/irzoVl3.png" alt=""></p>
<h3 id="頁尾聯絡表單-v2"><a class="header-anchor" href="#頁尾聯絡表單-v2"></a>頁尾聯絡表單</h3>
<p><img src="https://i.imgur.com/Yk5wVJt.png" alt=""></p>
<h2 id="購物車實現方式"><a class="header-anchor" href="#購物車實現方式"></a>購物車實現方式</h2>
<p>原本的購物車是做在Server Side， 所以每加入一次購物車，甚至在購物車頁面增加或減少商品數量都是一次Request，使用者每點擊一下都要等待將近一秒鐘的延遲，對使用者比較不友善。</p>
<p>所以我將體驗改為，直到使用者結帳之前，都是使用瀏覽器Cookie記錄使用者加入購物車的商品資料；而使用者進入結帳頁面之後，我才是使用session來傳遞購物車資訊，避免商品資料被竄改，產生使用者購買錯誤商品的悲劇。</p>
<p>你可以在<a href="https://hackmd.io/mIFyy-CTSTC9nGeXtAiYeA">這裡看到相關的技術細節</a>。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    4 分鐘 閱讀文 (大約 543 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-5/">前端工程師後端之旅(5) - 資料庫關係設計</a>
            
        </h1>
        <div class="content">
            <p>為了讓設計時更容易溝通，常常會使用ERD來整理，ERD用圖像化的方式來規劃資料與資料之間的關係，讓開發人員可以對系統架構一目瞭然，如一對多、多對一、多對多等等常見的關係。</p>
<h2 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h2>
<ol>
<li>ERD類別圖基本介紹</li>
<li>產品資料表</li>
<li>文章資料表</li>
<li>訂單及優惠券資料表</li>
<li>前後台使用者資料表</li>
</ol>
<h2 id="erd-基本介紹"><a class="header-anchor" href="#erd-基本介紹"></a>ERD 基本介紹</h2>
<p>ERD 意思是 實體-關聯圖，Entity是用物件導向的class表示一個生活中的實體，關聯則是指資料庫的關聯。因為Ruby本來就是物件導向語言，而Rails又是用ORM對應資料表，所以用ERD可以很清楚的表示資料關係，<br>
我們用一張表格表示一個Class，會長的像下面這樣：<br>
![](<a href="https://i.imgur.com/4XYvaIh.png">https://i.imgur.com/4XYvaIh.png</a> =230x200)</p>
<h3 id="修飾子"><a class="header-anchor" href="#修飾子"></a>修飾子</h3>
<p>表裡面裝的是在class裡面的property，前面使用符號來表示物件屬性的修飾子，分別是：</p>
<table>
<thead>
<tr>
<th>符號</th>
<th>屬性</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>public</td>
</tr>
<tr>
<td>-</td>
<td>private</td>
</tr>
<tr>
<td>#</td>
<td>protected</td>
</tr>
</tbody>
</table>
<h3 id="關係表示"><a class="header-anchor" href="#關係表示"></a>關係表示</h3>
<table>
<thead>
<tr>
<th>關係</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>一對多</td>
<td>1-------------1…* ( or * )</td>
</tr>
<tr>
<td>一對一</td>
<td>1-------------1</td>
</tr>
<tr>
<td>多對多</td>
<td>需要中介表</td>
</tr>
</tbody>
</table>
<h2 id="產品資料"><a class="header-anchor" href="#產品資料"></a>產品資料</h2>
<p>因為可能會有想讓商品同時出現在兩個或更多個類別清單的情況，所以這邊我採用多對多關聯設計，資料表要實現多對多的話，則要藉由中間一張轉介表來串連：<br>
<img src="https://i.imgur.com/noNMUE9.png" alt=""></p>
<h2 id="文章資料"><a class="header-anchor" href="#文章資料"></a>文章資料</h2>
<p>文章跟類別的就比較單純，一個類別可能有多個文章:<br>
<img src="https://i.imgur.com/XshJLM0.png" alt=""></p>
<h2 id="訂單資料"><a class="header-anchor" href="#訂單資料"></a>訂單資料</h2>
<p>由於使用者在結帳時有可能會使用優惠券，所以Coupon跟訂單、以及訂單其他資訊之間必須有一對一關聯：<br>
<img src="https://i.imgur.com/JVUMtP4.png" alt=""></p>
<h2 id="前台-後台-使用者"><a class="header-anchor" href="#前台-後台-使用者"></a>前台 / 後台 使用者</h2>
<p>為了安全性考量，前後台的會員資料表應該要分開，如果共用同一張資料表，後台管理員有機會看到其他管理人的機密資料：<br>
<img src="https://i.imgur.com/eshIC5H.png" alt=""></p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分鐘 閱讀文 (大約 1549 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-6/">前端工程師後端之旅(6) - 利用爬蟲取得網站原始商品資料</a>
            
        </h1>
        <div class="content">
            <p>為了盡可能重現目標網站，我們會需要原來的商品資料，但總不可能一筆一筆複製貼上，這時候我們就會需要爬蟲，爬蟲就是一隻去造訪網站並且分析網站回傳的資料，我們就可以只拿出我們需要部分的資料，透過爬蟲我們可以做很多數據統計的分析，比如：分析某某競爭對手電商的產品趨勢、分析PTT八卦版最常出現的用詞…等。</p>
<p>Python是最常見用於撰寫爬蟲的語言之一，但其實大多數語言都可以用來撰寫爬蟲，因為目前正在學習Rails，而且Ruby還能夠透過’active-record’使用ORM跟資料庫溝通，非常方便，所以今天我會用ruby來示範如何撰寫一隻爬蟲。</p>
<h2 id="outline-流程"><a class="header-anchor" href="#outline-流程"></a>Outline - 流程</h2>
<p>爬蟲從獲取資料到分析完資料之間可細分為幾個步驟：</p>
<ol>
<li>觀察url規律</li>
<li>模擬送出HTTP Request</li>
<li>取得網站Response</li>
<li>分析html內容結構</li>
<li>取出需要的部分並整理</li>
<li>與資料庫取得連線</li>
<li>整理後存入資料庫</li>
</ol>
<h2 id="使用工具"><a class="header-anchor" href="#使用工具"></a>使用工具</h2>
<p>要進行以上幾個動作，我們會需要幾個套件，分別是：</p>
<ul>
<li>nokogiri：可以讓我們使用與jquery選擇器一樣的方式去選出html內容</li>
<li>rest-client： 可以模擬並發出http請求</li>
<li>active-record ：讓我們可以使用ORM與資料庫溝通</li>
<li>pry ：讓我可以下中斷並且觀察資料</li>
</ul>
<h2 id="觀察url規律"><a class="header-anchor" href="#觀察url規律"></a>觀察Url規律</h2>
<p>既然是要拿到所有相同類型的資料，只要觀察不同筆資料間url的相異之處就可以了，如</p>
<pre><code>https://www.leisurecosmetics.com/index.php?route=product/product&amp;product_id=75
https://www.leisurecosmetics.com/index.php?route=product/product&amp;product_id=77 

</code></pre>
<p>可看出改網站用product_id來識別商品。</p>
<h2 id="模擬送出http-request並取回html網頁結構"><a class="header-anchor" href="#模擬送出http-request並取回html網頁結構"></a>模擬送出HTTP Request並取回html網頁結構</h2>
<p>寫過前端ajax的人，一定常用axios.get(‘<a href="http://example.com/api/xxx">http://example.com/api/xxx</a>’) 去送出get請求拿回資料，其實一般我們進入瀏覽器時，就是在對該網站的server送出Http的get請求，只不過跟ajax不同的是，拿回來的不是api資料，而是網站的畫面，這就是常聽到的<strong>Server Side Rendering</strong>，圖為進入youtube時所送出的Get請求。<br>
<img src="https://i.imgur.com/m1NxXMu.png" alt="螢幕快照 2019-01-23 上午10.42.09"></p>
<p>接下來利用rest-client去模擬http get請求到該目標網站：</p>
<pre><code class="language-ruby">html = RestClient.get('https://www.leisurecosmetics.com/index.php?route=product/product&amp;product_id=75')
</code></pre>
<p>binding.pry 下中斷並觀察取回的資料<br>
<img src="https://i.imgur.com/nOPTjYc.png" alt="螢幕快照 2019-01-23 上午10.54.54"><br>
我們已經把網頁的html拿到手了。</p>
<h2 id="分析html結構"><a class="header-anchor" href="#分析html結構"></a>分析Html結構</h2>
<p>透過RestClient取回資料後，接下來我們需要Nokigiri去讓我們可以很方便找到我們要的資料，他的使用方式其實就很跟jquery選擇元素的時候一樣，例如，想要選到商品title，我先觀察，商品title上面是否有唯一且具有識別性的元素？</p>
<pre><code>&lt;h2 class=&quot;text-primary&quot;&gt;BS03 輕透底光 - 面部化妝刷具套裝&lt;/h2&gt;
</code></pre>
<p>觀察到商品名是用h2包起來並且有 .text-primary 這個class， 我可以先用瀏覽器確認是不是用h2.text-primary可以只選到標題：<br>
<img src="https://i.imgur.com/5pwEp1Q.png" alt="螢幕快照 2019-01-23 上午11.09.25"></p>
<h3 id="取出需要的部分並整理"><a class="header-anchor" href="#取出需要的部分並整理"></a>取出需要的部分並整理</h3>
<p>太棒了！上面正好是我要的，之後我們只要用Nokogiri以同樣的方式選出該元素就行：</p>
<pre><code>html = RestClient.get('https://www.leisurecosmetics.com/index.php?route=product/product&amp;product_id=75')
doc = Nokogiri::HTML(html)
doc.css('h2.text-primary').text //===&gt; get product title
</code></pre>
<p><img src="https://i.imgur.com/FeV1k0x.png" alt="螢幕快照 2019-01-23 上午11.16.50"></p>
<p>用gsub方法把空白字元去掉，ruby的gsub就跟js的replace一樣都是用來代換字串：</p>
<pre><code>doc.css('h2.text-primary').first.text()
        .gsub(&quot;\n&quot;,&quot;&quot;)
        .gsub(&quot;\t&quot;,&quot;&quot;)
</code></pre>
<p><img src="https://i.imgur.com/SFUEk45.png" alt="螢幕快照 2019-01-23 上午11.22.05"><br>
拿到我要的資料。<br>
也可以用正規表達式來匹配資料：</p>
<pre><code class="language-rb">doc.css('.price h2').first().text.match(/(\w+)\$([\d,]+)/)[2] //get product price 
</code></pre>
<h3 id="與資料庫取得連線"><a class="header-anchor" href="#與資料庫取得連線"></a>與資料庫取得連線</h3>
<p>Ruby 的active record 其實不一定只能跟著Rails 搭配使用，反過來說，Rails也不一定要使用這套ORM（也有其他的）。這裡我們就把active record單獨拿出來使用，作為與資料庫溝通的橋樑。因為我們上面已經有require了，這邊只要直接使用他的class就可以：</p>
<pre><code>ActiveRecord::Base.establish_connection({
    adapter: 'mysql2',
    encoding: 'utf8',
    database: 'leisure_development',
    username: 'your_db_username',
    password: 'your_db_password',
  })
</code></pre>
<p>記得資料庫的資訊要設好，否則會連不上。</p>
<h3 id="存入資料庫"><a class="header-anchor" href="#存入資料庫"></a>存入資料庫</h3>
<p>這邊用的資料庫要是跟Rails專案同樣的資料庫，才能夠直接讓專案使用。<br>
最後就是依照資料表格式整理成Hash然後把需要的資料包成Hash，我把整段程式碼包成method，這個method 直接回傳商品資料：</p>
<pre><code class="language-rb">  def parse_page(doc)
        product_name = doc.css('h2.text-primary').first.text()
        .gsub(&quot;\n&quot;,&quot;&quot;)
        .gsub(&quot;\t&quot;,&quot;&quot;)
        price = doc.css('.price h2').first().text.match(/(\w+)\$([\d,]+)/)[2]
        price_origin  = doc.css('.price .strike').first().text.match(/(\w+)\$([\d,]+)/)[2]
        discount_value = price_origin.to_i - price.to_i
        tab_content = doc.css('.tab-content')
        sku = doc.css('.condition li').first.text
        .gsub(&quot;\t&quot;,&quot;&quot;)
        .gsub(&quot;\n&quot;,&quot;&quot;).match(/：(\w+)/)[1]

        
        return {
            :name =&gt; product_name, 
            :price =&gt; price,
            :content=&gt;tab_content,
            :discount_value=&gt;discount_value, 
            :sku=&gt;sku,
            :stock=&gt; 100 , 
        }
    end 
</code></pre>
<p>接下來我只要用迴圈一筆一筆去送出request拿回html並且找到我要的商品訊息，就可以放進資料庫了，這裡因為不確定商品有幾筆，所以試試看從第一筆到第一百筆抓抓看，記得嘗試抓資料時在迴圈裡面要做例外處理，避免沒有資料而發生錯誤：</p>
<pre><code class="language-rb">  def run  
        (1..100).each do |product_id|
            puts &quot;Parsing product id : #{product_id} \n&quot;
            product_url = &quot;#{BASE_URL}?route=product/product&amp;product_id=#{product_id}&quot;
            begin
                

                html = RestClient.get(product_url)
                doc = Nokogiri::HTML(html)
                product_data = parse_page(doc)
                Product.create!(product_data)
            rescue =&gt; exception
                puts &quot;#{exception.message}&quot;
            end
            sleep 0.1
        end
    end
</code></pre>
<p>你可以在<a href="http://34.80.215.175/products/categories/%E9%99%90%E6%99%82%E5%84%AA%E6%83%A0">這裡看到我的網站實作成果</a>。</p>

        </div>
        
        
        
    </div>
</div>








    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-02-11T13:47:18.000Z">2019-02-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/FullStack/">FullStack</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分鐘 閱讀文 (大約 1571 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/02/11/front-backend-travel-7/">前端工程師後端之旅(7) - 爬上穹頂的最後一哩路：部署</a>
            
        </h1>
        <div class="content">
            <p><img src="https://cdn-images-1.medium.com/max/1600/1*grdpBdtOUVJ14ldeLJXAsQ.jpeg" alt=""></p>
<h3 id="什麼是部署"><a class="header-anchor" href="#什麼是部署"></a>什麼是部署</h3>
<p>所有功能實作完之後，為了讓網站可以被一般使用者看到，我們必須要將程式碼放到一台有網路連接的電腦，只要有跟網路連接，就可以透過IP位址找到網站的所在位置，以前要做到這件事情還必須購買硬體主機等等昂貴的設備。</p>
<p>不過現在已經有許多網路主機商提供雲端虛擬主機的服務，只要花一點相對非常便宜的費用就可以連線到該主機去設定系統並且安裝需要的套件跟程式碼，這個複雜且充滿未知挑戰的最後一步我們稱為「部署」。</p>
<h3 id="outline"><a class="header-anchor" href="#outline"></a>Outline</h3>
<ol>
<li>雲端Server 選擇</li>
<li>新增使用者</li>
<li>更新資源庫</li>
<li>安裝mysql</li>
<li>安裝rvm</li>
<li>使用rvm 安裝 並使用ruby</li>
<li>安裝Rails</li>
<li>Clone 要部署的專案</li>
<li>安裝 Passenger 跟 nginx</li>
<li>Nginx Server設定</li>
<li>參考教學</li>
</ol>
<h3 id="雲端server-選擇"><a class="header-anchor" href="#雲端server-選擇"></a>雲端Server 選擇</h3>
<p>基本上這類服務都差不多，最基本就是用價錢跟使用時間來做考量，在這裡我使用的是<a href="https://cloud.google.com/">Google的GCP</a>服務，在GCP剛註冊的會員會給予300塊美金，並且在一年內可以使用，非常適合拿來做練習，而且我記得Google每個人<s>最多可以開五個左右的帳號，一組用不夠…可以開兩個啊</s></p>
<p>對於怎麼建立一台主機，網路上應該有很多類似的教學，看一下教學應該半小時內可以完成，在此不多做說明。裝完主機後，透過GCP介面提供的指令，應該可以很快讓你從電腦連到該機器。</p>
<h3 id="新增使用者"><a class="header-anchor" href="#新增使用者"></a>新增使用者</h3>
<p>我們通常不會一直用root去操作跟安裝，而是會新增一個使用者後，在給予最高權限，因為每個帳號有自己個別的資料夾，如此一來可以讓系統比較好維護，而最高權限意味著可以做任何事情，當然包括把自己刪掉，所以在使用上要非常小心。</p>
<pre><code class="language-shell=">sudo adduser mujing
</code></pre>
<pre><code class="language-shell=">sudo adduser mujing sudo
</code></pre>
<p>切換帳號</p>
<pre><code class="language-shell=">su mujing
</code></pre>
<h3 id="更新資源庫"><a class="header-anchor" href="#更新資源庫"></a>更新資源庫</h3>
<p>我使用的是ubuntu系統，因此新系統安裝完時，最好更新一下系統內預設的套件管理器：</p>
<pre><code class="language-shell=">sudo apt-get update 
</code></pre>
<h3 id="安裝mysql"><a class="header-anchor" href="#安裝mysql"></a>安裝mysql</h3>
<p>這個Rails專案是搭配mysql資料庫開發的，因此必須安裝：</p>
<pre><code class="language-shell=">sudo apt install mysql-server
</code></pre>
<p>如果是在unbuntu上使用mysql 的話記得多裝個mysql client :</p>
<pre><code class="language-shell=">sudo apt-get install libmysqlclient-dev
</code></pre>
<h3 id="安裝rvm"><a class="header-anchor" href="#安裝rvm"></a>安裝rvm</h3>
<p>rvm 是Ruby 語言版本的管理套件，可以讓你在不同版本之間快速切換，方便管理：</p>
<pre><code class="language-shell=">curl -L https://get.rvm.io | bash
</code></pre>
<h3 id="使用rvm-安裝-並使用ruby"><a class="header-anchor" href="#使用rvm-安裝-並使用ruby"></a>使用rvm 安裝 並使用ruby</h3>
<p>使用的ruby是2.4.1 ，可以根據需求安裝不同版本</p>
<pre><code class="language-shell=">rvm install 2.2.3
</code></pre>
<p>設成預設</p>
<pre><code class="language-shell=">rvm use 2.4.1 --default
</code></pre>
<h3 id="安裝rails"><a class="header-anchor" href="#安裝rails"></a>安裝Rails</h3>
<p>走了那麼多步驟，終於可以安裝Rails啦</p>
<pre><code class="language-shell=">gem install rails --no-ri --no-rdoc 
</code></pre>
<h3 id="clone-要部署的專案"><a class="header-anchor" href="#clone-要部署的專案"></a>Clone  要部署的專案</h3>
<p>把程式碼從git server 下載到這台主機上，一般會放在github，<br>
如這個專案的程式碼位置 <a href="https://github.com/moojing/rails-cart">https://github.com/moojing/rails-cart</a></p>
<p>下載完之後記得進入專案資料夾下 bundle install 指令，安裝專案所需要的套件，並透過rails指令把資料表產出來，記得專案裡面database.yml的資料庫使用者帳號密碼要設定對，否則會連不上Sql Server：</p>
<pre><code class="language-shell=">bundle install
rake db:create
rake db:migrate
</code></pre>
<h3 id="安裝-passenger-跟-nginx"><a class="header-anchor" href="#安裝-passenger-跟-nginx"></a>安裝 Passenger 跟 nginx</h3>
<p>Nginx 是一套http Server，可以讓管理者設定許多網頁相關的功能，我們這裡只需要最簡單的監聽某個port，可以讓資料跟外面溝通就行。</p>
<p>Passenger可以想成是Nginx的擴充模組，透過設定，讓你再啟動Nginx時一起把Rails 開起來，透過Nginx監聽某port，來與外界傳送資料跟溝通。</p>
<p>安裝以上兩個工具基本上不會很複雜，Passenger已經寫好教學等你去看了，只要照著操作就能安裝完Nginx跟Passenger:</p>
<p><a href="https://www.phusionpassenger.com/library/install/nginx/install/oss/xenial">https://www.phusionpassenger.com/library/install/nginx/install/oss/xenial</a></p>
<h3 id="nginx-server設定"><a class="header-anchor" href="#nginx-server設定"></a>Nginx Server設定</h3>
<p>安裝完之後開啟nginx 設定檔</p>
<pre><code class="language-shell=">sudo nano /etc/nginx/nginx.conf
</code></pre>
<p>應該可以看到passenger幫你加入這兩行，把註解打開就行：</p>
<pre><code># passenger_root /usr/lib/ruby/vendor_ruby/phusion_passenger/locations.ini;
# passenger_ruby /usr/bin/ruby;
</code></pre>
<p>由於nginx預設監聽80port，所有Server都是預設80port，平常你上網直接打網址的時候其實就是對到80port，<br>
而且Server的port同時只能被一個程序佔用，所以如果想讓80port空下來，我們必須改掉他預設的設定：</p>
<p>打開下列的檔案，這裡是nginx預設的設定檔</p>
<pre><code>sudo vim /etc/nginx/sites-available/default
</code></pre>
<p>把 listen 80 default_server;相關的設定註解掉:</p>
<pre><code>＃ listen 80 default_server;
＃ listen [::]:80 default_server ipv6only=on;
</code></pre>
<p>在同樣的資料夾新增一個屬於你網站的設定檔：</p>
<pre><code>sudo vim /etc/nginx/sites-available/mysite
</code></pre>
<p>放入相關設定:</p>
<pre><code class="language-nginx">server {
 listen 80 default_server;
 server_name http://34.80.215.175; //如果沒有domain 就放網址
 passenger_enabled on; //passenger 設定，要有才能串連rails
 passenger_app_env development; // 環境變數
 root /home/rails/rails-cart/public; // 你的rails專案資料夾的public
}
</code></pre>
<p>設定軟連結，</p>
<pre><code>sudo ln -s /etc/nginx/sites-available/mysite /etc/nginx/sites-enabled/mysite
</code></pre>
<p>然後再重啟Nginx Server 就大功告成：</p>
<pre><code>sudo service nginx start 
</code></pre>
<p>終於成功了！系統部署一般屬於DevOps的工作，當然以上都只用到非常基礎的知識而已，DevOps領域可說是博大精深，學也學不完，這只能算是淺嘗輒止，總之你可以在<a href="http://34.80.215.175/products/categories/%E9%99%90%E6%99%82%E5%84%AA%E6%83%A0">這裡</a>看到我的實作成果。</p>
<h2 id="參考教學"><a class="header-anchor" href="#參考教學"></a>參考教學</h2>
<p><a href="http://steventtud.com/deploy-redmine-to-vps-by-rails-way-in-ubuntu-14-04/">Luka’s notes - Deploy Redmine to VPS by Rails way in Ubuntu 14.04</a></p>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-passenger-and-nginx-on-ubuntu-14-04">How To Deploy a Rails App with Passenger and Nginx on Ubuntu 14.04</a></p>

        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous">
            <a class="is-flex-grow has-text-black-ter" href="/tags/javascript/page/2/">上一頁</a>
        </div>
        <div class="pagination-next is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/tags/javascript/page/4/">下一頁</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link has-text-black-ter" href="/tags/javascript/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/tags/javascript/page/2/">2</a></li>
            
            <li><a class="pagination-link is-current" href="/tags/javascript/page/3/">3</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-4-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/images/avatar.png" alt="Mujing Tsai">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Mujing Tsai
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        -
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Taipei, Taiwan</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            64
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分類
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            10
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        標籤
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            19
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://www.facebook.com/mujing" target="_blank" rel="noopener">
                追蹤</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/moojing">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Facebook" href="https://www.facebook.com/mujing">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Twitter" href="https://www.linkedin.com/in/mu-jing-tsai/">
                
                <i class="fab fa-linkedin"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            連結
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://ithelp.ithome.com.tw/users/20106580/ironman/2503" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">11th鐵人賽</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">ithelp.ithome.com.tw</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分類
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Canvas/">
            <span class="level-start">
                <span class="level-item">Canvas</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/FullStack/">
            <span class="level-start">
                <span class="level-item">FullStack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/IThome-鐵人賽30天/">
            <span class="level-start">
                <span class="level-item">IThome - 鐵人賽30天</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">30</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Javascript/">
            <span class="level-start">
                <span class="level-item">Javascript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Javascript-React/">
            <span class="level-start">
                <span class="level-item">Javascript React</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/TypeScript/">
            <span class="level-start">
                <span class="level-item">TypeScript</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Webpack/">
            <span class="level-start">
                <span class="level-item">Webpack</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/devOps/">
            <span class="level-start">
                <span class="level-item">devOps</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/w3HexSchool-2020-年度鐵人賽/">
            <span class="level-start">
                <span class="level-item">w3HexSchool 2020 年度鐵人賽</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/走在漫漫長路-工作心得/">
            <span class="level-start">
                <span class="level-item">走在漫漫長路 - 工作心得</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            彙整
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2021/04/">
                <span class="level-start">
                    <span class="level-item">四月 2021</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/09/">
                <span class="level-start">
                    <span class="level-item">九月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/03/">
                <span class="level-start">
                    <span class="level-item">三月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/02/">
                <span class="level-start">
                    <span class="level-item">二月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">一月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">30</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">八月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/02/">
                <span class="level-start">
                    <span class="level-item">二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">17</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            標籤雲
        </h3>
        <a href="/tags/backend/" style="font-size: 15.71px;">backend</a> <a href="/tags/canvas/" style="font-size: 10px;">canvas</a> <a href="/tags/devOps/" style="font-size: 11.43px;">devOps</a> <a href="/tags/frontend/" style="font-size: 20px;">frontend</a> <a href="/tags/frontend-force/" style="font-size: 17.14px;">frontend-force</a> <a href="/tags/ironman30/" style="font-size: 17.14px;">ironman30</a> <a href="/tags/javascript/" style="font-size: 18.57px;">javascript</a> <a href="/tags/rails/" style="font-size: 15.71px;">rails</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/ruby/" style="font-size: 15.71px;">ruby</a> <a href="/tags/ruby-on-rails/" style="font-size: 15.71px;">ruby on rails</a> <a href="/tags/typeScript/" style="font-size: 11.43px;">typeScript</a> <a href="/tags/typescript/" style="font-size: 12.86px;">typescript</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/vue-js/" style="font-size: 10px;">vue.js</a> <a href="/tags/w3HexSchool/" style="font-size: 14.29px;">w3HexSchool</a> <a href="/tags/working/" style="font-size: 11.43px;">working</a> <a href="/tags/地下城/" style="font-size: 14.29px;">地下城</a> <a href="/tags/鐵人賽30天/" style="font-size: 17.14px;">鐵人賽30天</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2021/04/03/react-compound-component/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="React 設計模式 - 複合元件">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2021-04-03T10:14:38.000Z">2021-04-03</time></div>
                    <a href="/2021/04/03/react-compound-component/" class="title has-link-black-ter is-size-6 has-text-weight-normal">React 設計模式 - 複合元件</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Javascript-React/">Javascript React</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/09/06/working-reward/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/reward-cover.JPG" alt="每個衝擊都是一次學習的機會 - 近期的一點心得">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-09-06T09:36:53.000Z">2020-09-06</time></div>
                    <a href="/2020/09/06/working-reward/" class="title has-link-black-ter is-size-6 has-text-weight-normal">每個衝擊都是一次學習的機會 - 近期的一點心得</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/走在漫漫長路-工作心得/">走在漫漫長路 - 工作心得</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/03/09/working-environment/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/work-life.jpg" alt="寫給職場工作者：工作環境是否會影響一個人的思考方式？">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-08T20:54:46.000Z">2020-03-09</time></div>
                    <a href="/2020/03/09/working-environment/" class="title has-link-black-ter is-size-6 has-text-weight-normal">寫給職場工作者：工作環境是否會影響一個人的思考方式？</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/走在漫漫長路-工作心得/">走在漫漫長路 - 工作心得</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/03/07/web-dnd-2/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/DragnDrop.jpg" alt="就是要一起拖拖拉拉！(二) - 利用 DataTransfer API 實作拖拉元素間的資料傳遞">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-03-07T08:39:14.000Z">2020-03-07</time></div>
                    <a href="/2020/03/07/web-dnd-2/" class="title has-link-black-ter is-size-6 has-text-weight-normal">就是要一起拖拖拉拉！(二) - 利用 DataTransfer API 實作拖拉元素間的資料傳遞</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/w3HexSchool-2020-年度鐵人賽/">w3HexSchool 2020 年度鐵人賽</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/02/28/web-dnd-1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/thumbnails/DragnDrop.jpg" alt="就是要一起拖拖拉拉！(一) - 瀏覽器 Drag and Drop API 操作">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-02-28T02:04:03.000Z">2020-02-28</time></div>
                    <a href="/2020/02/28/web-dnd-1/" class="title has-link-black-ter is-size-6 has-text-weight-normal">就是要一起拖拖拉拉！(一) - 瀏覽器 Drag and Drop API 操作</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/w3HexSchool-2020-年度鐵人賽/">w3HexSchool 2020 年度鐵人賽</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                標籤
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/backend/">
                        <span class="tag">backend</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/canvas/">
                        <span class="tag">canvas</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/devOps/">
                        <span class="tag">devOps</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/frontend/">
                        <span class="tag">frontend</span>
                        <span class="tag is-grey">62</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/frontend-force/">
                        <span class="tag">frontend-force</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ironman30/">
                        <span class="tag">ironman30</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/javascript/">
                        <span class="tag">javascript</span>
                        <span class="tag is-grey">56</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/rails/">
                        <span class="tag">rails</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/react/">
                        <span class="tag">react</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ruby/">
                        <span class="tag">ruby</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/ruby-on-rails/">
                        <span class="tag">ruby on rails</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/typeScript/">
                        <span class="tag">typeScript</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/typescript/">
                        <span class="tag">typescript</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/vue/">
                        <span class="tag">vue</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/vue-js/">
                        <span class="tag">vue.js</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/w3HexSchool/">
                        <span class="tag">w3HexSchool</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/working/">
                        <span class="tag">working</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/地下城/">
                        <span class="tag">地下城</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/鐵人賽30天/">
                        <span class="tag">鐵人賽30天</span>
                        <span class="tag is-grey">30</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="Moojing&#39;s Blog" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2021
                 <!-- Moojing&nbsp; -->
                
                <!-- Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a> -->
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-TW");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://www.muji.dev',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到頁首" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="請輸入關鍵字..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '頁面',
                CATEGORIES: '分類',
                TAGS: '標籤',
                UNTITLED: '(無標題)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>